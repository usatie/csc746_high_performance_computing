Successfully paused profiling.
ncu --set default --section SourceCounters --section Occupancy --section LaunchStats --section SpeedOfLight --metrics smsp__cycles_active.avg.pct_of_peak_sustained_elapsed,dram__throughput.avg.pct_of_peak_sustained_elapsed,gpu__time_duration.avg ./sobel_gpu -T 32 -B 1
==PROF== Connected to process 2152417 (/pscratch/sd/u/usatie/csc746-cp5-gpu-stencil/build/sobel_gpu)
 Read data from the file ../data/zebra-gray-int8-4x 
Command line number of `threads per block`: 32
Command line number of `thread blocks`: 1
==PROF== Profiling "sobel_kernel_gpu" - 0: 0%.
==WARNING== Launching the workload is taking more time than expected. If this continues to hang, terminate the profile and re-try by profiling the range of all related launches using '--replay-mode range'. See https://docs.nvidia.com/nsight-compute/ProfilingGuide/index.html#replay for more details.
...50%....100% - 13 passes
 GPU configuration: 1 blocks, 32 threads per block 
 Elapsed time is : 108.074790 (sec) 
 Wrote the output file ../data/processed-raw-int8-4x-gpu.dat 
==PROF== Disconnected from process 2152417
[2152417] sobel_gpu@127.0.0.1
  sobel_kernel_gpu(const float *, float *, int, int, int) (1, 1, 1)x(32, 1, 1), Context 1, Stream 7, Device 0, CC 8.0
    Section: Command line profiler metrics
    ----------------------------------------------------- ----------- ------------
    Metric Name                                           Metric Unit Metric Value
    ----------------------------------------------------- ----------- ------------
    dram__throughput.avg.pct_of_peak_sustained_elapsed              %         0.02
    gpu__time_duration.avg                                    msecond       899.88
    smsp__cycles_active.avg.pct_of_peak_sustained_elapsed           %         0.23
    ----------------------------------------------------- ----------- ------------

    Section: GPU Speed Of Light Throughput
    ----------------------- ------------- ------------
    Metric Name               Metric Unit Metric Value
    ----------------------- ------------- ------------
    DRAM Frequency          cycle/nsecond         1.21
    SM Frequency            cycle/nsecond         1.09
    Elapsed Cycles                  cycle  985,344,354
    Memory Throughput                   %         0.02
    DRAM Throughput                     %         0.02
    Duration                      msecond       899.88
    L1/TEX Cache Throughput             %         1.18
    L2 Cache Throughput                 %         0.02
    SM Active Cycles                cycle 9,123,531.12
    Compute (SM) Throughput             %         0.02
    ----------------------- ------------- ------------

    OPT   This kernel grid is too small to fill the available resources on this device, resulting in only 0.0 full      
          waves across all SMs. Look at Launch Statistics for more details.                                             

    Section: Launch Statistics
    -------------------------------- --------------- ---------------
    Metric Name                          Metric Unit    Metric Value
    -------------------------------- --------------- ---------------
    Block Size                                                    32
    Function Cache Configuration                     CachePreferNone
    Grid Size                                                      1
    Registers Per Thread             register/thread              23
    Shared Memory Configuration Size           Kbyte           32.77
    Driver Shared Memory Per Block       Kbyte/block            1.02
    Dynamic Shared Memory Per Block       byte/block               0
    Static Shared Memory Per Block        byte/block               0
    Threads                                   thread              32
    Waves Per SM                                                0.00
    -------------------------------- --------------- ---------------

    OPT   Estimated Speedup: 99.07%                                                                                     
          The grid for this launch is configured to execute only 1 blocks, which is less than the GPU's 108             
          multiprocessors. This can underutilize some multiprocessors. If you do not intend to execute this kernel      
          concurrently with other workloads, consider reducing the block size to have at least one block per            
          multiprocessor or increase the size of the grid to fully utilize the available hardware resources. See the    
          Hardware Model (https://docs.nvidia.com/nsight-compute/ProfilingGuide/index.html#metrics-hw-model)            
          description for more details on launch configurations.                                                        

    Section: Occupancy
    ------------------------------- ----------- ------------
    Metric Name                     Metric Unit Metric Value
    ------------------------------- ----------- ------------
    Block Limit SM                        block           32
    Block Limit Registers                 block           84
    Block Limit Shared Mem                block           32
    Block Limit Warps                     block           64
    Theoretical Active Warps per SM        warp           32
    Theoretical Occupancy                     %           50
    Achieved Occupancy                        %         1.56
    Achieved Active Warps Per SM           warp         1.00
    ------------------------------- ----------- ------------

    OPT   Estimated Speedup: 96.87%                                                                                     
          This kernel's theoretical occupancy (50.0%) is limited by the number of blocks that can fit on the SM. This   
          kernel's theoretical occupancy (50.0%) is limited by the required amount of shared memory. The difference     
          between calculated theoretical (50.0%) and measured achieved occupancy (1.6%) can be the result of warp       
          scheduling overheads or workload imbalances during the kernel execution. Load imbalances can occur between    
          warps within a block as well as across blocks of the same kernel. See the CUDA Best Practices Guide           
          (https://docs.nvidia.com/cuda/cuda-c-best-practices-guide/index.html#occupancy) for more details on           
          optimizing occupancy.                                                                                         

    Section: Source Counters
    ------------------------- ----------- ------------
    Metric Name               Metric Unit Metric Value
    ------------------------- ----------- ------------
    Branch Instructions Ratio           %         0.06
    Branch Instructions              inst    5,730,351
    Branch Efficiency                   %        99.78
    Avg. Divergent Branches                      17.81
    ------------------------- ----------- ------------

    OPT   Estimated Speedup: 0%                                                                                         
          This kernel has uncoalesced global accesses resulting in a total of 6851808 excessive sectors (13% of the     
          total 52583746 sectors). Check the L2 Theoretical Sectors Global Excessive table for the primary source       
          locations. The CUDA Programming Guide                                                                         
          (https://docs.nvidia.com/cuda/cuda-c-programming-guide/index.html#device-memory-accesses) had additional      
          information on reducing uncoalesced device memory accesses.                                                   

ncu --set default --section SourceCounters --section Occupancy --section LaunchStats --section SpeedOfLight --metrics smsp__cycles_active.avg.pct_of_peak_sustained_elapsed,dram__throughput.avg.pct_of_peak_sustained_elapsed,gpu__time_duration.avg ./sobel_gpu -T 32 -B 4
==PROF== Connected to process 2153561 (/pscratch/sd/u/usatie/csc746-cp5-gpu-stencil/build/sobel_gpu)
 Read data from the file ../data/zebra-gray-int8-4x 
Command line number of `threads per block`: 32
Command line number of `thread blocks`: 4
==PROF== Profiling "sobel_kernel_gpu" - 0: 0%.
==WARNING== Launching the workload is taking more time than expected. If this continues to hang, terminate the profile and re-try by profiling the range of all related launches using '--replay-mode range'. See https://docs.nvidia.com/nsight-compute/ProfilingGuide/index.html#replay for more details.
...50%....100% - 13 passes
 GPU configuration: 4 blocks, 32 threads per block 
 Elapsed time is : 28.533290 (sec) 
 Wrote the output file ../data/processed-raw-int8-4x-gpu.dat 
==PROF== Disconnected from process 2153561
[2153561] sobel_gpu@127.0.0.1
  sobel_kernel_gpu(const float *, float *, int, int, int) (4, 1, 1)x(32, 1, 1), Context 1, Stream 7, Device 0, CC 8.0
    Section: Command line profiler metrics
    ----------------------------------------------------- ----------- ------------
    Metric Name                                           Metric Unit Metric Value
    ----------------------------------------------------- ----------- ------------
    dram__throughput.avg.pct_of_peak_sustained_elapsed              %         0.08
    gpu__time_duration.avg                                    msecond       229.49
    smsp__cycles_active.avg.pct_of_peak_sustained_elapsed           %         0.93
    ----------------------------------------------------- ----------- ------------

    Section: GPU Speed Of Light Throughput
    ----------------------- ------------- ------------
    Metric Name               Metric Unit Metric Value
    ----------------------- ------------- ------------
    DRAM Frequency          cycle/nsecond         1.21
    SM Frequency            cycle/nsecond         1.09
    Elapsed Cycles                  cycle  251,207,409
    Memory Throughput                   %         0.08
    DRAM Throughput                     %         0.08
    Duration                      msecond       229.49
    L1/TEX Cache Throughput             %         1.52
    L2 Cache Throughput                 %         0.11
    SM Active Cycles                cycle 9,305,252.52
    Compute (SM) Throughput             %         0.09
    ----------------------- ------------- ------------

    OPT   This kernel grid is too small to fill the available resources on this device, resulting in only 0.0 full      
          waves across all SMs. Look at Launch Statistics for more details.                                             

    Section: Launch Statistics
    -------------------------------- --------------- ---------------
    Metric Name                          Metric Unit    Metric Value
    -------------------------------- --------------- ---------------
    Block Size                                                    32
    Function Cache Configuration                     CachePreferNone
    Grid Size                                                      4
    Registers Per Thread             register/thread              23
    Shared Memory Configuration Size           Kbyte           32.77
    Driver Shared Memory Per Block       Kbyte/block            1.02
    Dynamic Shared Memory Per Block       byte/block               0
    Static Shared Memory Per Block        byte/block               0
    Threads                                   thread             128
    Waves Per SM                                                0.00
    -------------------------------- --------------- ---------------

    OPT   Estimated Speedup: 96.3%                                                                                      
          The grid for this launch is configured to execute only 4 blocks, which is less than the GPU's 108             
          multiprocessors. This can underutilize some multiprocessors. If you do not intend to execute this kernel      
          concurrently with other workloads, consider reducing the block size to have at least one block per            
          multiprocessor or increase the size of the grid to fully utilize the available hardware resources. See the    
          Hardware Model (https://docs.nvidia.com/nsight-compute/ProfilingGuide/index.html#metrics-hw-model)            
          description for more details on launch configurations.                                                        

    Section: Occupancy
    ------------------------------- ----------- ------------
    Metric Name                     Metric Unit Metric Value
    ------------------------------- ----------- ------------
    Block Limit SM                        block           32
    Block Limit Registers                 block           84
    Block Limit Shared Mem                block           32
    Block Limit Warps                     block           64
    Theoretical Active Warps per SM        warp           32
    Theoretical Occupancy                     %           50
    Achieved Occupancy                        %         1.56
    Achieved Active Warps Per SM           warp         1.00
    ------------------------------- ----------- ------------

    OPT   Estimated Speedup: 96.87%                                                                                     
          This kernel's theoretical occupancy (50.0%) is limited by the number of blocks that can fit on the SM. This   
          kernel's theoretical occupancy (50.0%) is limited by the required amount of shared memory. The difference     
          between calculated theoretical (50.0%) and measured achieved occupancy (1.6%) can be the result of warp       
          scheduling overheads or workload imbalances during the kernel execution. Load imbalances can occur between    
          warps within a block as well as across blocks of the same kernel. See the CUDA Best Practices Guide           
          (https://docs.nvidia.com/cuda/cuda-c-best-practices-guide/index.html#occupancy) for more details on           
          optimizing occupancy.                                                                                         

    Section: Source Counters
    ------------------------- ----------- ------------
    Metric Name               Metric Unit Metric Value
    ------------------------- ----------- ------------
    Branch Instructions Ratio           %         0.06
    Branch Instructions              inst    5,730,357
    Branch Efficiency                   %        99.78
    Avg. Divergent Branches                      17.81
    ------------------------- ----------- ------------

    OPT   Estimated Speedup: 0%                                                                                         
          This kernel has uncoalesced global accesses resulting in a total of 6851808 excessive sectors (13% of the     
          total 52583746 sectors). Check the L2 Theoretical Sectors Global Excessive table for the primary source       
          locations. The CUDA Programming Guide                                                                         
          (https://docs.nvidia.com/cuda/cuda-c-programming-guide/index.html#device-memory-accesses) had additional      
          information on reducing uncoalesced device memory accesses.                                                   

ncu --set default --section SourceCounters --section Occupancy --section LaunchStats --section SpeedOfLight --metrics smsp__cycles_active.avg.pct_of_peak_sustained_elapsed,dram__throughput.avg.pct_of_peak_sustained_elapsed,gpu__time_duration.avg ./sobel_gpu -T 32 -B 16
==PROF== Connected to process 2153626 (/pscratch/sd/u/usatie/csc746-cp5-gpu-stencil/build/sobel_gpu)
 Read data from the file ../data/zebra-gray-int8-4x 
Command line number of `threads per block`: 32
Command line number of `thread blocks`: 16
==PROF== Profiling "sobel_kernel_gpu" - 0: 0%.
==WARNING== Launching the workload is taking more time than expected. If this continues to hang, terminate the profile and re-try by profiling the range of all related launches using '--replay-mode range'. See https://docs.nvidia.com/nsight-compute/ProfilingGuide/index.html#replay for more details.
...50%....100% - 13 passes
 GPU configuration: 16 blocks, 32 threads per block 
 Elapsed time is : 8.479525 (sec) 
 Wrote the output file ../data/processed-raw-int8-4x-gpu.dat 
==PROF== Disconnected from process 2153626
[2153626] sobel_gpu@127.0.0.1
  sobel_kernel_gpu(const float *, float *, int, int, int) (16, 1, 1)x(32, 1, 1), Context 1, Stream 7, Device 0, CC 8.0
    Section: Command line profiler metrics
    ----------------------------------------------------- ----------- ------------
    Metric Name                                           Metric Unit Metric Value
    ----------------------------------------------------- ----------- ------------
    dram__throughput.avg.pct_of_peak_sustained_elapsed              %         0.31
    gpu__time_duration.avg                                    msecond        58.26
    smsp__cycles_active.avg.pct_of_peak_sustained_elapsed           %         3.70
    ----------------------------------------------------- ----------- ------------

    Section: GPU Speed Of Light Throughput
    ----------------------- ------------- ------------
    Metric Name               Metric Unit Metric Value
    ----------------------- ------------- ------------
    DRAM Frequency          cycle/nsecond         1.21
    SM Frequency            cycle/nsecond         1.09
    Elapsed Cycles                  cycle   63,793,894
    Memory Throughput                   %         0.32
    DRAM Throughput                     %         0.31
    Duration                      msecond        58.26
    L1/TEX Cache Throughput             %         1.18
    L2 Cache Throughput                 %         0.45
    SM Active Cycles                cycle 9,442,111.94
    Compute (SM) Throughput             %         0.36
    ----------------------- ------------- ------------

    OPT   This kernel grid is too small to fill the available resources on this device, resulting in only 0.0 full      
          waves across all SMs. Look at Launch Statistics for more details.                                             

    Section: Launch Statistics
    -------------------------------- --------------- ---------------
    Metric Name                          Metric Unit    Metric Value
    -------------------------------- --------------- ---------------
    Block Size                                                    32
    Function Cache Configuration                     CachePreferNone
    Grid Size                                                     16
    Registers Per Thread             register/thread              23
    Shared Memory Configuration Size           Kbyte           32.77
    Driver Shared Memory Per Block       Kbyte/block            1.02
    Dynamic Shared Memory Per Block       byte/block               0
    Static Shared Memory Per Block        byte/block               0
    Threads                                   thread             512
    Waves Per SM                                                0.00
    -------------------------------- --------------- ---------------

    OPT   Estimated Speedup: 85.19%                                                                                     
          The grid for this launch is configured to execute only 16 blocks, which is less than the GPU's 108            
          multiprocessors. This can underutilize some multiprocessors. If you do not intend to execute this kernel      
          concurrently with other workloads, consider reducing the block size to have at least one block per            
          multiprocessor or increase the size of the grid to fully utilize the available hardware resources. See the    
          Hardware Model (https://docs.nvidia.com/nsight-compute/ProfilingGuide/index.html#metrics-hw-model)            
          description for more details on launch configurations.                                                        

    Section: Occupancy
    ------------------------------- ----------- ------------
    Metric Name                     Metric Unit Metric Value
    ------------------------------- ----------- ------------
    Block Limit SM                        block           32
    Block Limit Registers                 block           84
    Block Limit Shared Mem                block           32
    Block Limit Warps                     block           64
    Theoretical Active Warps per SM        warp           32
    Theoretical Occupancy                     %           50
    Achieved Occupancy                        %         1.56
    Achieved Active Warps Per SM           warp         1.00
    ------------------------------- ----------- ------------

    OPT   Estimated Speedup: 96.87%                                                                                     
          This kernel's theoretical occupancy (50.0%) is limited by the number of blocks that can fit on the SM. This   
          kernel's theoretical occupancy (50.0%) is limited by the required amount of shared memory. The difference     
          between calculated theoretical (50.0%) and measured achieved occupancy (1.6%) can be the result of warp       
          scheduling overheads or workload imbalances during the kernel execution. Load imbalances can occur between    
          warps within a block as well as across blocks of the same kernel. See the CUDA Best Practices Guide           
          (https://docs.nvidia.com/cuda/cuda-c-best-practices-guide/index.html#occupancy) for more details on           
          optimizing occupancy.                                                                                         

    Section: Source Counters
    ------------------------- ----------- ------------
    Metric Name               Metric Unit Metric Value
    ------------------------- ----------- ------------
    Branch Instructions Ratio           %         0.06
    Branch Instructions              inst    5,730,381
    Branch Efficiency                   %        99.78
    Avg. Divergent Branches                      17.81
    ------------------------- ----------- ------------

    OPT   Estimated Speedup: 0%                                                                                         
          This kernel has uncoalesced global accesses resulting in a total of 6851808 excessive sectors (13% of the     
          total 52583746 sectors). Check the L2 Theoretical Sectors Global Excessive table for the primary source       
          locations. The CUDA Programming Guide                                                                         
          (https://docs.nvidia.com/cuda/cuda-c-programming-guide/index.html#device-memory-accesses) had additional      
          information on reducing uncoalesced device memory accesses.                                                   

ncu --set default --section SourceCounters --section Occupancy --section LaunchStats --section SpeedOfLight --metrics smsp__cycles_active.avg.pct_of_peak_sustained_elapsed,dram__throughput.avg.pct_of_peak_sustained_elapsed,gpu__time_duration.avg ./sobel_gpu -T 32 -B 64
==PROF== Connected to process 2153697 (/pscratch/sd/u/usatie/csc746-cp5-gpu-stencil/build/sobel_gpu)
 Read data from the file ../data/zebra-gray-int8-4x 
Command line number of `threads per block`: 32
Command line number of `thread blocks`: 64
==PROF== Profiling "sobel_kernel_gpu" - 0: 0%....50%....100% - 13 passes
 GPU configuration: 64 blocks, 32 threads per block 
 Elapsed time is : 3.441694 (sec) 
 Wrote the output file ../data/processed-raw-int8-4x-gpu.dat 
==PROF== Disconnected from process 2153697
[2153697] sobel_gpu@127.0.0.1
  sobel_kernel_gpu(const float *, float *, int, int, int) (64, 1, 1)x(32, 1, 1), Context 1, Stream 7, Device 0, CC 8.0
    Section: Command line profiler metrics
    ----------------------------------------------------- ----------- ------------
    Metric Name                                           Metric Unit Metric Value
    ----------------------------------------------------- ----------- ------------
    dram__throughput.avg.pct_of_peak_sustained_elapsed              %         1.23
    gpu__time_duration.avg                                    msecond        14.71
    smsp__cycles_active.avg.pct_of_peak_sustained_elapsed           %        14.79
    ----------------------------------------------------- ----------- ------------

    Section: GPU Speed Of Light Throughput
    ----------------------- ------------- ------------
    Metric Name               Metric Unit Metric Value
    ----------------------- ------------- ------------
    DRAM Frequency          cycle/nsecond         1.22
    SM Frequency            cycle/nsecond         1.10
    Elapsed Cycles                  cycle   16,105,890
    Memory Throughput                   %         1.26
    DRAM Throughput                     %         1.23
    Duration                      msecond        14.71
    L1/TEX Cache Throughput             %         1.17
    L2 Cache Throughput                 %         1.76
    SM Active Cycles                cycle 9,529,932.33
    Compute (SM) Throughput             %         1.43
    ----------------------- ------------- ------------

    OPT   This kernel grid is too small to fill the available resources on this device, resulting in only 0.0 full      
          waves across all SMs. Look at Launch Statistics for more details.                                             

    Section: Launch Statistics
    -------------------------------- --------------- ---------------
    Metric Name                          Metric Unit    Metric Value
    -------------------------------- --------------- ---------------
    Block Size                                                    32
    Function Cache Configuration                     CachePreferNone
    Grid Size                                                     64
    Registers Per Thread             register/thread              23
    Shared Memory Configuration Size           Kbyte           32.77
    Driver Shared Memory Per Block       Kbyte/block            1.02
    Dynamic Shared Memory Per Block       byte/block               0
    Static Shared Memory Per Block        byte/block               0
    Threads                                   thread           2,048
    Waves Per SM                                                0.02
    -------------------------------- --------------- ---------------

    OPT   Estimated Speedup: 40.74%                                                                                     
          The grid for this launch is configured to execute only 64 blocks, which is less than the GPU's 108            
          multiprocessors. This can underutilize some multiprocessors. If you do not intend to execute this kernel      
          concurrently with other workloads, consider reducing the block size to have at least one block per            
          multiprocessor or increase the size of the grid to fully utilize the available hardware resources. See the    
          Hardware Model (https://docs.nvidia.com/nsight-compute/ProfilingGuide/index.html#metrics-hw-model)            
          description for more details on launch configurations.                                                        

    Section: Occupancy
    ------------------------------- ----------- ------------
    Metric Name                     Metric Unit Metric Value
    ------------------------------- ----------- ------------
    Block Limit SM                        block           32
    Block Limit Registers                 block           84
    Block Limit Shared Mem                block           32
    Block Limit Warps                     block           64
    Theoretical Active Warps per SM        warp           32
    Theoretical Occupancy                     %           50
    Achieved Occupancy                        %         1.56
    Achieved Active Warps Per SM           warp         1.00
    ------------------------------- ----------- ------------

    OPT   Estimated Speedup: 96.88%                                                                                     
          This kernel's theoretical occupancy (50.0%) is limited by the number of blocks that can fit on the SM. This   
          kernel's theoretical occupancy (50.0%) is limited by the required amount of shared memory. The difference     
          between calculated theoretical (50.0%) and measured achieved occupancy (1.6%) can be the result of warp       
          scheduling overheads or workload imbalances during the kernel execution. Load imbalances can occur between    
          warps within a block as well as across blocks of the same kernel. See the CUDA Best Practices Guide           
          (https://docs.nvidia.com/cuda/cuda-c-best-practices-guide/index.html#occupancy) for more details on           
          optimizing occupancy.                                                                                         

    Section: Source Counters
    ------------------------- ----------- ------------
    Metric Name               Metric Unit Metric Value
    ------------------------- ----------- ------------
    Branch Instructions Ratio           %         0.06
    Branch Instructions              inst    5,730,477
    Branch Efficiency                   %        99.78
    Avg. Divergent Branches                      17.81
    ------------------------- ----------- ------------

    OPT   Estimated Speedup: 0%                                                                                         
          This kernel has uncoalesced global accesses resulting in a total of 6851808 excessive sectors (13% of the     
          total 52583746 sectors). Check the L2 Theoretical Sectors Global Excessive table for the primary source       
          locations. The CUDA Programming Guide                                                                         
          (https://docs.nvidia.com/cuda/cuda-c-programming-guide/index.html#device-memory-accesses) had additional      
          information on reducing uncoalesced device memory accesses.                                                   

ncu --set default --section SourceCounters --section Occupancy --section LaunchStats --section SpeedOfLight --metrics smsp__cycles_active.avg.pct_of_peak_sustained_elapsed,dram__throughput.avg.pct_of_peak_sustained_elapsed,gpu__time_duration.avg ./sobel_gpu -T 32 -B 256
==PROF== Connected to process 2153741 (/pscratch/sd/u/usatie/csc746-cp5-gpu-stencil/build/sobel_gpu)
 Read data from the file ../data/zebra-gray-int8-4x 
Command line number of `threads per block`: 32
Command line number of `thread blocks`: 256
==PROF== Profiling "sobel_kernel_gpu" - 0: 0%....50%....100% - 13 passes
 GPU configuration: 256 blocks, 32 threads per block 
 Elapsed time is : 2.153672 (sec) 
 Wrote the output file ../data/processed-raw-int8-4x-gpu.dat 
==PROF== Disconnected from process 2153741
[2153741] sobel_gpu@127.0.0.1
  sobel_kernel_gpu(const float *, float *, int, int, int) (256, 1, 1)x(32, 1, 1), Context 1, Stream 7, Device 0, CC 8.0
    Section: Command line profiler metrics
    ----------------------------------------------------- ----------- ------------
    Metric Name                                           Metric Unit Metric Value
    ----------------------------------------------------- ----------- ------------
    dram__throughput.avg.pct_of_peak_sustained_elapsed              %         4.49
    gpu__time_duration.avg                                    msecond         4.03
    smsp__cycles_active.avg.pct_of_peak_sustained_elapsed           %        59.17
    ----------------------------------------------------- ----------- ------------

    Section: GPU Speed Of Light Throughput
    ----------------------- ------------- ------------
    Metric Name               Metric Unit Metric Value
    ----------------------- ------------- ------------
    DRAM Frequency          cycle/nsecond         1.21
    SM Frequency            cycle/nsecond         1.09
    Elapsed Cycles                  cycle    4,411,922
    Memory Throughput                   %         4.49
    DRAM Throughput                     %         4.49
    Duration                      msecond         4.03
    L1/TEX Cache Throughput             %         2.55
    L2 Cache Throughput                 %         6.16
    SM Active Cycles                cycle 4,405,581.77
    Compute (SM) Throughput             %         5.22
    ----------------------- ------------- ------------

    OPT   This kernel grid is too small to fill the available resources on this device, resulting in only 0.1 full      
          waves across all SMs. Look at Launch Statistics for more details.                                             

    Section: Launch Statistics
    -------------------------------- --------------- ---------------
    Metric Name                          Metric Unit    Metric Value
    -------------------------------- --------------- ---------------
    Block Size                                                    32
    Function Cache Configuration                     CachePreferNone
    Grid Size                                                    256
    Registers Per Thread             register/thread              23
    Shared Memory Configuration Size           Kbyte           32.77
    Driver Shared Memory Per Block       Kbyte/block            1.02
    Dynamic Shared Memory Per Block       byte/block               0
    Static Shared Memory Per Block        byte/block               0
    Threads                                   thread           8,192
    Waves Per SM                                                0.07
    -------------------------------- --------------- ---------------

    Section: Occupancy
    ------------------------------- ----------- ------------
    Metric Name                     Metric Unit Metric Value
    ------------------------------- ----------- ------------
    Block Limit SM                        block           32
    Block Limit Registers                 block           84
    Block Limit Shared Mem                block           32
    Block Limit Warps                     block           64
    Theoretical Active Warps per SM        warp           32
    Theoretical Occupancy                     %           50
    Achieved Occupancy                        %         3.70
    Achieved Active Warps Per SM           warp         2.37
    ------------------------------- ----------- ------------

    OPT   Estimated Speedup: 92.59%                                                                                     
          This kernel's theoretical occupancy (50.0%) is limited by the number of blocks that can fit on the SM. This   
          kernel's theoretical occupancy (50.0%) is limited by the required amount of shared memory. The difference     
          between calculated theoretical (50.0%) and measured achieved occupancy (3.7%) can be the result of warp       
          scheduling overheads or workload imbalances during the kernel execution. Load imbalances can occur between    
          warps within a block as well as across blocks of the same kernel. See the CUDA Best Practices Guide           
          (https://docs.nvidia.com/cuda/cuda-c-best-practices-guide/index.html#occupancy) for more details on           
          optimizing occupancy.                                                                                         

    Section: Source Counters
    ------------------------- ----------- ------------
    Metric Name               Metric Unit Metric Value
    ------------------------- ----------- ------------
    Branch Instructions Ratio           %         0.06
    Branch Instructions              inst    5,730,861
    Branch Efficiency                   %        99.78
    Avg. Divergent Branches                      17.81
    ------------------------- ----------- ------------

    OPT   Estimated Speedup: 0%                                                                                         
          This kernel has uncoalesced global accesses resulting in a total of 6851808 excessive sectors (13% of the     
          total 52583746 sectors). Check the L2 Theoretical Sectors Global Excessive table for the primary source       
          locations. The CUDA Programming Guide                                                                         
          (https://docs.nvidia.com/cuda/cuda-c-programming-guide/index.html#device-memory-accesses) had additional      
          information on reducing uncoalesced device memory accesses.                                                   

ncu --set default --section SourceCounters --section Occupancy --section LaunchStats --section SpeedOfLight --metrics smsp__cycles_active.avg.pct_of_peak_sustained_elapsed,dram__throughput.avg.pct_of_peak_sustained_elapsed,gpu__time_duration.avg ./sobel_gpu -T 32 -B 1024
==PROF== Connected to process 2153806 (/pscratch/sd/u/usatie/csc746-cp5-gpu-stencil/build/sobel_gpu)
 Read data from the file ../data/zebra-gray-int8-4x 
Command line number of `threads per block`: 32
Command line number of `thread blocks`: 1024
==PROF== Profiling "sobel_kernel_gpu" - 0: 0%....50%....100% - 13 passes
 GPU configuration: 1024 blocks, 32 threads per block 
 Elapsed time is : 2.009667 (sec) 
 Wrote the output file ../data/processed-raw-int8-4x-gpu.dat 
==PROF== Disconnected from process 2153806
[2153806] sobel_gpu@127.0.0.1
  sobel_kernel_gpu(const float *, float *, int, int, int) (1024, 1, 1)x(32, 1, 1), Context 1, Stream 7, Device 0, CC 8.0
    Section: Command line profiler metrics
    ----------------------------------------------------- ----------- ------------
    Metric Name                                           Metric Unit Metric Value
    ----------------------------------------------------- ----------- ------------
    dram__throughput.avg.pct_of_peak_sustained_elapsed              %        16.02
    gpu__time_duration.avg                                    msecond         1.13
    smsp__cycles_active.avg.pct_of_peak_sustained_elapsed           %        99.15
    ----------------------------------------------------- ----------- ------------

    Section: GPU Speed Of Light Throughput
    ----------------------- ------------- ------------
    Metric Name               Metric Unit Metric Value
    ----------------------- ------------- ------------
    DRAM Frequency          cycle/nsecond         1.21
    SM Frequency            cycle/nsecond         1.09
    Elapsed Cycles                  cycle    1,236,885
    Memory Throughput                   %        16.02
    DRAM Throughput                     %        16.02
    Duration                      msecond         1.13
    L1/TEX Cache Throughput             %         9.86
    L2 Cache Throughput                 %        21.68
    SM Active Cycles                cycle 1,229,671.54
    Compute (SM) Throughput             %        18.63
    ----------------------- ------------- ------------

    OPT   This kernel grid is too small to fill the available resources on this device, resulting in only 0.3 full      
          waves across all SMs. Look at Launch Statistics for more details.                                             

    Section: Launch Statistics
    -------------------------------- --------------- ---------------
    Metric Name                          Metric Unit    Metric Value
    -------------------------------- --------------- ---------------
    Block Size                                                    32
    Function Cache Configuration                     CachePreferNone
    Grid Size                                                  1,024
    Registers Per Thread             register/thread              23
    Shared Memory Configuration Size           Kbyte           32.77
    Driver Shared Memory Per Block       Kbyte/block            1.02
    Dynamic Shared Memory Per Block       byte/block               0
    Static Shared Memory Per Block        byte/block               0
    Threads                                   thread          32,768
    Waves Per SM                                                0.30
    -------------------------------- --------------- ---------------

    Section: Occupancy
    ------------------------------- ----------- ------------
    Metric Name                     Metric Unit Metric Value
    ------------------------------- ----------- ------------
    Block Limit SM                        block           32
    Block Limit Registers                 block           84
    Block Limit Shared Mem                block           32
    Block Limit Warps                     block           64
    Theoretical Active Warps per SM        warp           32
    Theoretical Occupancy                     %           50
    Achieved Occupancy                        %        14.75
    Achieved Active Warps Per SM           warp         9.44
    ------------------------------- ----------- ------------

    OPT   Estimated Speedup: 70.5%                                                                                      
          This kernel's theoretical occupancy (50.0%) is limited by the number of blocks that can fit on the SM. This   
          kernel's theoretical occupancy (50.0%) is limited by the required amount of shared memory. The difference     
          between calculated theoretical (50.0%) and measured achieved occupancy (14.8%) can be the result of warp      
          scheduling overheads or workload imbalances during the kernel execution. Load imbalances can occur between    
          warps within a block as well as across blocks of the same kernel. See the CUDA Best Practices Guide           
          (https://docs.nvidia.com/cuda/cuda-c-best-practices-guide/index.html#occupancy) for more details on           
          optimizing occupancy.                                                                                         

    Section: Source Counters
    ------------------------- ----------- ------------
    Metric Name               Metric Unit Metric Value
    ------------------------- ----------- ------------
    Branch Instructions Ratio           %         0.06
    Branch Instructions              inst    5,732,397
    Branch Efficiency                   %        99.78
    Avg. Divergent Branches                      17.81
    ------------------------- ----------- ------------

    OPT   Estimated Speedup: 0%                                                                                         
          This kernel has uncoalesced global accesses resulting in a total of 6851808 excessive sectors (13% of the     
          total 52583746 sectors). Check the L2 Theoretical Sectors Global Excessive table for the primary source       
          locations. The CUDA Programming Guide                                                                         
          (https://docs.nvidia.com/cuda/cuda-c-programming-guide/index.html#device-memory-accesses) had additional      
          information on reducing uncoalesced device memory accesses.                                                   

ncu --set default --section SourceCounters --section Occupancy --section LaunchStats --section SpeedOfLight --metrics smsp__cycles_active.avg.pct_of_peak_sustained_elapsed,dram__throughput.avg.pct_of_peak_sustained_elapsed,gpu__time_duration.avg ./sobel_gpu -T 32 -B 4096
==PROF== Connected to process 2153851 (/pscratch/sd/u/usatie/csc746-cp5-gpu-stencil/build/sobel_gpu)
 Read data from the file ../data/zebra-gray-int8-4x 
Command line number of `threads per block`: 32
Command line number of `thread blocks`: 4096
==PROF== Profiling "sobel_kernel_gpu" - 0: 0%....50%....100% - 13 passes
 GPU configuration: 4096 blocks, 32 threads per block 
 Elapsed time is : 1.891888 (sec) 
 Wrote the output file ../data/processed-raw-int8-4x-gpu.dat 
==PROF== Disconnected from process 2153851
[2153851] sobel_gpu@127.0.0.1
  sobel_kernel_gpu(const float *, float *, int, int, int) (4096, 1, 1)x(32, 1, 1), Context 1, Stream 7, Device 0, CC 8.0
    Section: Command line profiler metrics
    ----------------------------------------------------- ----------- ------------
    Metric Name                                           Metric Unit Metric Value
    ----------------------------------------------------- ----------- ------------
    dram__throughput.avg.pct_of_peak_sustained_elapsed              %        32.35
    gpu__time_duration.avg                                    usecond       629.79
    smsp__cycles_active.avg.pct_of_peak_sustained_elapsed           %        98.42
    ----------------------------------------------------- ----------- ------------

    Section: GPU Speed Of Light Throughput
    ----------------------- ------------- ------------
    Metric Name               Metric Unit Metric Value
    ----------------------- ------------- ------------
    DRAM Frequency          cycle/nsecond         1.21
    SM Frequency            cycle/nsecond         1.09
    Elapsed Cycles                  cycle      688,003
    Memory Throughput                   %        32.35
    DRAM Throughput                     %        32.35
    Duration                      usecond       629.79
    L1/TEX Cache Throughput             %        17.73
    L2 Cache Throughput                 %        40.72
    SM Active Cycles                cycle   672,279.02
    Compute (SM) Throughput             %        33.52
    ----------------------- ------------- ------------

    OPT   This kernel exhibits low compute throughput and memory bandwidth utilization relative to the peak performance 
          of this device. Achieved compute throughput and/or memory bandwidth below 60.0% of peak typically indicate    
          latency issues. Look at Scheduler Statistics and Warp State Statistics for potential reasons.                 

    Section: Launch Statistics
    -------------------------------- --------------- ---------------
    Metric Name                          Metric Unit    Metric Value
    -------------------------------- --------------- ---------------
    Block Size                                                    32
    Function Cache Configuration                     CachePreferNone
    Grid Size                                                  4,096
    Registers Per Thread             register/thread              23
    Shared Memory Configuration Size           Kbyte           32.77
    Driver Shared Memory Per Block       Kbyte/block            1.02
    Dynamic Shared Memory Per Block       byte/block               0
    Static Shared Memory Per Block        byte/block               0
    Threads                                   thread         131,072
    Waves Per SM                                                1.19
    -------------------------------- --------------- ---------------

    OPT   Estimated Speedup: 50%                                                                                        
          A wave of thread blocks is defined as the maximum number of blocks that can be executed in parallel on the    
          target GPU. The number of blocks in a wave depends on the number of multiprocessors and the theoretical       
          occupancy of the kernel. This kernel launch results in 1 full waves and a partial wave of 639 thread blocks.  
          Under the assumption of a uniform execution duration of all thread blocks, the partial wave may account for   
          up to 50.0% of the total kernel runtime with a lower occupancy of 34.4%. Try launching a grid with no         
          partial wave. The overall impact of this tail effect also lessens with the number of full waves executed for  
          a grid. See the Hardware Model                                                                                
          (https://docs.nvidia.com/nsight-compute/ProfilingGuide/index.html#metrics-hw-model) description for more      
          details on launch configurations.                                                                             

    Section: Occupancy
    ------------------------------- ----------- ------------
    Metric Name                     Metric Unit Metric Value
    ------------------------------- ----------- ------------
    Block Limit SM                        block           32
    Block Limit Registers                 block           84
    Block Limit Shared Mem                block           32
    Block Limit Warps                     block           64
    Theoretical Active Warps per SM        warp           32
    Theoretical Occupancy                     %           50
    Achieved Occupancy                        %        32.78
    Achieved Active Warps Per SM           warp        20.98
    ------------------------------- ----------- ------------

    OPT   Estimated Speedup: 34.43%                                                                                     
          This kernel's theoretical occupancy (50.0%) is limited by the number of blocks that can fit on the SM. This   
          kernel's theoretical occupancy (50.0%) is limited by the required amount of shared memory. The difference     
          between calculated theoretical (50.0%) and measured achieved occupancy (32.8%) can be the result of warp      
          scheduling overheads or workload imbalances during the kernel execution. Load imbalances can occur between    
          warps within a block as well as across blocks of the same kernel. See the CUDA Best Practices Guide           
          (https://docs.nvidia.com/cuda/cuda-c-best-practices-guide/index.html#occupancy) for more details on           
          optimizing occupancy.                                                                                         

    Section: Source Counters
    ------------------------- ----------- ------------
    Metric Name               Metric Unit Metric Value
    ------------------------- ----------- ------------
    Branch Instructions Ratio           %         0.06
    Branch Instructions              inst    5,738,541
    Branch Efficiency                   %        99.78
    Avg. Divergent Branches                      17.81
    ------------------------- ----------- ------------

    OPT   Estimated Speedup: 0%                                                                                         
          This kernel has uncoalesced global accesses resulting in a total of 6851808 excessive sectors (13% of the     
          total 52583746 sectors). Check the L2 Theoretical Sectors Global Excessive table for the primary source       
          locations. The CUDA Programming Guide                                                                         
          (https://docs.nvidia.com/cuda/cuda-c-programming-guide/index.html#device-memory-accesses) had additional      
          information on reducing uncoalesced device memory accesses.                                                   

ncu --set default --section SourceCounters --section Occupancy --section LaunchStats --section SpeedOfLight --metrics smsp__cycles_active.avg.pct_of_peak_sustained_elapsed,dram__throughput.avg.pct_of_peak_sustained_elapsed,gpu__time_duration.avg ./sobel_gpu -T 64 -B 1
==PROF== Connected to process 2153895 (/pscratch/sd/u/usatie/csc746-cp5-gpu-stencil/build/sobel_gpu)
 Read data from the file ../data/zebra-gray-int8-4x 
Command line number of `threads per block`: 64
Command line number of `thread blocks`: 1
==PROF== Profiling "sobel_kernel_gpu" - 0: 0%.
==WARNING== Launching the workload is taking more time than expected. If this continues to hang, terminate the profile and re-try by profiling the range of all related launches using '--replay-mode range'. See https://docs.nvidia.com/nsight-compute/ProfilingGuide/index.html#replay for more details.
...50%....100% - 13 passes
 GPU configuration: 1 blocks, 64 threads per block 
 Elapsed time is : 55.095473 (sec) 
 Wrote the output file ../data/processed-raw-int8-4x-gpu.dat 
==PROF== Disconnected from process 2153895
[2153895] sobel_gpu@127.0.0.1
  sobel_kernel_gpu(const float *, float *, int, int, int) (1, 1, 1)x(64, 1, 1), Context 1, Stream 7, Device 0, CC 8.0
    Section: Command line profiler metrics
    ----------------------------------------------------- ----------- ------------
    Metric Name                                           Metric Unit Metric Value
    ----------------------------------------------------- ----------- ------------
    dram__throughput.avg.pct_of_peak_sustained_elapsed              %         0.04
    gpu__time_duration.avg                                    msecond       460.91
    smsp__cycles_active.avg.pct_of_peak_sustained_elapsed           %         0.46
    ----------------------------------------------------- ----------- ------------

    Section: GPU Speed Of Light Throughput
    ----------------------- ------------- ------------
    Metric Name               Metric Unit Metric Value
    ----------------------- ------------- ------------
    DRAM Frequency          cycle/nsecond         1.21
    SM Frequency            cycle/nsecond         1.09
    Elapsed Cycles                  cycle  504,644,942
    Memory Throughput                   %         0.04
    DRAM Throughput                     %         0.04
    Duration                      msecond       460.91
    L1/TEX Cache Throughput             %         2.32
    L2 Cache Throughput                 %         0.04
    SM Active Cycles                cycle 4,672,982.26
    Compute (SM) Throughput             %         0.05
    ----------------------- ------------- ------------

    OPT   This kernel grid is too small to fill the available resources on this device, resulting in only 0.0 full      
          waves across all SMs. Look at Launch Statistics for more details.                                             

    Section: Launch Statistics
    -------------------------------- --------------- ---------------
    Metric Name                          Metric Unit    Metric Value
    -------------------------------- --------------- ---------------
    Block Size                                                    64
    Function Cache Configuration                     CachePreferNone
    Grid Size                                                      1
    Registers Per Thread             register/thread              23
    Shared Memory Configuration Size           Kbyte           32.77
    Driver Shared Memory Per Block       Kbyte/block            1.02
    Dynamic Shared Memory Per Block       byte/block               0
    Static Shared Memory Per Block        byte/block               0
    Threads                                   thread              64
    Waves Per SM                                                0.00
    -------------------------------- --------------- ---------------

    OPT   Estimated Speedup: 99.07%                                                                                     
          The grid for this launch is configured to execute only 1 blocks, which is less than the GPU's 108             
          multiprocessors. This can underutilize some multiprocessors. If you do not intend to execute this kernel      
          concurrently with other workloads, consider reducing the block size to have at least one block per            
          multiprocessor or increase the size of the grid to fully utilize the available hardware resources. See the    
          Hardware Model (https://docs.nvidia.com/nsight-compute/ProfilingGuide/index.html#metrics-hw-model)            
          description for more details on launch configurations.                                                        

    Section: Occupancy
    ------------------------------- ----------- ------------
    Metric Name                     Metric Unit Metric Value
    ------------------------------- ----------- ------------
    Block Limit SM                        block           32
    Block Limit Registers                 block           42
    Block Limit Shared Mem                block           32
    Block Limit Warps                     block           32
    Theoretical Active Warps per SM        warp           64
    Theoretical Occupancy                     %          100
    Achieved Occupancy                        %         3.12
    Achieved Active Warps Per SM           warp         2.00
    ------------------------------- ----------- ------------

    OPT   Estimated Speedup: 96.88%                                                                                     
          This kernel's theoretical occupancy is not impacted by any block limit. The difference between calculated     
          theoretical (100.0%) and measured achieved occupancy (3.1%) can be the result of warp scheduling overheads    
          or workload imbalances during the kernel execution. Load imbalances can occur between warps within a block    
          as well as across blocks of the same kernel. See the CUDA Best Practices Guide                                
          (https://docs.nvidia.com/cuda/cuda-c-best-practices-guide/index.html#occupancy) for more details on           
          optimizing occupancy.                                                                                         

    Section: Source Counters
    ------------------------- ----------- ------------
    Metric Name               Metric Unit Metric Value
    ------------------------- ----------- ------------
    Branch Instructions Ratio           %         0.06
    Branch Instructions              inst    5,730,353
    Branch Efficiency                   %        99.78
    Avg. Divergent Branches                      17.81
    ------------------------- ----------- ------------

    OPT   Estimated Speedup: 0%                                                                                         
          This kernel has uncoalesced global accesses resulting in a total of 6851808 excessive sectors (13% of the     
          total 52583746 sectors). Check the L2 Theoretical Sectors Global Excessive table for the primary source       
          locations. The CUDA Programming Guide                                                                         
          (https://docs.nvidia.com/cuda/cuda-c-programming-guide/index.html#device-memory-accesses) had additional      
          information on reducing uncoalesced device memory accesses.                                                   

ncu --set default --section SourceCounters --section Occupancy --section LaunchStats --section SpeedOfLight --metrics smsp__cycles_active.avg.pct_of_peak_sustained_elapsed,dram__throughput.avg.pct_of_peak_sustained_elapsed,gpu__time_duration.avg ./sobel_gpu -T 64 -B 4
==PROF== Connected to process 2154007 (/pscratch/sd/u/usatie/csc746-cp5-gpu-stencil/build/sobel_gpu)
 Read data from the file ../data/zebra-gray-int8-4x 
Command line number of `threads per block`: 64
Command line number of `thread blocks`: 4
==PROF== Profiling "sobel_kernel_gpu" - 0: 0%.
==WARNING== Launching the workload is taking more time than expected. If this continues to hang, terminate the profile and re-try by profiling the range of all related launches using '--replay-mode range'. See https://docs.nvidia.com/nsight-compute/ProfilingGuide/index.html#replay for more details.
...50%....100% - 13 passes
 GPU configuration: 4 blocks, 64 threads per block 
 Elapsed time is : 15.292106 (sec) 
 Wrote the output file ../data/processed-raw-int8-4x-gpu.dat 
==PROF== Disconnected from process 2154007
[2154007] sobel_gpu@127.0.0.1
  sobel_kernel_gpu(const float *, float *, int, int, int) (4, 1, 1)x(64, 1, 1), Context 1, Stream 7, Device 0, CC 8.0
    Section: Command line profiler metrics
    ----------------------------------------------------- ----------- ------------
    Metric Name                                           Metric Unit Metric Value
    ----------------------------------------------------- ----------- ------------
    dram__throughput.avg.pct_of_peak_sustained_elapsed              %         0.15
    gpu__time_duration.avg                                    msecond       120.43
    smsp__cycles_active.avg.pct_of_peak_sustained_elapsed           %         1.84
    ----------------------------------------------------- ----------- ------------

    Section: GPU Speed Of Light Throughput
    ----------------------- ------------- ------------
    Metric Name               Metric Unit Metric Value
    ----------------------- ------------- ------------
    DRAM Frequency          cycle/nsecond         1.22
    SM Frequency            cycle/nsecond         1.10
    Elapsed Cycles                  cycle  132,214,080
    Memory Throughput                   %         0.15
    DRAM Throughput                     %         0.15
    Duration                      msecond       120.43
    L1/TEX Cache Throughput             %         2.99
    L2 Cache Throughput                 %         0.21
    SM Active Cycles                cycle 4,913,303.90
    Compute (SM) Throughput             %         0.17
    ----------------------- ------------- ------------

    OPT   This kernel grid is too small to fill the available resources on this device, resulting in only 0.0 full      
          waves across all SMs. Look at Launch Statistics for more details.                                             

    Section: Launch Statistics
    -------------------------------- --------------- ---------------
    Metric Name                          Metric Unit    Metric Value
    -------------------------------- --------------- ---------------
    Block Size                                                    64
    Function Cache Configuration                     CachePreferNone
    Grid Size                                                      4
    Registers Per Thread             register/thread              23
    Shared Memory Configuration Size           Kbyte           32.77
    Driver Shared Memory Per Block       Kbyte/block            1.02
    Dynamic Shared Memory Per Block       byte/block               0
    Static Shared Memory Per Block        byte/block               0
    Threads                                   thread             256
    Waves Per SM                                                0.00
    -------------------------------- --------------- ---------------

    OPT   Estimated Speedup: 96.3%                                                                                      
          The grid for this launch is configured to execute only 4 blocks, which is less than the GPU's 108             
          multiprocessors. This can underutilize some multiprocessors. If you do not intend to execute this kernel      
          concurrently with other workloads, consider reducing the block size to have at least one block per            
          multiprocessor or increase the size of the grid to fully utilize the available hardware resources. See the    
          Hardware Model (https://docs.nvidia.com/nsight-compute/ProfilingGuide/index.html#metrics-hw-model)            
          description for more details on launch configurations.                                                        

    Section: Occupancy
    ------------------------------- ----------- ------------
    Metric Name                     Metric Unit Metric Value
    ------------------------------- ----------- ------------
    Block Limit SM                        block           32
    Block Limit Registers                 block           42
    Block Limit Shared Mem                block           32
    Block Limit Warps                     block           32
    Theoretical Active Warps per SM        warp           64
    Theoretical Occupancy                     %          100
    Achieved Occupancy                        %         3.12
    Achieved Active Warps Per SM           warp         2.00
    ------------------------------- ----------- ------------

    OPT   Estimated Speedup: 96.88%                                                                                     
          This kernel's theoretical occupancy is not impacted by any block limit. The difference between calculated     
          theoretical (100.0%) and measured achieved occupancy (3.1%) can be the result of warp scheduling overheads    
          or workload imbalances during the kernel execution. Load imbalances can occur between warps within a block    
          as well as across blocks of the same kernel. See the CUDA Best Practices Guide                                
          (https://docs.nvidia.com/cuda/cuda-c-best-practices-guide/index.html#occupancy) for more details on           
          optimizing occupancy.                                                                                         

    Section: Source Counters
    ------------------------- ----------- ------------
    Metric Name               Metric Unit Metric Value
    ------------------------- ----------- ------------
    Branch Instructions Ratio           %         0.06
    Branch Instructions              inst    5,730,365
    Branch Efficiency                   %        99.78
    Avg. Divergent Branches                      17.81
    ------------------------- ----------- ------------

    OPT   Estimated Speedup: 0%                                                                                         
          This kernel has uncoalesced global accesses resulting in a total of 6851808 excessive sectors (13% of the     
          total 52583746 sectors). Check the L2 Theoretical Sectors Global Excessive table for the primary source       
          locations. The CUDA Programming Guide                                                                         
          (https://docs.nvidia.com/cuda/cuda-c-programming-guide/index.html#device-memory-accesses) had additional      
          information on reducing uncoalesced device memory accesses.                                                   

ncu --set default --section SourceCounters --section Occupancy --section LaunchStats --section SpeedOfLight --metrics smsp__cycles_active.avg.pct_of_peak_sustained_elapsed,dram__throughput.avg.pct_of_peak_sustained_elapsed,gpu__time_duration.avg ./sobel_gpu -T 64 -B 16
==PROF== Connected to process 2154072 (/pscratch/sd/u/usatie/csc746-cp5-gpu-stencil/build/sobel_gpu)
 Read data from the file ../data/zebra-gray-int8-4x 
Command line number of `threads per block`: 64
Command line number of `thread blocks`: 16
==PROF== Profiling "sobel_kernel_gpu" - 0: 0%....50%....100% - 13 passes
 GPU configuration: 16 blocks, 64 threads per block 
 Elapsed time is : 5.130395 (sec) 
 Wrote the output file ../data/processed-raw-int8-4x-gpu.dat 
==PROF== Disconnected from process 2154072
[2154072] sobel_gpu@127.0.0.1
  sobel_kernel_gpu(const float *, float *, int, int, int) (16, 1, 1)x(64, 1, 1), Context 1, Stream 7, Device 0, CC 8.0
    Section: Command line profiler metrics
    ----------------------------------------------------- ----------- ------------
    Metric Name                                           Metric Unit Metric Value
    ----------------------------------------------------- ----------- ------------
    dram__throughput.avg.pct_of_peak_sustained_elapsed              %         0.59
    gpu__time_duration.avg                                    msecond        30.55
    smsp__cycles_active.avg.pct_of_peak_sustained_elapsed           %         7.46
    ----------------------------------------------------- ----------- ------------

    Section: GPU Speed Of Light Throughput
    ----------------------- ------------- ------------
    Metric Name               Metric Unit Metric Value
    ----------------------- ------------- ------------
    DRAM Frequency          cycle/nsecond         1.21
    SM Frequency            cycle/nsecond         1.09
    Elapsed Cycles                  cycle   33,390,975
    Memory Throughput                   %         0.59
    DRAM Throughput                     %         0.59
    Duration                      msecond        30.55
    L1/TEX Cache Throughput             %         2.91
    L2 Cache Throughput                 %         0.81
    SM Active Cycles                cycle 4,937,652.94
    Compute (SM) Throughput             %         0.69
    ----------------------- ------------- ------------

    OPT   This kernel grid is too small to fill the available resources on this device, resulting in only 0.0 full      
          waves across all SMs. Look at Launch Statistics for more details.                                             

    Section: Launch Statistics
    -------------------------------- --------------- ---------------
    Metric Name                          Metric Unit    Metric Value
    -------------------------------- --------------- ---------------
    Block Size                                                    64
    Function Cache Configuration                     CachePreferNone
    Grid Size                                                     16
    Registers Per Thread             register/thread              23
    Shared Memory Configuration Size           Kbyte           32.77
    Driver Shared Memory Per Block       Kbyte/block            1.02
    Dynamic Shared Memory Per Block       byte/block               0
    Static Shared Memory Per Block        byte/block               0
    Threads                                   thread           1,024
    Waves Per SM                                                0.00
    -------------------------------- --------------- ---------------

    OPT   Estimated Speedup: 85.19%                                                                                     
          The grid for this launch is configured to execute only 16 blocks, which is less than the GPU's 108            
          multiprocessors. This can underutilize some multiprocessors. If you do not intend to execute this kernel      
          concurrently with other workloads, consider reducing the block size to have at least one block per            
          multiprocessor or increase the size of the grid to fully utilize the available hardware resources. See the    
          Hardware Model (https://docs.nvidia.com/nsight-compute/ProfilingGuide/index.html#metrics-hw-model)            
          description for more details on launch configurations.                                                        

    Section: Occupancy
    ------------------------------- ----------- ------------
    Metric Name                     Metric Unit Metric Value
    ------------------------------- ----------- ------------
    Block Limit SM                        block           32
    Block Limit Registers                 block           42
    Block Limit Shared Mem                block           32
    Block Limit Warps                     block           32
    Theoretical Active Warps per SM        warp           64
    Theoretical Occupancy                     %          100
    Achieved Occupancy                        %         3.12
    Achieved Active Warps Per SM           warp         2.00
    ------------------------------- ----------- ------------

    OPT   Estimated Speedup: 96.88%                                                                                     
          This kernel's theoretical occupancy is not impacted by any block limit. The difference between calculated     
          theoretical (100.0%) and measured achieved occupancy (3.1%) can be the result of warp scheduling overheads    
          or workload imbalances during the kernel execution. Load imbalances can occur between warps within a block    
          as well as across blocks of the same kernel. See the CUDA Best Practices Guide                                
          (https://docs.nvidia.com/cuda/cuda-c-best-practices-guide/index.html#occupancy) for more details on           
          optimizing occupancy.                                                                                         

    Section: Source Counters
    ------------------------- ----------- ------------
    Metric Name               Metric Unit Metric Value
    ------------------------- ----------- ------------
    Branch Instructions Ratio           %         0.06
    Branch Instructions              inst    5,730,413
    Branch Efficiency                   %        99.78
    Avg. Divergent Branches                      17.81
    ------------------------- ----------- ------------

    OPT   Estimated Speedup: 0%                                                                                         
          This kernel has uncoalesced global accesses resulting in a total of 6851808 excessive sectors (13% of the     
          total 52583746 sectors). Check the L2 Theoretical Sectors Global Excessive table for the primary source       
          locations. The CUDA Programming Guide                                                                         
          (https://docs.nvidia.com/cuda/cuda-c-programming-guide/index.html#device-memory-accesses) had additional      
          information on reducing uncoalesced device memory accesses.                                                   

ncu --set default --section SourceCounters --section Occupancy --section LaunchStats --section SpeedOfLight --metrics smsp__cycles_active.avg.pct_of_peak_sustained_elapsed,dram__throughput.avg.pct_of_peak_sustained_elapsed,gpu__time_duration.avg ./sobel_gpu -T 64 -B 64
==PROF== Connected to process 2154140 (/pscratch/sd/u/usatie/csc746-cp5-gpu-stencil/build/sobel_gpu)
 Read data from the file ../data/zebra-gray-int8-4x 
Command line number of `threads per block`: 64
Command line number of `thread blocks`: 64
==PROF== Profiling "sobel_kernel_gpu" - 0: 0%....50%....100% - 13 passes
 GPU configuration: 64 blocks, 64 threads per block 
 Elapsed time is : 2.572185 (sec) 
 Wrote the output file ../data/processed-raw-int8-4x-gpu.dat 
==PROF== Disconnected from process 2154140
[2154140] sobel_gpu@127.0.0.1
  sobel_kernel_gpu(const float *, float *, int, int, int) (64, 1, 1)x(64, 1, 1), Context 1, Stream 7, Device 0, CC 8.0
    Section: Command line profiler metrics
    ----------------------------------------------------- ----------- ------------
    Metric Name                                           Metric Unit Metric Value
    ----------------------------------------------------- ----------- ------------
    dram__throughput.avg.pct_of_peak_sustained_elapsed              %         2.38
    gpu__time_duration.avg                                    msecond         7.58
    smsp__cycles_active.avg.pct_of_peak_sustained_elapsed           %        29.61
    ----------------------------------------------------- ----------- ------------

    Section: GPU Speed Of Light Throughput
    ----------------------- ------------- ------------
    Metric Name               Metric Unit Metric Value
    ----------------------- ------------- ------------
    DRAM Frequency          cycle/nsecond         1.22
    SM Frequency            cycle/nsecond         1.10
    Elapsed Cycles                  cycle    8,307,334
    Memory Throughput                   %         2.38
    DRAM Throughput                     %         2.38
    Duration                      msecond         7.58
    L1/TEX Cache Throughput             %         2.35
    L2 Cache Throughput                 %         3.20
    SM Active Cycles                cycle 4,906,218.28
    Compute (SM) Throughput             %         2.77
    ----------------------- ------------- ------------

    OPT   This kernel grid is too small to fill the available resources on this device, resulting in only 0.0 full      
          waves across all SMs. Look at Launch Statistics for more details.                                             

    Section: Launch Statistics
    -------------------------------- --------------- ---------------
    Metric Name                          Metric Unit    Metric Value
    -------------------------------- --------------- ---------------
    Block Size                                                    64
    Function Cache Configuration                     CachePreferNone
    Grid Size                                                     64
    Registers Per Thread             register/thread              23
    Shared Memory Configuration Size           Kbyte           32.77
    Driver Shared Memory Per Block       Kbyte/block            1.02
    Dynamic Shared Memory Per Block       byte/block               0
    Static Shared Memory Per Block        byte/block               0
    Threads                                   thread           4,096
    Waves Per SM                                                0.02
    -------------------------------- --------------- ---------------

    OPT   Estimated Speedup: 40.74%                                                                                     
          The grid for this launch is configured to execute only 64 blocks, which is less than the GPU's 108            
          multiprocessors. This can underutilize some multiprocessors. If you do not intend to execute this kernel      
          concurrently with other workloads, consider reducing the block size to have at least one block per            
          multiprocessor or increase the size of the grid to fully utilize the available hardware resources. See the    
          Hardware Model (https://docs.nvidia.com/nsight-compute/ProfilingGuide/index.html#metrics-hw-model)            
          description for more details on launch configurations.                                                        

    Section: Occupancy
    ------------------------------- ----------- ------------
    Metric Name                     Metric Unit Metric Value
    ------------------------------- ----------- ------------
    Block Limit SM                        block           32
    Block Limit Registers                 block           42
    Block Limit Shared Mem                block           32
    Block Limit Warps                     block           32
    Theoretical Active Warps per SM        warp           64
    Theoretical Occupancy                     %          100
    Achieved Occupancy                        %         3.12
    Achieved Active Warps Per SM           warp         2.00
    ------------------------------- ----------- ------------

    OPT   Estimated Speedup: 96.88%                                                                                     
          This kernel's theoretical occupancy is not impacted by any block limit. The difference between calculated     
          theoretical (100.0%) and measured achieved occupancy (3.1%) can be the result of warp scheduling overheads    
          or workload imbalances during the kernel execution. Load imbalances can occur between warps within a block    
          as well as across blocks of the same kernel. See the CUDA Best Practices Guide                                
          (https://docs.nvidia.com/cuda/cuda-c-best-practices-guide/index.html#occupancy) for more details on           
          optimizing occupancy.                                                                                         

    Section: Source Counters
    ------------------------- ----------- ------------
    Metric Name               Metric Unit Metric Value
    ------------------------- ----------- ------------
    Branch Instructions Ratio           %         0.06
    Branch Instructions              inst    5,730,605
    Branch Efficiency                   %        99.78
    Avg. Divergent Branches                      17.81
    ------------------------- ----------- ------------

    OPT   Estimated Speedup: 0%                                                                                         
          This kernel has uncoalesced global accesses resulting in a total of 6851808 excessive sectors (13% of the     
          total 52583746 sectors). Check the L2 Theoretical Sectors Global Excessive table for the primary source       
          locations. The CUDA Programming Guide                                                                         
          (https://docs.nvidia.com/cuda/cuda-c-programming-guide/index.html#device-memory-accesses) had additional      
          information on reducing uncoalesced device memory accesses.                                                   

ncu --set default --section SourceCounters --section Occupancy --section LaunchStats --section SpeedOfLight --metrics smsp__cycles_active.avg.pct_of_peak_sustained_elapsed,dram__throughput.avg.pct_of_peak_sustained_elapsed,gpu__time_duration.avg ./sobel_gpu -T 64 -B 256
==PROF== Connected to process 2154184 (/pscratch/sd/u/usatie/csc746-cp5-gpu-stencil/build/sobel_gpu)
 Read data from the file ../data/zebra-gray-int8-4x 
Command line number of `threads per block`: 64
Command line number of `thread blocks`: 256
==PROF== Profiling "sobel_kernel_gpu" - 0: 0%....50%....100% - 13 passes
 GPU configuration: 256 blocks, 64 threads per block 
 Elapsed time is : 1.945498 (sec) 
 Wrote the output file ../data/processed-raw-int8-4x-gpu.dat 
==PROF== Disconnected from process 2154184
[2154184] sobel_gpu@127.0.0.1
  sobel_kernel_gpu(const float *, float *, int, int, int) (256, 1, 1)x(64, 1, 1), Context 1, Stream 7, Device 0, CC 8.0
    Section: Command line profiler metrics
    ----------------------------------------------------- ----------- ------------
    Metric Name                                           Metric Unit Metric Value
    ----------------------------------------------------- ----------- ------------
    dram__throughput.avg.pct_of_peak_sustained_elapsed              %         8.65
    gpu__time_duration.avg                                    msecond         2.09
    smsp__cycles_active.avg.pct_of_peak_sustained_elapsed           %        90.27
    ----------------------------------------------------- ----------- ------------

    Section: GPU Speed Of Light Throughput
    ----------------------- ------------- ------------
    Metric Name               Metric Unit Metric Value
    ----------------------- ------------- ------------
    DRAM Frequency          cycle/nsecond         1.21
    SM Frequency            cycle/nsecond         1.09
    Elapsed Cycles                  cycle    2,289,412
    Memory Throughput                   %         8.65
    DRAM Throughput                     %         8.65
    Duration                      msecond         2.09
    L1/TEX Cache Throughput             %         5.36
    L2 Cache Throughput                 %        11.47
    SM Active Cycles                cycle 2,279,826.66
    Compute (SM) Throughput             %        10.06
    ----------------------- ------------- ------------

    OPT   This kernel grid is too small to fill the available resources on this device, resulting in only 0.1 full      
          waves across all SMs. Look at Launch Statistics for more details.                                             

    Section: Launch Statistics
    -------------------------------- --------------- ---------------
    Metric Name                          Metric Unit    Metric Value
    -------------------------------- --------------- ---------------
    Block Size                                                    64
    Function Cache Configuration                     CachePreferNone
    Grid Size                                                    256
    Registers Per Thread             register/thread              23
    Shared Memory Configuration Size           Kbyte           32.77
    Driver Shared Memory Per Block       Kbyte/block            1.02
    Dynamic Shared Memory Per Block       byte/block               0
    Static Shared Memory Per Block        byte/block               0
    Threads                                   thread          16,384
    Waves Per SM                                                0.07
    -------------------------------- --------------- ---------------

    Section: Occupancy
    ------------------------------- ----------- ------------
    Metric Name                     Metric Unit Metric Value
    ------------------------------- ----------- ------------
    Block Limit SM                        block           32
    Block Limit Registers                 block           42
    Block Limit Shared Mem                block           32
    Block Limit Warps                     block           32
    Theoretical Active Warps per SM        warp           64
    Theoretical Occupancy                     %          100
    Achieved Occupancy                        %         7.40
    Achieved Active Warps Per SM           warp         4.74
    ------------------------------- ----------- ------------

    OPT   Estimated Speedup: 92.6%                                                                                      
          This kernel's theoretical occupancy is not impacted by any block limit. The difference between calculated     
          theoretical (100.0%) and measured achieved occupancy (7.4%) can be the result of warp scheduling overheads    
          or workload imbalances during the kernel execution. Load imbalances can occur between warps within a block    
          as well as across blocks of the same kernel. See the CUDA Best Practices Guide                                
          (https://docs.nvidia.com/cuda/cuda-c-best-practices-guide/index.html#occupancy) for more details on           
          optimizing occupancy.                                                                                         

    Section: Source Counters
    ------------------------- ----------- ------------
    Metric Name               Metric Unit Metric Value
    ------------------------- ----------- ------------
    Branch Instructions Ratio           %         0.06
    Branch Instructions              inst    5,731,373
    Branch Efficiency                   %        99.78
    Avg. Divergent Branches                      17.81
    ------------------------- ----------- ------------

    OPT   Estimated Speedup: 0%                                                                                         
          This kernel has uncoalesced global accesses resulting in a total of 6851808 excessive sectors (13% of the     
          total 52583746 sectors). Check the L2 Theoretical Sectors Global Excessive table for the primary source       
          locations. The CUDA Programming Guide                                                                         
          (https://docs.nvidia.com/cuda/cuda-c-programming-guide/index.html#device-memory-accesses) had additional      
          information on reducing uncoalesced device memory accesses.                                                   

ncu --set default --section SourceCounters --section Occupancy --section LaunchStats --section SpeedOfLight --metrics smsp__cycles_active.avg.pct_of_peak_sustained_elapsed,dram__throughput.avg.pct_of_peak_sustained_elapsed,gpu__time_duration.avg ./sobel_gpu -T 64 -B 1024
==PROF== Connected to process 2154229 (/pscratch/sd/u/usatie/csc746-cp5-gpu-stencil/build/sobel_gpu)
 Read data from the file ../data/zebra-gray-int8-4x 
Command line number of `threads per block`: 64
Command line number of `thread blocks`: 1024
==PROF== Profiling "sobel_kernel_gpu" - 0: 0%....50%....100% - 13 passes
 GPU configuration: 1024 blocks, 64 threads per block 
 Elapsed time is : 1.969604 (sec) 
 Wrote the output file ../data/processed-raw-int8-4x-gpu.dat 
==PROF== Disconnected from process 2154229
[2154229] sobel_gpu@127.0.0.1
  sobel_kernel_gpu(const float *, float *, int, int, int) (1024, 1, 1)x(64, 1, 1), Context 1, Stream 7, Device 0, CC 8.0
    Section: Command line profiler metrics
    ----------------------------------------------------- ----------- ------------
    Metric Name                                           Metric Unit Metric Value
    ----------------------------------------------------- ----------- ------------
    dram__throughput.avg.pct_of_peak_sustained_elapsed              %        27.69
    gpu__time_duration.avg                                    usecond       657.44
    smsp__cycles_active.avg.pct_of_peak_sustained_elapsed           %        97.36
    ----------------------------------------------------- ----------- ------------

    Section: GPU Speed Of Light Throughput
    ----------------------- ------------- ------------
    Metric Name               Metric Unit Metric Value
    ----------------------- ------------- ------------
    DRAM Frequency          cycle/nsecond         1.21
    SM Frequency            cycle/nsecond         1.09
    Elapsed Cycles                  cycle      718,190
    Memory Throughput                   %        27.69
    DRAM Throughput                     %        27.69
    Duration                      usecond       657.44
    L1/TEX Cache Throughput             %        18.94
    L2 Cache Throughput                 %        36.12
    SM Active Cycles                cycle   703,951.03
    Compute (SM) Throughput             %        32.10
    ----------------------- ------------- ------------

    OPT   This kernel grid is too small to fill the available resources on this device, resulting in only 0.3 full      
          waves across all SMs. Look at Launch Statistics for more details.                                             

    Section: Launch Statistics
    -------------------------------- --------------- ---------------
    Metric Name                          Metric Unit    Metric Value
    -------------------------------- --------------- ---------------
    Block Size                                                    64
    Function Cache Configuration                     CachePreferNone
    Grid Size                                                  1,024
    Registers Per Thread             register/thread              23
    Shared Memory Configuration Size           Kbyte           32.77
    Driver Shared Memory Per Block       Kbyte/block            1.02
    Dynamic Shared Memory Per Block       byte/block               0
    Static Shared Memory Per Block        byte/block               0
    Threads                                   thread          65,536
    Waves Per SM                                                0.30
    -------------------------------- --------------- ---------------

    Section: Occupancy
    ------------------------------- ----------- ------------
    Metric Name                     Metric Unit Metric Value
    ------------------------------- ----------- ------------
    Block Limit SM                        block           32
    Block Limit Registers                 block           42
    Block Limit Shared Mem                block           32
    Block Limit Warps                     block           32
    Theoretical Active Warps per SM        warp           64
    Theoretical Occupancy                     %          100
    Achieved Occupancy                        %        28.81
    Achieved Active Warps Per SM           warp        18.44
    ------------------------------- ----------- ------------

    OPT   Estimated Speedup: 71.19%                                                                                     
          This kernel's theoretical occupancy is not impacted by any block limit. The difference between calculated     
          theoretical (100.0%) and measured achieved occupancy (28.8%) can be the result of warp scheduling overheads   
          or workload imbalances during the kernel execution. Load imbalances can occur between warps within a block    
          as well as across blocks of the same kernel. See the CUDA Best Practices Guide                                
          (https://docs.nvidia.com/cuda/cuda-c-best-practices-guide/index.html#occupancy) for more details on           
          optimizing occupancy.                                                                                         

    Section: Source Counters
    ------------------------- ----------- ------------
    Metric Name               Metric Unit Metric Value
    ------------------------- ----------- ------------
    Branch Instructions Ratio           %         0.06
    Branch Instructions              inst    5,734,445
    Branch Efficiency                   %        99.78
    Avg. Divergent Branches                      17.81
    ------------------------- ----------- ------------

    OPT   Estimated Speedup: 0%                                                                                         
          This kernel has uncoalesced global accesses resulting in a total of 6851808 excessive sectors (13% of the     
          total 52583746 sectors). Check the L2 Theoretical Sectors Global Excessive table for the primary source       
          locations. The CUDA Programming Guide                                                                         
          (https://docs.nvidia.com/cuda/cuda-c-programming-guide/index.html#device-memory-accesses) had additional      
          information on reducing uncoalesced device memory accesses.                                                   

ncu --set default --section SourceCounters --section Occupancy --section LaunchStats --section SpeedOfLight --metrics smsp__cycles_active.avg.pct_of_peak_sustained_elapsed,dram__throughput.avg.pct_of_peak_sustained_elapsed,gpu__time_duration.avg ./sobel_gpu -T 64 -B 4096
==PROF== Connected to process 2154297 (/pscratch/sd/u/usatie/csc746-cp5-gpu-stencil/build/sobel_gpu)
 Read data from the file ../data/zebra-gray-int8-4x 
Command line number of `threads per block`: 64
Command line number of `thread blocks`: 4096
==PROF== Profiling "sobel_kernel_gpu" - 0: 0%....50%....100% - 13 passes
 GPU configuration: 4096 blocks, 64 threads per block 
 Elapsed time is : 1.890381 (sec) 
 Wrote the output file ../data/processed-raw-int8-4x-gpu.dat 
==PROF== Disconnected from process 2154297
[2154297] sobel_gpu@127.0.0.1
  sobel_kernel_gpu(const float *, float *, int, int, int) (4096, 1, 1)x(64, 1, 1), Context 1, Stream 7, Device 0, CC 8.0
    Section: Command line profiler metrics
    ----------------------------------------------------- ----------- ------------
    Metric Name                                           Metric Unit Metric Value
    ----------------------------------------------------- ----------- ------------
    dram__throughput.avg.pct_of_peak_sustained_elapsed              %        47.22
    gpu__time_duration.avg                                    usecond       409.98
    smsp__cycles_active.avg.pct_of_peak_sustained_elapsed           %        97.27
    ----------------------------------------------------- ----------- ------------

    Section: GPU Speed Of Light Throughput
    ----------------------- ------------- ------------
    Metric Name               Metric Unit Metric Value
    ----------------------- ------------- ------------
    DRAM Frequency          cycle/nsecond         1.22
    SM Frequency            cycle/nsecond         1.09
    Elapsed Cycles                  cycle      448,770
    Memory Throughput                   %        47.22
    DRAM Throughput                     %        47.22
    Duration                      usecond       409.98
    L1/TEX Cache Throughput             %        31.29
    L2 Cache Throughput                 %        56.94
    SM Active Cycles                cycle   438,865.76
    Compute (SM) Throughput             %        51.43
    ----------------------- ------------- ------------

    OPT   This kernel exhibits low compute throughput and memory bandwidth utilization relative to the peak performance 
          of this device. Achieved compute throughput and/or memory bandwidth below 60.0% of peak typically indicate    
          latency issues. Look at Scheduler Statistics and Warp State Statistics for potential reasons.                 

    Section: Launch Statistics
    -------------------------------- --------------- ---------------
    Metric Name                          Metric Unit    Metric Value
    -------------------------------- --------------- ---------------
    Block Size                                                    64
    Function Cache Configuration                     CachePreferNone
    Grid Size                                                  4,096
    Registers Per Thread             register/thread              23
    Shared Memory Configuration Size           Kbyte           32.77
    Driver Shared Memory Per Block       Kbyte/block            1.02
    Dynamic Shared Memory Per Block       byte/block               0
    Static Shared Memory Per Block        byte/block               0
    Threads                                   thread         262,144
    Waves Per SM                                                1.19
    -------------------------------- --------------- ---------------

    OPT   Estimated Speedup: 50%                                                                                        
          A wave of thread blocks is defined as the maximum number of blocks that can be executed in parallel on the    
          target GPU. The number of blocks in a wave depends on the number of multiprocessors and the theoretical       
          occupancy of the kernel. This kernel launch results in 1 full waves and a partial wave of 639 thread blocks.  
          Under the assumption of a uniform execution duration of all thread blocks, the partial wave may account for   
          up to 50.0% of the total kernel runtime with a lower occupancy of 27.6%. Try launching a grid with no         
          partial wave. The overall impact of this tail effect also lessens with the number of full waves executed for  
          a grid. See the Hardware Model                                                                                
          (https://docs.nvidia.com/nsight-compute/ProfilingGuide/index.html#metrics-hw-model) description for more      
          details on launch configurations.                                                                             

    Section: Occupancy
    ------------------------------- ----------- ------------
    Metric Name                     Metric Unit Metric Value
    ------------------------------- ----------- ------------
    Block Limit SM                        block           32
    Block Limit Registers                 block           42
    Block Limit Shared Mem                block           32
    Block Limit Warps                     block           32
    Theoretical Active Warps per SM        warp           64
    Theoretical Occupancy                     %          100
    Achieved Occupancy                        %        72.36
    Achieved Active Warps Per SM           warp        46.31
    ------------------------------- ----------- ------------

    OPT   Estimated Speedup: 27.64%                                                                                     
          This kernel's theoretical occupancy is not impacted by any block limit. The difference between calculated     
          theoretical (100.0%) and measured achieved occupancy (72.4%) can be the result of warp scheduling overheads   
          or workload imbalances during the kernel execution. Load imbalances can occur between warps within a block    
          as well as across blocks of the same kernel. See the CUDA Best Practices Guide                                
          (https://docs.nvidia.com/cuda/cuda-c-best-practices-guide/index.html#occupancy) for more details on           
          optimizing occupancy.                                                                                         

    Section: Source Counters
    ------------------------- ----------- ------------
    Metric Name               Metric Unit Metric Value
    ------------------------- ----------- ------------
    Branch Instructions Ratio           %         0.06
    Branch Instructions              inst    5,746,733
    Branch Efficiency                   %        99.78
    Avg. Divergent Branches                      17.81
    ------------------------- ----------- ------------

    OPT   Estimated Speedup: 0%                                                                                         
          This kernel has uncoalesced global accesses resulting in a total of 6851808 excessive sectors (13% of the     
          total 52583746 sectors). Check the L2 Theoretical Sectors Global Excessive table for the primary source       
          locations. The CUDA Programming Guide                                                                         
          (https://docs.nvidia.com/cuda/cuda-c-programming-guide/index.html#device-memory-accesses) had additional      
          information on reducing uncoalesced device memory accesses.                                                   

ncu --set default --section SourceCounters --section Occupancy --section LaunchStats --section SpeedOfLight --metrics smsp__cycles_active.avg.pct_of_peak_sustained_elapsed,dram__throughput.avg.pct_of_peak_sustained_elapsed,gpu__time_duration.avg ./sobel_gpu -T 128 -B 1
==PROF== Connected to process 2154341 (/pscratch/sd/u/usatie/csc746-cp5-gpu-stencil/build/sobel_gpu)
 Read data from the file ../data/zebra-gray-int8-4x 
Command line number of `threads per block`: 128
Command line number of `thread blocks`: 1
==PROF== Profiling "sobel_kernel_gpu" - 0: 0%.
==WARNING== Launching the workload is taking more time than expected. If this continues to hang, terminate the profile and re-try by profiling the range of all related launches using '--replay-mode range'. See https://docs.nvidia.com/nsight-compute/ProfilingGuide/index.html#replay for more details.
...50%....100% - 13 passes
 GPU configuration: 1 blocks, 128 threads per block 
 Elapsed time is : 28.554721 (sec) 
 Wrote the output file ../data/processed-raw-int8-4x-gpu.dat 
==PROF== Disconnected from process 2154341
[2154341] sobel_gpu@127.0.0.1
  sobel_kernel_gpu(const float *, float *, int, int, int) (1, 1, 1)x(128, 1, 1), Context 1, Stream 7, Device 0, CC 8.0
    Section: Command line profiler metrics
    ----------------------------------------------------- ----------- ------------
    Metric Name                                           Metric Unit Metric Value
    ----------------------------------------------------- ----------- ------------
    dram__throughput.avg.pct_of_peak_sustained_elapsed              %         0.08
    gpu__time_duration.avg                                    msecond       239.26
    smsp__cycles_active.avg.pct_of_peak_sustained_elapsed           %         0.94
    ----------------------------------------------------- ----------- ------------

    Section: GPU Speed Of Light Throughput
    ----------------------- ------------- ------------
    Metric Name               Metric Unit Metric Value
    ----------------------- ------------- ------------
    DRAM Frequency          cycle/nsecond         1.21
    SM Frequency            cycle/nsecond         1.09
    Elapsed Cycles                  cycle  260,650,172
    Memory Throughput                   %         0.08
    DRAM Throughput                     %         0.08
    Duration                      msecond       239.26
    L1/TEX Cache Throughput             %         4.69
    L2 Cache Throughput                 %         0.07
    SM Active Cycles                cycle 2,425,426.73
    Compute (SM) Throughput             %         0.09
    ----------------------- ------------- ------------

    OPT   This kernel grid is too small to fill the available resources on this device, resulting in only 0.0 full      
          waves across all SMs. Look at Launch Statistics for more details.                                             

    Section: Launch Statistics
    -------------------------------- --------------- ---------------
    Metric Name                          Metric Unit    Metric Value
    -------------------------------- --------------- ---------------
    Block Size                                                   128
    Function Cache Configuration                     CachePreferNone
    Grid Size                                                      1
    Registers Per Thread             register/thread              23
    Shared Memory Configuration Size           Kbyte           32.77
    Driver Shared Memory Per Block       Kbyte/block            1.02
    Dynamic Shared Memory Per Block       byte/block               0
    Static Shared Memory Per Block        byte/block               0
    Threads                                   thread             128
    Waves Per SM                                                0.00
    -------------------------------- --------------- ---------------

    OPT   Estimated Speedup: 99.07%                                                                                     
          The grid for this launch is configured to execute only 1 blocks, which is less than the GPU's 108             
          multiprocessors. This can underutilize some multiprocessors. If you do not intend to execute this kernel      
          concurrently with other workloads, consider reducing the block size to have at least one block per            
          multiprocessor or increase the size of the grid to fully utilize the available hardware resources. See the    
          Hardware Model (https://docs.nvidia.com/nsight-compute/ProfilingGuide/index.html#metrics-hw-model)            
          description for more details on launch configurations.                                                        

    Section: Occupancy
    ------------------------------- ----------- ------------
    Metric Name                     Metric Unit Metric Value
    ------------------------------- ----------- ------------
    Block Limit SM                        block           32
    Block Limit Registers                 block           21
    Block Limit Shared Mem                block           32
    Block Limit Warps                     block           16
    Theoretical Active Warps per SM        warp           64
    Theoretical Occupancy                     %          100
    Achieved Occupancy                        %         6.25
    Achieved Active Warps Per SM           warp         4.00
    ------------------------------- ----------- ------------

    OPT   Estimated Speedup: 93.75%                                                                                     
          This kernel's theoretical occupancy is not impacted by any block limit. The difference between calculated     
          theoretical (100.0%) and measured achieved occupancy (6.2%) can be the result of warp scheduling overheads    
          or workload imbalances during the kernel execution. Load imbalances can occur between warps within a block    
          as well as across blocks of the same kernel. See the CUDA Best Practices Guide                                
          (https://docs.nvidia.com/cuda/cuda-c-best-practices-guide/index.html#occupancy) for more details on           
          optimizing occupancy.                                                                                         

    Section: Source Counters
    ------------------------- ----------- ------------
    Metric Name               Metric Unit Metric Value
    ------------------------- ----------- ------------
    Branch Instructions Ratio           %         0.06
    Branch Instructions              inst    5,730,357
    Branch Efficiency                   %        99.78
    Avg. Divergent Branches                      17.81
    ------------------------- ----------- ------------

    OPT   Estimated Speedup: 0%                                                                                         
          This kernel has uncoalesced global accesses resulting in a total of 6851808 excessive sectors (13% of the     
          total 52583746 sectors). Check the L2 Theoretical Sectors Global Excessive table for the primary source       
          locations. The CUDA Programming Guide                                                                         
          (https://docs.nvidia.com/cuda/cuda-c-programming-guide/index.html#device-memory-accesses) had additional      
          information on reducing uncoalesced device memory accesses.                                                   

ncu --set default --section SourceCounters --section Occupancy --section LaunchStats --section SpeedOfLight --metrics smsp__cycles_active.avg.pct_of_peak_sustained_elapsed,dram__throughput.avg.pct_of_peak_sustained_elapsed,gpu__time_duration.avg ./sobel_gpu -T 128 -B 4
==PROF== Connected to process 2154428 (/pscratch/sd/u/usatie/csc746-cp5-gpu-stencil/build/sobel_gpu)
 Read data from the file ../data/zebra-gray-int8-4x 
Command line number of `threads per block`: 128
Command line number of `thread blocks`: 4
==PROF== Profiling "sobel_kernel_gpu" - 0: 0%.
==WARNING== Launching the workload is taking more time than expected. If this continues to hang, terminate the profile and re-try by profiling the range of all related launches using '--replay-mode range'. See https://docs.nvidia.com/nsight-compute/ProfilingGuide/index.html#replay for more details.
...50%....100% - 13 passes
 GPU configuration: 4 blocks, 128 threads per block 
 Elapsed time is : 8.535062 (sec) 
 Wrote the output file ../data/processed-raw-int8-4x-gpu.dat 
==PROF== Disconnected from process 2154428
[2154428] sobel_gpu@127.0.0.1
  sobel_kernel_gpu(const float *, float *, int, int, int) (4, 1, 1)x(128, 1, 1), Context 1, Stream 7, Device 0, CC 8.0
    Section: Command line profiler metrics
    ----------------------------------------------------- ----------- ------------
    Metric Name                                           Metric Unit Metric Value
    ----------------------------------------------------- ----------- ------------
    dram__throughput.avg.pct_of_peak_sustained_elapsed              %         0.29
    gpu__time_duration.avg                                    msecond        63.26
    smsp__cycles_active.avg.pct_of_peak_sustained_elapsed           %         3.72
    ----------------------------------------------------- ----------- ------------

    Section: GPU Speed Of Light Throughput
    ----------------------- ------------- ------------
    Metric Name               Metric Unit Metric Value
    ----------------------- ------------- ------------
    DRAM Frequency          cycle/nsecond         1.21
    SM Frequency            cycle/nsecond         1.09
    Elapsed Cycles                  cycle   69,032,351
    Memory Throughput                   %         0.29
    DRAM Throughput                     %         0.29
    Duration                      msecond        63.26
    L1/TEX Cache Throughput             %         5.01
    L2 Cache Throughput                 %         0.34
    SM Active Cycles                cycle 2,559,762.74
    Compute (SM) Throughput             %         0.33
    ----------------------- ------------- ------------

    OPT   This kernel grid is too small to fill the available resources on this device, resulting in only 0.0 full      
          waves across all SMs. Look at Launch Statistics for more details.                                             

    Section: Launch Statistics
    -------------------------------- --------------- ---------------
    Metric Name                          Metric Unit    Metric Value
    -------------------------------- --------------- ---------------
    Block Size                                                   128
    Function Cache Configuration                     CachePreferNone
    Grid Size                                                      4
    Registers Per Thread             register/thread              23
    Shared Memory Configuration Size           Kbyte           32.77
    Driver Shared Memory Per Block       Kbyte/block            1.02
    Dynamic Shared Memory Per Block       byte/block               0
    Static Shared Memory Per Block        byte/block               0
    Threads                                   thread             512
    Waves Per SM                                                0.00
    -------------------------------- --------------- ---------------

    OPT   Estimated Speedup: 96.3%                                                                                      
          The grid for this launch is configured to execute only 4 blocks, which is less than the GPU's 108             
          multiprocessors. This can underutilize some multiprocessors. If you do not intend to execute this kernel      
          concurrently with other workloads, consider reducing the block size to have at least one block per            
          multiprocessor or increase the size of the grid to fully utilize the available hardware resources. See the    
          Hardware Model (https://docs.nvidia.com/nsight-compute/ProfilingGuide/index.html#metrics-hw-model)            
          description for more details on launch configurations.                                                        

    Section: Occupancy
    ------------------------------- ----------- ------------
    Metric Name                     Metric Unit Metric Value
    ------------------------------- ----------- ------------
    Block Limit SM                        block           32
    Block Limit Registers                 block           21
    Block Limit Shared Mem                block           32
    Block Limit Warps                     block           16
    Theoretical Active Warps per SM        warp           64
    Theoretical Occupancy                     %          100
    Achieved Occupancy                        %         6.25
    Achieved Active Warps Per SM           warp         4.00
    ------------------------------- ----------- ------------

    OPT   Estimated Speedup: 93.75%                                                                                     
          This kernel's theoretical occupancy is not impacted by any block limit. The difference between calculated     
          theoretical (100.0%) and measured achieved occupancy (6.2%) can be the result of warp scheduling overheads    
          or workload imbalances during the kernel execution. Load imbalances can occur between warps within a block    
          as well as across blocks of the same kernel. See the CUDA Best Practices Guide                                
          (https://docs.nvidia.com/cuda/cuda-c-best-practices-guide/index.html#occupancy) for more details on           
          optimizing occupancy.                                                                                         

    Section: Source Counters
    ------------------------- ----------- ------------
    Metric Name               Metric Unit Metric Value
    ------------------------- ----------- ------------
    Branch Instructions Ratio           %         0.06
    Branch Instructions              inst    5,730,381
    Branch Efficiency                   %        99.78
    Avg. Divergent Branches                      17.81
    ------------------------- ----------- ------------

    OPT   Estimated Speedup: 0%                                                                                         
          This kernel has uncoalesced global accesses resulting in a total of 6851808 excessive sectors (13% of the     
          total 52583746 sectors). Check the L2 Theoretical Sectors Global Excessive table for the primary source       
          locations. The CUDA Programming Guide                                                                         
          (https://docs.nvidia.com/cuda/cuda-c-programming-guide/index.html#device-memory-accesses) had additional      
          information on reducing uncoalesced device memory accesses.                                                   

ncu --set default --section SourceCounters --section Occupancy --section LaunchStats --section SpeedOfLight --metrics smsp__cycles_active.avg.pct_of_peak_sustained_elapsed,dram__throughput.avg.pct_of_peak_sustained_elapsed,gpu__time_duration.avg ./sobel_gpu -T 128 -B 16
==PROF== Connected to process 2154472 (/pscratch/sd/u/usatie/csc746-cp5-gpu-stencil/build/sobel_gpu)
 Read data from the file ../data/zebra-gray-int8-4x 
Command line number of `threads per block`: 128
Command line number of `thread blocks`: 16
==PROF== Profiling "sobel_kernel_gpu" - 0: 0%....50%....100% - 13 passes
 GPU configuration: 16 blocks, 128 threads per block 
 Elapsed time is : 3.477560 (sec) 
 Wrote the output file ../data/processed-raw-int8-4x-gpu.dat 
==PROF== Disconnected from process 2154472
[2154472] sobel_gpu@127.0.0.1
  sobel_kernel_gpu(const float *, float *, int, int, int) (16, 1, 1)x(128, 1, 1), Context 1, Stream 7, Device 0, CC 8.0
    Section: Command line profiler metrics
    ----------------------------------------------------- ----------- ------------
    Metric Name                                           Metric Unit Metric Value
    ----------------------------------------------------- ----------- ------------
    dram__throughput.avg.pct_of_peak_sustained_elapsed              %         1.12
    gpu__time_duration.avg                                    msecond        16.09
    smsp__cycles_active.avg.pct_of_peak_sustained_elapsed           %        14.85
    ----------------------------------------------------- ----------- ------------

    Section: GPU Speed Of Light Throughput
    ----------------------- ------------- ------------
    Metric Name               Metric Unit Metric Value
    ----------------------- ------------- ------------
    DRAM Frequency          cycle/nsecond         1.21
    SM Frequency            cycle/nsecond         1.09
    Elapsed Cycles                  cycle   17,618,470
    Memory Throughput                   %         1.12
    DRAM Throughput                     %         1.12
    Duration                      msecond        16.09
    L1/TEX Cache Throughput             %         5.05
    L2 Cache Throughput                 %         1.44
    SM Active Cycles                cycle 2,608,099.13
    Compute (SM) Throughput             %         1.31
    ----------------------- ------------- ------------

    OPT   This kernel grid is too small to fill the available resources on this device, resulting in only 0.0 full      
          waves across all SMs. Look at Launch Statistics for more details.                                             

    Section: Launch Statistics
    -------------------------------- --------------- ---------------
    Metric Name                          Metric Unit    Metric Value
    -------------------------------- --------------- ---------------
    Block Size                                                   128
    Function Cache Configuration                     CachePreferNone
    Grid Size                                                     16
    Registers Per Thread             register/thread              23
    Shared Memory Configuration Size           Kbyte           32.77
    Driver Shared Memory Per Block       Kbyte/block            1.02
    Dynamic Shared Memory Per Block       byte/block               0
    Static Shared Memory Per Block        byte/block               0
    Threads                                   thread           2,048
    Waves Per SM                                                0.01
    -------------------------------- --------------- ---------------

    OPT   Estimated Speedup: 85.19%                                                                                     
          The grid for this launch is configured to execute only 16 blocks, which is less than the GPU's 108            
          multiprocessors. This can underutilize some multiprocessors. If you do not intend to execute this kernel      
          concurrently with other workloads, consider reducing the block size to have at least one block per            
          multiprocessor or increase the size of the grid to fully utilize the available hardware resources. See the    
          Hardware Model (https://docs.nvidia.com/nsight-compute/ProfilingGuide/index.html#metrics-hw-model)            
          description for more details on launch configurations.                                                        

    Section: Occupancy
    ------------------------------- ----------- ------------
    Metric Name                     Metric Unit Metric Value
    ------------------------------- ----------- ------------
    Block Limit SM                        block           32
    Block Limit Registers                 block           21
    Block Limit Shared Mem                block           32
    Block Limit Warps                     block           16
    Theoretical Active Warps per SM        warp           64
    Theoretical Occupancy                     %          100
    Achieved Occupancy                        %         6.25
    Achieved Active Warps Per SM           warp         4.00
    ------------------------------- ----------- ------------

    OPT   Estimated Speedup: 93.75%                                                                                     
          This kernel's theoretical occupancy is not impacted by any block limit. The difference between calculated     
          theoretical (100.0%) and measured achieved occupancy (6.2%) can be the result of warp scheduling overheads    
          or workload imbalances during the kernel execution. Load imbalances can occur between warps within a block    
          as well as across blocks of the same kernel. See the CUDA Best Practices Guide                                
          (https://docs.nvidia.com/cuda/cuda-c-best-practices-guide/index.html#occupancy) for more details on           
          optimizing occupancy.                                                                                         

    Section: Source Counters
    ------------------------- ----------- ------------
    Metric Name               Metric Unit Metric Value
    ------------------------- ----------- ------------
    Branch Instructions Ratio           %         0.06
    Branch Instructions              inst    5,730,477
    Branch Efficiency                   %        99.78
    Avg. Divergent Branches                      17.81
    ------------------------- ----------- ------------

    OPT   Estimated Speedup: 0%                                                                                         
          This kernel has uncoalesced global accesses resulting in a total of 6851808 excessive sectors (13% of the     
          total 52583746 sectors). Check the L2 Theoretical Sectors Global Excessive table for the primary source       
          locations. The CUDA Programming Guide                                                                         
          (https://docs.nvidia.com/cuda/cuda-c-programming-guide/index.html#device-memory-accesses) had additional      
          information on reducing uncoalesced device memory accesses.                                                   

ncu --set default --section SourceCounters --section Occupancy --section LaunchStats --section SpeedOfLight --metrics smsp__cycles_active.avg.pct_of_peak_sustained_elapsed,dram__throughput.avg.pct_of_peak_sustained_elapsed,gpu__time_duration.avg ./sobel_gpu -T 128 -B 64
==PROF== Connected to process 2154535 (/pscratch/sd/u/usatie/csc746-cp5-gpu-stencil/build/sobel_gpu)
 Read data from the file ../data/zebra-gray-int8-4x 
Command line number of `threads per block`: 128
Command line number of `thread blocks`: 64
==PROF== Profiling "sobel_kernel_gpu" - 0: 0%....50%....100% - 13 passes
 GPU configuration: 64 blocks, 128 threads per block 
 Elapsed time is : 2.204072 (sec) 
 Wrote the output file ../data/processed-raw-int8-4x-gpu.dat 
==PROF== Disconnected from process 2154535
[2154535] sobel_gpu@127.0.0.1
  sobel_kernel_gpu(const float *, float *, int, int, int) (64, 1, 1)x(128, 1, 1), Context 1, Stream 7, Device 0, CC 8.0
    Section: Command line profiler metrics
    ----------------------------------------------------- ----------- ------------
    Metric Name                                           Metric Unit Metric Value
    ----------------------------------------------------- ----------- ------------
    dram__throughput.avg.pct_of_peak_sustained_elapsed              %         4.50
    gpu__time_duration.avg                                    msecond         4.03
    smsp__cycles_active.avg.pct_of_peak_sustained_elapsed           %        59.66
    ----------------------------------------------------- ----------- ------------

    Section: GPU Speed Of Light Throughput
    ----------------------- ------------- ------------
    Metric Name               Metric Unit Metric Value
    ----------------------- ------------- ------------
    DRAM Frequency          cycle/nsecond         1.21
    SM Frequency            cycle/nsecond         1.09
    Elapsed Cycles                  cycle    4,402,121
    Memory Throughput                   %         4.50
    DRAM Throughput                     %         4.50
    Duration                      msecond         4.03
    L1/TEX Cache Throughput             %         4.50
    L2 Cache Throughput                 %         5.97
    SM Active Cycles                cycle 2,614,594.86
    Compute (SM) Throughput             %         5.23
    ----------------------- ------------- ------------

    OPT   This kernel grid is too small to fill the available resources on this device, resulting in only 0.0 full      
          waves across all SMs. Look at Launch Statistics for more details.                                             

    Section: Launch Statistics
    -------------------------------- --------------- ---------------
    Metric Name                          Metric Unit    Metric Value
    -------------------------------- --------------- ---------------
    Block Size                                                   128
    Function Cache Configuration                     CachePreferNone
    Grid Size                                                     64
    Registers Per Thread             register/thread              23
    Shared Memory Configuration Size           Kbyte           32.77
    Driver Shared Memory Per Block       Kbyte/block            1.02
    Dynamic Shared Memory Per Block       byte/block               0
    Static Shared Memory Per Block        byte/block               0
    Threads                                   thread           8,192
    Waves Per SM                                                0.04
    -------------------------------- --------------- ---------------

    OPT   Estimated Speedup: 40.74%                                                                                     
          The grid for this launch is configured to execute only 64 blocks, which is less than the GPU's 108            
          multiprocessors. This can underutilize some multiprocessors. If you do not intend to execute this kernel      
          concurrently with other workloads, consider reducing the block size to have at least one block per            
          multiprocessor or increase the size of the grid to fully utilize the available hardware resources. See the    
          Hardware Model (https://docs.nvidia.com/nsight-compute/ProfilingGuide/index.html#metrics-hw-model)            
          description for more details on launch configurations.                                                        

    Section: Occupancy
    ------------------------------- ----------- ------------
    Metric Name                     Metric Unit Metric Value
    ------------------------------- ----------- ------------
    Block Limit SM                        block           32
    Block Limit Registers                 block           21
    Block Limit Shared Mem                block           32
    Block Limit Warps                     block           16
    Theoretical Active Warps per SM        warp           64
    Theoretical Occupancy                     %          100
    Achieved Occupancy                        %         6.25
    Achieved Active Warps Per SM           warp         4.00
    ------------------------------- ----------- ------------

    OPT   Estimated Speedup: 93.75%                                                                                     
          This kernel's theoretical occupancy is not impacted by any block limit. The difference between calculated     
          theoretical (100.0%) and measured achieved occupancy (6.2%) can be the result of warp scheduling overheads    
          or workload imbalances during the kernel execution. Load imbalances can occur between warps within a block    
          as well as across blocks of the same kernel. See the CUDA Best Practices Guide                                
          (https://docs.nvidia.com/cuda/cuda-c-best-practices-guide/index.html#occupancy) for more details on           
          optimizing occupancy.                                                                                         

    Section: Source Counters
    ------------------------- ----------- ------------
    Metric Name               Metric Unit Metric Value
    ------------------------- ----------- ------------
    Branch Instructions Ratio           %         0.06
    Branch Instructions              inst    5,730,861
    Branch Efficiency                   %        99.78
    Avg. Divergent Branches                      17.81
    ------------------------- ----------- ------------

    OPT   Estimated Speedup: 0%                                                                                         
          This kernel has uncoalesced global accesses resulting in a total of 6851808 excessive sectors (13% of the     
          total 52583746 sectors). Check the L2 Theoretical Sectors Global Excessive table for the primary source       
          locations. The CUDA Programming Guide                                                                         
          (https://docs.nvidia.com/cuda/cuda-c-programming-guide/index.html#device-memory-accesses) had additional      
          information on reducing uncoalesced device memory accesses.                                                   

ncu --set default --section SourceCounters --section Occupancy --section LaunchStats --section SpeedOfLight --metrics smsp__cycles_active.avg.pct_of_peak_sustained_elapsed,dram__throughput.avg.pct_of_peak_sustained_elapsed,gpu__time_duration.avg ./sobel_gpu -T 128 -B 256
==PROF== Connected to process 2154579 (/pscratch/sd/u/usatie/csc746-cp5-gpu-stencil/build/sobel_gpu)
 Read data from the file ../data/zebra-gray-int8-4x 
Command line number of `threads per block`: 128
Command line number of `thread blocks`: 256
==PROF== Profiling "sobel_kernel_gpu" - 0: 0%....50%....100% - 13 passes
 GPU configuration: 256 blocks, 128 threads per block 
 Elapsed time is : 1.929731 (sec) 
 Wrote the output file ../data/processed-raw-int8-4x-gpu.dat 
==PROF== Disconnected from process 2154579
[2154579] sobel_gpu@127.0.0.1
  sobel_kernel_gpu(const float *, float *, int, int, int) (256, 1, 1)x(128, 1, 1), Context 1, Stream 7, Device 0, CC 8.0
    Section: Command line profiler metrics
    ----------------------------------------------------- ----------- ------------
    Metric Name                                           Metric Unit Metric Value
    ----------------------------------------------------- ----------- ------------
    dram__throughput.avg.pct_of_peak_sustained_elapsed              %        15.90
    gpu__time_duration.avg                                    msecond         1.14
    smsp__cycles_active.avg.pct_of_peak_sustained_elapsed           %        98.98
    ----------------------------------------------------- ----------- ------------

    Section: GPU Speed Of Light Throughput
    ----------------------- ------------- ------------
    Metric Name               Metric Unit Metric Value
    ----------------------- ------------- ------------
    DRAM Frequency          cycle/nsecond         1.21
    SM Frequency            cycle/nsecond         1.09
    Elapsed Cycles                  cycle    1,244,665
    Memory Throughput                   %        15.90
    DRAM Throughput                     %        15.90
    Duration                      msecond         1.14
    L1/TEX Cache Throughput             %        10.64
    L2 Cache Throughput                 %        20.53
    SM Active Cycles                cycle 1,233,328.68
    Compute (SM) Throughput             %        18.51
    ----------------------- ------------- ------------

    OPT   This kernel grid is too small to fill the available resources on this device, resulting in only 0.1 full      
          waves across all SMs. Look at Launch Statistics for more details.                                             

    Section: Launch Statistics
    -------------------------------- --------------- ---------------
    Metric Name                          Metric Unit    Metric Value
    -------------------------------- --------------- ---------------
    Block Size                                                   128
    Function Cache Configuration                     CachePreferNone
    Grid Size                                                    256
    Registers Per Thread             register/thread              23
    Shared Memory Configuration Size           Kbyte           32.77
    Driver Shared Memory Per Block       Kbyte/block            1.02
    Dynamic Shared Memory Per Block       byte/block               0
    Static Shared Memory Per Block        byte/block               0
    Threads                                   thread          32,768
    Waves Per SM                                                0.15
    -------------------------------- --------------- ---------------

    Section: Occupancy
    ------------------------------- ----------- ------------
    Metric Name                     Metric Unit Metric Value
    ------------------------------- ----------- ------------
    Block Limit SM                        block           32
    Block Limit Registers                 block           21
    Block Limit Shared Mem                block           32
    Block Limit Warps                     block           16
    Theoretical Active Warps per SM        warp           64
    Theoretical Occupancy                     %          100
    Achieved Occupancy                        %        14.77
    Achieved Active Warps Per SM           warp         9.45
    ------------------------------- ----------- ------------

    OPT   Estimated Speedup: 85.23%                                                                                     
          This kernel's theoretical occupancy is not impacted by any block limit. The difference between calculated     
          theoretical (100.0%) and measured achieved occupancy (14.8%) can be the result of warp scheduling overheads   
          or workload imbalances during the kernel execution. Load imbalances can occur between warps within a block    
          as well as across blocks of the same kernel. See the CUDA Best Practices Guide                                
          (https://docs.nvidia.com/cuda/cuda-c-best-practices-guide/index.html#occupancy) for more details on           
          optimizing occupancy.                                                                                         

    Section: Source Counters
    ------------------------- ----------- ------------
    Metric Name               Metric Unit Metric Value
    ------------------------- ----------- ------------
    Branch Instructions Ratio           %         0.06
    Branch Instructions              inst    5,732,397
    Branch Efficiency                   %        99.78
    Avg. Divergent Branches                      17.81
    ------------------------- ----------- ------------

    OPT   Estimated Speedup: 0%                                                                                         
          This kernel has uncoalesced global accesses resulting in a total of 6851808 excessive sectors (13% of the     
          total 52583746 sectors). Check the L2 Theoretical Sectors Global Excessive table for the primary source       
          locations. The CUDA Programming Guide                                                                         
          (https://docs.nvidia.com/cuda/cuda-c-programming-guide/index.html#device-memory-accesses) had additional      
          information on reducing uncoalesced device memory accesses.                                                   

ncu --set default --section SourceCounters --section Occupancy --section LaunchStats --section SpeedOfLight --metrics smsp__cycles_active.avg.pct_of_peak_sustained_elapsed,dram__throughput.avg.pct_of_peak_sustained_elapsed,gpu__time_duration.avg ./sobel_gpu -T 128 -B 1024
==PROF== Connected to process 2154624 (/pscratch/sd/u/usatie/csc746-cp5-gpu-stencil/build/sobel_gpu)
 Read data from the file ../data/zebra-gray-int8-4x 
Command line number of `threads per block`: 128
Command line number of `thread blocks`: 1024
==PROF== Profiling "sobel_kernel_gpu" - 0: 0%....50%....100% - 13 passes
 GPU configuration: 1024 blocks, 128 threads per block 
 Elapsed time is : 1.903707 (sec) 
 Wrote the output file ../data/processed-raw-int8-4x-gpu.dat 
==PROF== Disconnected from process 2154624
[2154624] sobel_gpu@127.0.0.1
  sobel_kernel_gpu(const float *, float *, int, int, int) (1024, 1, 1)x(128, 1, 1), Context 1, Stream 7, Device 0, CC 8.0
    Section: Command line profiler metrics
    ----------------------------------------------------- ----------- ------------
    Metric Name                                           Metric Unit Metric Value
    ----------------------------------------------------- ----------- ------------
    dram__throughput.avg.pct_of_peak_sustained_elapsed              %        45.19
    gpu__time_duration.avg                                    usecond       418.72
    smsp__cycles_active.avg.pct_of_peak_sustained_elapsed           %        96.11
    ----------------------------------------------------- ----------- ------------

    Section: GPU Speed Of Light Throughput
    ----------------------- ------------- ------------
    Metric Name               Metric Unit Metric Value
    ----------------------- ------------- ------------
    DRAM Frequency          cycle/nsecond         1.21
    SM Frequency            cycle/nsecond         1.09
    Elapsed Cycles                  cycle      456,596
    Memory Throughput                   %        45.19
    DRAM Throughput                     %        45.19
    Duration                      usecond       418.72
    L1/TEX Cache Throughput             %        30.95
    L2 Cache Throughput                 %        52.68
    SM Active Cycles                cycle   440,290.57
    Compute (SM) Throughput             %        50.52
    ----------------------- ------------- ------------

    OPT   This kernel grid is too small to fill the available resources on this device, resulting in only 0.6 full      
          waves across all SMs. Look at Launch Statistics for more details.                                             

    Section: Launch Statistics
    -------------------------------- --------------- ---------------
    Metric Name                          Metric Unit    Metric Value
    -------------------------------- --------------- ---------------
    Block Size                                                   128
    Function Cache Configuration                     CachePreferNone
    Grid Size                                                  1,024
    Registers Per Thread             register/thread              23
    Shared Memory Configuration Size           Kbyte           32.77
    Driver Shared Memory Per Block       Kbyte/block            1.02
    Dynamic Shared Memory Per Block       byte/block               0
    Static Shared Memory Per Block        byte/block               0
    Threads                                   thread         131,072
    Waves Per SM                                                0.59
    -------------------------------- --------------- ---------------

    Section: Occupancy
    ------------------------------- ----------- ------------
    Metric Name                     Metric Unit Metric Value
    ------------------------------- ----------- ------------
    Block Limit SM                        block           32
    Block Limit Registers                 block           21
    Block Limit Shared Mem                block           32
    Block Limit Warps                     block           16
    Theoretical Active Warps per SM        warp           64
    Theoretical Occupancy                     %          100
    Achieved Occupancy                        %        53.78
    Achieved Active Warps Per SM           warp        34.42
    ------------------------------- ----------- ------------

    OPT   Estimated Speedup: 46.22%                                                                                     
          This kernel's theoretical occupancy is not impacted by any block limit. The difference between calculated     
          theoretical (100.0%) and measured achieved occupancy (53.8%) can be the result of warp scheduling overheads   
          or workload imbalances during the kernel execution. Load imbalances can occur between warps within a block    
          as well as across blocks of the same kernel. See the CUDA Best Practices Guide                                
          (https://docs.nvidia.com/cuda/cuda-c-best-practices-guide/index.html#occupancy) for more details on           
          optimizing occupancy.                                                                                         

    Section: Source Counters
    ------------------------- ----------- ------------
    Metric Name               Metric Unit Metric Value
    ------------------------- ----------- ------------
    Branch Instructions Ratio           %         0.06
    Branch Instructions              inst    5,738,541
    Branch Efficiency                   %        99.78
    Avg. Divergent Branches                      17.81
    ------------------------- ----------- ------------

    OPT   Estimated Speedup: 0%                                                                                         
          This kernel has uncoalesced global accesses resulting in a total of 6851808 excessive sectors (13% of the     
          total 52583746 sectors). Check the L2 Theoretical Sectors Global Excessive table for the primary source       
          locations. The CUDA Programming Guide                                                                         
          (https://docs.nvidia.com/cuda/cuda-c-programming-guide/index.html#device-memory-accesses) had additional      
          information on reducing uncoalesced device memory accesses.                                                   

ncu --set default --section SourceCounters --section Occupancy --section LaunchStats --section SpeedOfLight --metrics smsp__cycles_active.avg.pct_of_peak_sustained_elapsed,dram__throughput.avg.pct_of_peak_sustained_elapsed,gpu__time_duration.avg ./sobel_gpu -T 128 -B 4096
==PROF== Connected to process 2154692 (/pscratch/sd/u/usatie/csc746-cp5-gpu-stencil/build/sobel_gpu)
 Read data from the file ../data/zebra-gray-int8-4x 
Command line number of `threads per block`: 128
Command line number of `thread blocks`: 4096
==PROF== Profiling "sobel_kernel_gpu" - 0: 0%....50%....100% - 13 passes
 GPU configuration: 4096 blocks, 128 threads per block 
 Elapsed time is : 1.967082 (sec) 
 Wrote the output file ../data/processed-raw-int8-4x-gpu.dat 
==PROF== Disconnected from process 2154692
[2154692] sobel_gpu@127.0.0.1
  sobel_kernel_gpu(const float *, float *, int, int, int) (4096, 1, 1)x(128, 1, 1), Context 1, Stream 7, Device 0, CC 8.0
    Section: Command line profiler metrics
    ----------------------------------------------------- ----------- ------------
    Metric Name                                           Metric Unit Metric Value
    ----------------------------------------------------- ----------- ------------
    dram__throughput.avg.pct_of_peak_sustained_elapsed              %        52.03
    gpu__time_duration.avg                                    usecond       360.61
    smsp__cycles_active.avg.pct_of_peak_sustained_elapsed           %        97.51
    ----------------------------------------------------- ----------- ------------

    Section: GPU Speed Of Light Throughput
    ----------------------- ------------- ------------
    Metric Name               Metric Unit Metric Value
    ----------------------- ------------- ------------
    DRAM Frequency          cycle/nsecond         1.21
    SM Frequency            cycle/nsecond         1.09
    Elapsed Cycles                  cycle      394,199
    Memory Throughput                   %        52.03
    DRAM Throughput                     %        52.03
    Duration                      usecond       360.61
    L1/TEX Cache Throughput             %        37.28
    L2 Cache Throughput                 %        61.53
    SM Active Cycles                cycle   384,708.07
    Compute (SM) Throughput             %        58.66
    ----------------------- ------------- ------------

    OPT   This kernel exhibits low compute throughput and memory bandwidth utilization relative to the peak performance 
          of this device. Achieved compute throughput and/or memory bandwidth below 60.0% of peak typically indicate    
          latency issues. Look at Scheduler Statistics and Warp State Statistics for potential reasons.                 

    Section: Launch Statistics
    -------------------------------- --------------- ---------------
    Metric Name                          Metric Unit    Metric Value
    -------------------------------- --------------- ---------------
    Block Size                                                   128
    Function Cache Configuration                     CachePreferNone
    Grid Size                                                  4,096
    Registers Per Thread             register/thread              23
    Shared Memory Configuration Size           Kbyte           32.77
    Driver Shared Memory Per Block       Kbyte/block            1.02
    Dynamic Shared Memory Per Block       byte/block               0
    Static Shared Memory Per Block        byte/block               0
    Threads                                   thread         524,288
    Waves Per SM                                                2.37
    -------------------------------- --------------- ---------------

    Section: Occupancy
    ------------------------------- ----------- ------------
    Metric Name                     Metric Unit Metric Value
    ------------------------------- ----------- ------------
    Block Limit SM                        block           32
    Block Limit Registers                 block           21
    Block Limit Shared Mem                block           32
    Block Limit Warps                     block           16
    Theoretical Active Warps per SM        warp           64
    Theoretical Occupancy                     %          100
    Achieved Occupancy                        %        85.86
    Achieved Active Warps Per SM           warp        54.95
    ------------------------------- ----------- ------------

    OPT   Estimated Speedup: 14.14%                                                                                     
          This kernel's theoretical occupancy is not impacted by any block limit. The difference between calculated     
          theoretical (100.0%) and measured achieved occupancy (85.9%) can be the result of warp scheduling overheads   
          or workload imbalances during the kernel execution. Load imbalances can occur between warps within a block    
          as well as across blocks of the same kernel. See the CUDA Best Practices Guide                                
          (https://docs.nvidia.com/cuda/cuda-c-best-practices-guide/index.html#occupancy) for more details on           
          optimizing occupancy.                                                                                         

    Section: Source Counters
    ------------------------- ----------- ------------
    Metric Name               Metric Unit Metric Value
    ------------------------- ----------- ------------
    Branch Instructions Ratio           %         0.06
    Branch Instructions              inst    5,763,117
    Branch Efficiency                   %        99.78
    Avg. Divergent Branches                      17.81
    ------------------------- ----------- ------------

    OPT   Estimated Speedup: 0%                                                                                         
          This kernel has uncoalesced global accesses resulting in a total of 6851808 excessive sectors (13% of the     
          total 52583746 sectors). Check the L2 Theoretical Sectors Global Excessive table for the primary source       
          locations. The CUDA Programming Guide                                                                         
          (https://docs.nvidia.com/cuda/cuda-c-programming-guide/index.html#device-memory-accesses) had additional      
          information on reducing uncoalesced device memory accesses.                                                   

ncu --set default --section SourceCounters --section Occupancy --section LaunchStats --section SpeedOfLight --metrics smsp__cycles_active.avg.pct_of_peak_sustained_elapsed,dram__throughput.avg.pct_of_peak_sustained_elapsed,gpu__time_duration.avg ./sobel_gpu -T 256 -B 1
==PROF== Connected to process 2154737 (/pscratch/sd/u/usatie/csc746-cp5-gpu-stencil/build/sobel_gpu)
 Read data from the file ../data/zebra-gray-int8-4x 
Command line number of `threads per block`: 256
Command line number of `thread blocks`: 1
==PROF== Profiling "sobel_kernel_gpu" - 0: 0%.
==WARNING== Launching the workload is taking more time than expected. If this continues to hang, terminate the profile and re-try by profiling the range of all related launches using '--replay-mode range'. See https://docs.nvidia.com/nsight-compute/ProfilingGuide/index.html#replay for more details.
...50%....100% - 13 passes
 GPU configuration: 1 blocks, 256 threads per block 
 Elapsed time is : 15.724970 (sec) 
 Wrote the output file ../data/processed-raw-int8-4x-gpu.dat 
==PROF== Disconnected from process 2154737
[2154737] sobel_gpu@127.0.0.1
  sobel_kernel_gpu(const float *, float *, int, int, int) (1, 1, 1)x(256, 1, 1), Context 1, Stream 7, Device 0, CC 8.0
    Section: Command line profiler metrics
    ----------------------------------------------------- ----------- ------------
    Metric Name                                           Metric Unit Metric Value
    ----------------------------------------------------- ----------- ------------
    dram__throughput.avg.pct_of_peak_sustained_elapsed              %         0.13
    gpu__time_duration.avg                                    msecond       134.95
    smsp__cycles_active.avg.pct_of_peak_sustained_elapsed           %         0.92
    ----------------------------------------------------- ----------- ------------

    Section: GPU Speed Of Light Throughput
    ----------------------- ------------- ------------
    Metric Name               Metric Unit Metric Value
    ----------------------- ------------- ------------
    DRAM Frequency          cycle/nsecond         1.22
    SM Frequency            cycle/nsecond         1.10
    Elapsed Cycles                  cycle  148,797,386
    Memory Throughput                   %         0.13
    DRAM Throughput                     %         0.13
    Duration                      msecond       134.95
    L1/TEX Cache Throughput             %         9.43
    L2 Cache Throughput                 %         0.12
    SM Active Cycles                cycle 1,368,727.24
    Compute (SM) Throughput             %         0.15
    ----------------------- ------------- ------------

    OPT   This kernel grid is too small to fill the available resources on this device, resulting in only 0.0 full      
          waves across all SMs. Look at Launch Statistics for more details.                                             

    Section: Launch Statistics
    -------------------------------- --------------- ---------------
    Metric Name                          Metric Unit    Metric Value
    -------------------------------- --------------- ---------------
    Block Size                                                   256
    Function Cache Configuration                     CachePreferNone
    Grid Size                                                      1
    Registers Per Thread             register/thread              23
    Shared Memory Configuration Size           Kbyte           32.77
    Driver Shared Memory Per Block       Kbyte/block            1.02
    Dynamic Shared Memory Per Block       byte/block               0
    Static Shared Memory Per Block        byte/block               0
    Threads                                   thread             256
    Waves Per SM                                                0.00
    -------------------------------- --------------- ---------------

    OPT   Estimated Speedup: 99.07%                                                                                     
          The grid for this launch is configured to execute only 1 blocks, which is less than the GPU's 108             
          multiprocessors. This can underutilize some multiprocessors. If you do not intend to execute this kernel      
          concurrently with other workloads, consider reducing the block size to have at least one block per            
          multiprocessor or increase the size of the grid to fully utilize the available hardware resources. See the    
          Hardware Model (https://docs.nvidia.com/nsight-compute/ProfilingGuide/index.html#metrics-hw-model)            
          description for more details on launch configurations.                                                        

    Section: Occupancy
    ------------------------------- ----------- ------------
    Metric Name                     Metric Unit Metric Value
    ------------------------------- ----------- ------------
    Block Limit SM                        block           32
    Block Limit Registers                 block           10
    Block Limit Shared Mem                block           32
    Block Limit Warps                     block            8
    Theoretical Active Warps per SM        warp           64
    Theoretical Occupancy                     %          100
    Achieved Occupancy                        %        12.50
    Achieved Active Warps Per SM           warp         8.00
    ------------------------------- ----------- ------------

    OPT   Estimated Speedup: 87.5%                                                                                      
          This kernel's theoretical occupancy is not impacted by any block limit. The difference between calculated     
          theoretical (100.0%) and measured achieved occupancy (12.5%) can be the result of warp scheduling overheads   
          or workload imbalances during the kernel execution. Load imbalances can occur between warps within a block    
          as well as across blocks of the same kernel. See the CUDA Best Practices Guide                                
          (https://docs.nvidia.com/cuda/cuda-c-best-practices-guide/index.html#occupancy) for more details on           
          optimizing occupancy.                                                                                         

    Section: Source Counters
    ------------------------- ----------- ------------
    Metric Name               Metric Unit Metric Value
    ------------------------- ----------- ------------
    Branch Instructions Ratio           %         0.06
    Branch Instructions              inst    5,730,365
    Branch Efficiency                   %        99.78
    Avg. Divergent Branches                      17.81
    ------------------------- ----------- ------------

    OPT   Estimated Speedup: 0%                                                                                         
          This kernel has uncoalesced global accesses resulting in a total of 6851808 excessive sectors (13% of the     
          total 52583746 sectors). Check the L2 Theoretical Sectors Global Excessive table for the primary source       
          locations. The CUDA Programming Guide                                                                         
          (https://docs.nvidia.com/cuda/cuda-c-programming-guide/index.html#device-memory-accesses) had additional      
          information on reducing uncoalesced device memory accesses.                                                   

ncu --set default --section SourceCounters --section Occupancy --section LaunchStats --section SpeedOfLight --metrics smsp__cycles_active.avg.pct_of_peak_sustained_elapsed,dram__throughput.avg.pct_of_peak_sustained_elapsed,gpu__time_duration.avg ./sobel_gpu -T 256 -B 4
==PROF== Connected to process 2154805 (/pscratch/sd/u/usatie/csc746-cp5-gpu-stencil/build/sobel_gpu)
 Read data from the file ../data/zebra-gray-int8-4x 
Command line number of `threads per block`: 256
Command line number of `thread blocks`: 4
==PROF== Profiling "sobel_kernel_gpu" - 0: 0%.
==WARNING== Launching the workload is taking more time than expected. If this continues to hang, terminate the profile and re-try by profiling the range of all related launches using '--replay-mode range'. See https://docs.nvidia.com/nsight-compute/ProfilingGuide/index.html#replay for more details.
...50%....100% - 13 passes
 GPU configuration: 4 blocks, 256 threads per block 
 Elapsed time is : 5.231549 (sec) 
 Wrote the output file ../data/processed-raw-int8-4x-gpu.dat 
==PROF== Disconnected from process 2154805
[2154805] sobel_gpu@127.0.0.1
  sobel_kernel_gpu(const float *, float *, int, int, int) (4, 1, 1)x(256, 1, 1), Context 1, Stream 7, Device 0, CC 8.0
    Section: Command line profiler metrics
    ----------------------------------------------------- ----------- ------------
    Metric Name                                           Metric Unit Metric Value
    ----------------------------------------------------- ----------- ------------
    dram__throughput.avg.pct_of_peak_sustained_elapsed              %         0.54
    gpu__time_duration.avg                                    msecond        33.24
    smsp__cycles_active.avg.pct_of_peak_sustained_elapsed           %         3.73
    ----------------------------------------------------- ----------- ------------

    Section: GPU Speed Of Light Throughput
    ----------------------- ------------- ------------
    Metric Name               Metric Unit Metric Value
    ----------------------- ------------- ------------
    DRAM Frequency          cycle/nsecond         1.21
    SM Frequency            cycle/nsecond         1.09
    Elapsed Cycles                  cycle   36,381,451
    Memory Throughput                   %         0.54
    DRAM Throughput                     %         0.54
    Duration                      msecond        33.24
    L1/TEX Cache Throughput             %        10.13
    L2 Cache Throughput                 %         0.58
    SM Active Cycles                cycle 1,353,799.55
    Compute (SM) Throughput             %         0.63
    ----------------------- ------------- ------------

    OPT   This kernel grid is too small to fill the available resources on this device, resulting in only 0.0 full      
          waves across all SMs. Look at Launch Statistics for more details.                                             

    Section: Launch Statistics
    -------------------------------- --------------- ---------------
    Metric Name                          Metric Unit    Metric Value
    -------------------------------- --------------- ---------------
    Block Size                                                   256
    Function Cache Configuration                     CachePreferNone
    Grid Size                                                      4
    Registers Per Thread             register/thread              23
    Shared Memory Configuration Size           Kbyte           32.77
    Driver Shared Memory Per Block       Kbyte/block            1.02
    Dynamic Shared Memory Per Block       byte/block               0
    Static Shared Memory Per Block        byte/block               0
    Threads                                   thread           1,024
    Waves Per SM                                                0.00
    -------------------------------- --------------- ---------------

    OPT   Estimated Speedup: 96.3%                                                                                      
          The grid for this launch is configured to execute only 4 blocks, which is less than the GPU's 108             
          multiprocessors. This can underutilize some multiprocessors. If you do not intend to execute this kernel      
          concurrently with other workloads, consider reducing the block size to have at least one block per            
          multiprocessor or increase the size of the grid to fully utilize the available hardware resources. See the    
          Hardware Model (https://docs.nvidia.com/nsight-compute/ProfilingGuide/index.html#metrics-hw-model)            
          description for more details on launch configurations.                                                        

    Section: Occupancy
    ------------------------------- ----------- ------------
    Metric Name                     Metric Unit Metric Value
    ------------------------------- ----------- ------------
    Block Limit SM                        block           32
    Block Limit Registers                 block           10
    Block Limit Shared Mem                block           32
    Block Limit Warps                     block            8
    Theoretical Active Warps per SM        warp           64
    Theoretical Occupancy                     %          100
    Achieved Occupancy                        %        12.50
    Achieved Active Warps Per SM           warp         8.00
    ------------------------------- ----------- ------------

    OPT   Estimated Speedup: 87.5%                                                                                      
          This kernel's theoretical occupancy is not impacted by any block limit. The difference between calculated     
          theoretical (100.0%) and measured achieved occupancy (12.5%) can be the result of warp scheduling overheads   
          or workload imbalances during the kernel execution. Load imbalances can occur between warps within a block    
          as well as across blocks of the same kernel. See the CUDA Best Practices Guide                                
          (https://docs.nvidia.com/cuda/cuda-c-best-practices-guide/index.html#occupancy) for more details on           
          optimizing occupancy.                                                                                         

    Section: Source Counters
    ------------------------- ----------- ------------
    Metric Name               Metric Unit Metric Value
    ------------------------- ----------- ------------
    Branch Instructions Ratio           %         0.06
    Branch Instructions              inst    5,730,413
    Branch Efficiency                   %        99.78
    Avg. Divergent Branches                      17.81
    ------------------------- ----------- ------------

    OPT   Estimated Speedup: 0%                                                                                         
          This kernel has uncoalesced global accesses resulting in a total of 6851808 excessive sectors (13% of the     
          total 52583746 sectors). Check the L2 Theoretical Sectors Global Excessive table for the primary source       
          locations. The CUDA Programming Guide                                                                         
          (https://docs.nvidia.com/cuda/cuda-c-programming-guide/index.html#device-memory-accesses) had additional      
          information on reducing uncoalesced device memory accesses.                                                   

ncu --set default --section SourceCounters --section Occupancy --section LaunchStats --section SpeedOfLight --metrics smsp__cycles_active.avg.pct_of_peak_sustained_elapsed,dram__throughput.avg.pct_of_peak_sustained_elapsed,gpu__time_duration.avg ./sobel_gpu -T 256 -B 16
==PROF== Connected to process 2154849 (/pscratch/sd/u/usatie/csc746-cp5-gpu-stencil/build/sobel_gpu)
 Read data from the file ../data/zebra-gray-int8-4x 
Command line number of `threads per block`: 256
Command line number of `thread blocks`: 16
==PROF== Profiling "sobel_kernel_gpu" - 0: 0%....50%....100% - 13 passes
 GPU configuration: 16 blocks, 256 threads per block 
 Elapsed time is : 2.664783 (sec) 
 Wrote the output file ../data/processed-raw-int8-4x-gpu.dat 
==PROF== Disconnected from process 2154849
[2154849] sobel_gpu@127.0.0.1
  sobel_kernel_gpu(const float *, float *, int, int, int) (16, 1, 1)x(256, 1, 1), Context 1, Stream 7, Device 0, CC 8.0
    Section: Command line profiler metrics
    ----------------------------------------------------- ----------- ------------
    Metric Name                                           Metric Unit Metric Value
    ----------------------------------------------------- ----------- ------------
    dram__throughput.avg.pct_of_peak_sustained_elapsed              %         2.13
    gpu__time_duration.avg                                    msecond         8.50
    smsp__cycles_active.avg.pct_of_peak_sustained_elapsed           %        14.81
    ----------------------------------------------------- ----------- ------------

    Section: GPU Speed Of Light Throughput
    ----------------------- ------------- ------------
    Metric Name               Metric Unit Metric Value
    ----------------------- ------------- ------------
    DRAM Frequency          cycle/nsecond         1.21
    SM Frequency            cycle/nsecond         1.09
    Elapsed Cycles                  cycle    9,296,531
    Memory Throughput                   %         2.13
    DRAM Throughput                     %         2.13
    Duration                      msecond         8.50
    L1/TEX Cache Throughput             %        10.37
    L2 Cache Throughput                 %         2.80
    SM Active Cycles                cycle 1,375,820.94
    Compute (SM) Throughput             %         2.48
    ----------------------- ------------- ------------

    OPT   This kernel grid is too small to fill the available resources on this device, resulting in only 0.0 full      
          waves across all SMs. Look at Launch Statistics for more details.                                             

    Section: Launch Statistics
    -------------------------------- --------------- ---------------
    Metric Name                          Metric Unit    Metric Value
    -------------------------------- --------------- ---------------
    Block Size                                                   256
    Function Cache Configuration                     CachePreferNone
    Grid Size                                                     16
    Registers Per Thread             register/thread              23
    Shared Memory Configuration Size           Kbyte           32.77
    Driver Shared Memory Per Block       Kbyte/block            1.02
    Dynamic Shared Memory Per Block       byte/block               0
    Static Shared Memory Per Block        byte/block               0
    Threads                                   thread           4,096
    Waves Per SM                                                0.02
    -------------------------------- --------------- ---------------

    OPT   Estimated Speedup: 85.19%                                                                                     
          The grid for this launch is configured to execute only 16 blocks, which is less than the GPU's 108            
          multiprocessors. This can underutilize some multiprocessors. If you do not intend to execute this kernel      
          concurrently with other workloads, consider reducing the block size to have at least one block per            
          multiprocessor or increase the size of the grid to fully utilize the available hardware resources. See the    
          Hardware Model (https://docs.nvidia.com/nsight-compute/ProfilingGuide/index.html#metrics-hw-model)            
          description for more details on launch configurations.                                                        

    Section: Occupancy
    ------------------------------- ----------- ------------
    Metric Name                     Metric Unit Metric Value
    ------------------------------- ----------- ------------
    Block Limit SM                        block           32
    Block Limit Registers                 block           10
    Block Limit Shared Mem                block           32
    Block Limit Warps                     block            8
    Theoretical Active Warps per SM        warp           64
    Theoretical Occupancy                     %          100
    Achieved Occupancy                        %        12.49
    Achieved Active Warps Per SM           warp         7.99
    ------------------------------- ----------- ------------

    OPT   Estimated Speedup: 87.51%                                                                                     
          This kernel's theoretical occupancy is not impacted by any block limit. The difference between calculated     
          theoretical (100.0%) and measured achieved occupancy (12.5%) can be the result of warp scheduling overheads   
          or workload imbalances during the kernel execution. Load imbalances can occur between warps within a block    
          as well as across blocks of the same kernel. See the CUDA Best Practices Guide                                
          (https://docs.nvidia.com/cuda/cuda-c-best-practices-guide/index.html#occupancy) for more details on           
          optimizing occupancy.                                                                                         

    Section: Source Counters
    ------------------------- ----------- ------------
    Metric Name               Metric Unit Metric Value
    ------------------------- ----------- ------------
    Branch Instructions Ratio           %         0.06
    Branch Instructions              inst    5,730,605
    Branch Efficiency                   %        99.78
    Avg. Divergent Branches                      17.81
    ------------------------- ----------- ------------

    OPT   Estimated Speedup: 0%                                                                                         
          This kernel has uncoalesced global accesses resulting in a total of 6851808 excessive sectors (13% of the     
          total 52583746 sectors). Check the L2 Theoretical Sectors Global Excessive table for the primary source       
          locations. The CUDA Programming Guide                                                                         
          (https://docs.nvidia.com/cuda/cuda-c-programming-guide/index.html#device-memory-accesses) had additional      
          information on reducing uncoalesced device memory accesses.                                                   

ncu --set default --section SourceCounters --section Occupancy --section LaunchStats --section SpeedOfLight --metrics smsp__cycles_active.avg.pct_of_peak_sustained_elapsed,dram__throughput.avg.pct_of_peak_sustained_elapsed,gpu__time_duration.avg ./sobel_gpu -T 256 -B 64
==PROF== Connected to process 2154915 (/pscratch/sd/u/usatie/csc746-cp5-gpu-stencil/build/sobel_gpu)
 Read data from the file ../data/zebra-gray-int8-4x 
Command line number of `threads per block`: 256
Command line number of `thread blocks`: 64
==PROF== Profiling "sobel_kernel_gpu" - 0: 0%....50%....100% - 13 passes
 GPU configuration: 64 blocks, 256 threads per block 
 Elapsed time is : 1.946081 (sec) 
 Wrote the output file ../data/processed-raw-int8-4x-gpu.dat 
==PROF== Disconnected from process 2154915
[2154915] sobel_gpu@127.0.0.1
  sobel_kernel_gpu(const float *, float *, int, int, int) (64, 1, 1)x(256, 1, 1), Context 1, Stream 7, Device 0, CC 8.0
    Section: Command line profiler metrics
    ----------------------------------------------------- ----------- ------------
    Metric Name                                           Metric Unit Metric Value
    ----------------------------------------------------- ----------- ------------
    dram__throughput.avg.pct_of_peak_sustained_elapsed              %         8.23
    gpu__time_duration.avg                                    msecond         2.20
    smsp__cycles_active.avg.pct_of_peak_sustained_elapsed           %        59.00
    ----------------------------------------------------- ----------- ------------

    Section: GPU Speed Of Light Throughput
    ----------------------- ------------- ------------
    Metric Name               Metric Unit Metric Value
    ----------------------- ------------- ------------
    DRAM Frequency          cycle/nsecond         1.21
    SM Frequency            cycle/nsecond         1.09
    Elapsed Cycles                  cycle    2,400,645
    Memory Throughput                   %         8.23
    DRAM Throughput                     %         8.23
    Duration                      msecond         2.20
    L1/TEX Cache Throughput             %         9.89
    L2 Cache Throughput                 %        10.38
    SM Active Cycles                cycle 1,417,283.26
    Compute (SM) Throughput             %         9.60
    ----------------------- ------------- ------------

    OPT   This kernel grid is too small to fill the available resources on this device, resulting in only 0.1 full      
          waves across all SMs. Look at Launch Statistics for more details.                                             

    Section: Launch Statistics
    -------------------------------- --------------- ---------------
    Metric Name                          Metric Unit    Metric Value
    -------------------------------- --------------- ---------------
    Block Size                                                   256
    Function Cache Configuration                     CachePreferNone
    Grid Size                                                     64
    Registers Per Thread             register/thread              23
    Shared Memory Configuration Size           Kbyte           32.77
    Driver Shared Memory Per Block       Kbyte/block            1.02
    Dynamic Shared Memory Per Block       byte/block               0
    Static Shared Memory Per Block        byte/block               0
    Threads                                   thread          16,384
    Waves Per SM                                                0.07
    -------------------------------- --------------- ---------------

    OPT   Estimated Speedup: 40.74%                                                                                     
          The grid for this launch is configured to execute only 64 blocks, which is less than the GPU's 108            
          multiprocessors. This can underutilize some multiprocessors. If you do not intend to execute this kernel      
          concurrently with other workloads, consider reducing the block size to have at least one block per            
          multiprocessor or increase the size of the grid to fully utilize the available hardware resources. See the    
          Hardware Model (https://docs.nvidia.com/nsight-compute/ProfilingGuide/index.html#metrics-hw-model)            
          description for more details on launch configurations.                                                        

    Section: Occupancy
    ------------------------------- ----------- ------------
    Metric Name                     Metric Unit Metric Value
    ------------------------------- ----------- ------------
    Block Limit SM                        block           32
    Block Limit Registers                 block           10
    Block Limit Shared Mem                block           32
    Block Limit Warps                     block            8
    Theoretical Active Warps per SM        warp           64
    Theoretical Occupancy                     %          100
    Achieved Occupancy                        %        12.48
    Achieved Active Warps Per SM           warp         7.99
    ------------------------------- ----------- ------------

    OPT   Estimated Speedup: 87.52%                                                                                     
          This kernel's theoretical occupancy is not impacted by any block limit. The difference between calculated     
          theoretical (100.0%) and measured achieved occupancy (12.5%) can be the result of warp scheduling overheads   
          or workload imbalances during the kernel execution. Load imbalances can occur between warps within a block    
          as well as across blocks of the same kernel. See the CUDA Best Practices Guide                                
          (https://docs.nvidia.com/cuda/cuda-c-best-practices-guide/index.html#occupancy) for more details on           
          optimizing occupancy.                                                                                         

    Section: Source Counters
    ------------------------- ----------- ------------
    Metric Name               Metric Unit Metric Value
    ------------------------- ----------- ------------
    Branch Instructions Ratio           %         0.06
    Branch Instructions              inst    5,731,373
    Branch Efficiency                   %        99.78
    Avg. Divergent Branches                      17.81
    ------------------------- ----------- ------------

    OPT   Estimated Speedup: 0%                                                                                         
          This kernel has uncoalesced global accesses resulting in a total of 6851808 excessive sectors (13% of the     
          total 52583746 sectors). Check the L2 Theoretical Sectors Global Excessive table for the primary source       
          locations. The CUDA Programming Guide                                                                         
          (https://docs.nvidia.com/cuda/cuda-c-programming-guide/index.html#device-memory-accesses) had additional      
          information on reducing uncoalesced device memory accesses.                                                   

ncu --set default --section SourceCounters --section Occupancy --section LaunchStats --section SpeedOfLight --metrics smsp__cycles_active.avg.pct_of_peak_sustained_elapsed,dram__throughput.avg.pct_of_peak_sustained_elapsed,gpu__time_duration.avg ./sobel_gpu -T 256 -B 256
==PROF== Connected to process 2154959 (/pscratch/sd/u/usatie/csc746-cp5-gpu-stencil/build/sobel_gpu)
 Read data from the file ../data/zebra-gray-int8-4x 
Command line number of `threads per block`: 256
Command line number of `thread blocks`: 256
==PROF== Profiling "sobel_kernel_gpu" - 0: 0%....50%....100% - 13 passes
 GPU configuration: 256 blocks, 256 threads per block 
 Elapsed time is : 1.969627 (sec) 
 Wrote the output file ../data/processed-raw-int8-4x-gpu.dat 
==PROF== Disconnected from process 2154959
[2154959] sobel_gpu@127.0.0.1
  sobel_kernel_gpu(const float *, float *, int, int, int) (256, 1, 1)x(256, 1, 1), Context 1, Stream 7, Device 0, CC 8.0
    Section: Command line profiler metrics
    ----------------------------------------------------- ----------- ------------
    Metric Name                                           Metric Unit Metric Value
    ----------------------------------------------------- ----------- ------------
    dram__throughput.avg.pct_of_peak_sustained_elapsed              %        26.89
    gpu__time_duration.avg                                    usecond       674.34
    smsp__cycles_active.avg.pct_of_peak_sustained_elapsed           %        96.44
    ----------------------------------------------------- ----------- ------------

    Section: GPU Speed Of Light Throughput
    ----------------------- ------------- ------------
    Metric Name               Metric Unit Metric Value
    ----------------------- ------------- ------------
    DRAM Frequency          cycle/nsecond         1.21
    SM Frequency            cycle/nsecond         1.09
    Elapsed Cycles                  cycle      736,909
    Memory Throughput                   %        26.89
    DRAM Throughput                     %        26.89
    Duration                      usecond       674.34
    L1/TEX Cache Throughput             %        19.89
    L2 Cache Throughput                 %        32.10
    SM Active Cycles                cycle   711,546.69
    Compute (SM) Throughput             %        31.28
    ----------------------- ------------- ------------

    OPT   This kernel grid is too small to fill the available resources on this device, resulting in only 0.3 full      
          waves across all SMs. Look at Launch Statistics for more details.                                             

    Section: Launch Statistics
    -------------------------------- --------------- ---------------
    Metric Name                          Metric Unit    Metric Value
    -------------------------------- --------------- ---------------
    Block Size                                                   256
    Function Cache Configuration                     CachePreferNone
    Grid Size                                                    256
    Registers Per Thread             register/thread              23
    Shared Memory Configuration Size           Kbyte           32.77
    Driver Shared Memory Per Block       Kbyte/block            1.02
    Dynamic Shared Memory Per Block       byte/block               0
    Static Shared Memory Per Block        byte/block               0
    Threads                                   thread          65,536
    Waves Per SM                                                0.30
    -------------------------------- --------------- ---------------

    Section: Occupancy
    ------------------------------- ----------- ------------
    Metric Name                     Metric Unit Metric Value
    ------------------------------- ----------- ------------
    Block Limit SM                        block           32
    Block Limit Registers                 block           10
    Block Limit Shared Mem                block           32
    Block Limit Warps                     block            8
    Theoretical Active Warps per SM        warp           64
    Theoretical Occupancy                     %          100
    Achieved Occupancy                        %        29.06
    Achieved Active Warps Per SM           warp        18.60
    ------------------------------- ----------- ------------

    OPT   Estimated Speedup: 70.94%                                                                                     
          This kernel's theoretical occupancy is not impacted by any block limit. The difference between calculated     
          theoretical (100.0%) and measured achieved occupancy (29.1%) can be the result of warp scheduling overheads   
          or workload imbalances during the kernel execution. Load imbalances can occur between warps within a block    
          as well as across blocks of the same kernel. See the CUDA Best Practices Guide                                
          (https://docs.nvidia.com/cuda/cuda-c-best-practices-guide/index.html#occupancy) for more details on           
          optimizing occupancy.                                                                                         

    Section: Source Counters
    ------------------------- ----------- ------------
    Metric Name               Metric Unit Metric Value
    ------------------------- ----------- ------------
    Branch Instructions Ratio           %         0.06
    Branch Instructions              inst    5,734,445
    Branch Efficiency                   %        99.78
    Avg. Divergent Branches                      17.81
    ------------------------- ----------- ------------

    OPT   Estimated Speedup: 0%                                                                                         
          This kernel has uncoalesced global accesses resulting in a total of 6851808 excessive sectors (13% of the     
          total 52583746 sectors). Check the L2 Theoretical Sectors Global Excessive table for the primary source       
          locations. The CUDA Programming Guide                                                                         
          (https://docs.nvidia.com/cuda/cuda-c-programming-guide/index.html#device-memory-accesses) had additional      
          information on reducing uncoalesced device memory accesses.                                                   

ncu --set default --section SourceCounters --section Occupancy --section LaunchStats --section SpeedOfLight --metrics smsp__cycles_active.avg.pct_of_peak_sustained_elapsed,dram__throughput.avg.pct_of_peak_sustained_elapsed,gpu__time_duration.avg ./sobel_gpu -T 256 -B 1024
==PROF== Connected to process 2155003 (/pscratch/sd/u/usatie/csc746-cp5-gpu-stencil/build/sobel_gpu)
 Read data from the file ../data/zebra-gray-int8-4x 
Command line number of `threads per block`: 256
Command line number of `thread blocks`: 1024
==PROF== Profiling "sobel_kernel_gpu" - 0: 0%....50%....100% - 13 passes
 GPU configuration: 1024 blocks, 256 threads per block 
 Elapsed time is : 1.882685 (sec) 
 Wrote the output file ../data/processed-raw-int8-4x-gpu.dat 
==PROF== Disconnected from process 2155003
[2155003] sobel_gpu@127.0.0.1
  sobel_kernel_gpu(const float *, float *, int, int, int) (1024, 1, 1)x(256, 1, 1), Context 1, Stream 7, Device 0, CC 8.0
    Section: Command line profiler metrics
    ----------------------------------------------------- ----------- ------------
    Metric Name                                           Metric Unit Metric Value
    ----------------------------------------------------- ----------- ------------
    dram__throughput.avg.pct_of_peak_sustained_elapsed              %        48.80
    gpu__time_duration.avg                                    usecond       421.12
    smsp__cycles_active.avg.pct_of_peak_sustained_elapsed           %        96.04
    ----------------------------------------------------- ----------- ------------

    Section: GPU Speed Of Light Throughput
    ----------------------- ------------- ------------
    Metric Name               Metric Unit Metric Value
    ----------------------- ------------- ------------
    DRAM Frequency          cycle/nsecond         1.21
    SM Frequency            cycle/nsecond         1.08
    Elapsed Cycles                  cycle      457,164
    Memory Throughput                   %        48.80
    DRAM Throughput                     %        48.80
    Duration                      usecond       421.12
    L1/TEX Cache Throughput             %        33.27
    L2 Cache Throughput                 %        51.40
    SM Active Cycles                cycle   440,786.18
    Compute (SM) Throughput             %        50.50
    ----------------------- ------------- ------------

    OPT   This kernel exhibits low compute throughput and memory bandwidth utilization relative to the peak performance 
          of this device. Achieved compute throughput and/or memory bandwidth below 60.0% of peak typically indicate    
          latency issues. Look at Scheduler Statistics and Warp State Statistics for potential reasons.                 

    Section: Launch Statistics
    -------------------------------- --------------- ---------------
    Metric Name                          Metric Unit    Metric Value
    -------------------------------- --------------- ---------------
    Block Size                                                   256
    Function Cache Configuration                     CachePreferNone
    Grid Size                                                  1,024
    Registers Per Thread             register/thread              23
    Shared Memory Configuration Size           Kbyte           32.77
    Driver Shared Memory Per Block       Kbyte/block            1.02
    Dynamic Shared Memory Per Block       byte/block               0
    Static Shared Memory Per Block        byte/block               0
    Threads                                   thread         262,144
    Waves Per SM                                                1.19
    -------------------------------- --------------- ---------------

    OPT   Estimated Speedup: 50%                                                                                        
          A wave of thread blocks is defined as the maximum number of blocks that can be executed in parallel on the    
          target GPU. The number of blocks in a wave depends on the number of multiprocessors and the theoretical       
          occupancy of the kernel. This kernel launch results in 1 full waves and a partial wave of 159 thread blocks.  
          Under the assumption of a uniform execution duration of all thread blocks, the partial wave may account for   
          up to 50.0% of the total kernel runtime with a lower occupancy of 26.6%. Try launching a grid with no         
          partial wave. The overall impact of this tail effect also lessens with the number of full waves executed for  
          a grid. See the Hardware Model                                                                                
          (https://docs.nvidia.com/nsight-compute/ProfilingGuide/index.html#metrics-hw-model) description for more      
          details on launch configurations.                                                                             

    Section: Occupancy
    ------------------------------- ----------- ------------
    Metric Name                     Metric Unit Metric Value
    ------------------------------- ----------- ------------
    Block Limit SM                        block           32
    Block Limit Registers                 block           10
    Block Limit Shared Mem                block           32
    Block Limit Warps                     block            8
    Theoretical Active Warps per SM        warp           64
    Theoretical Occupancy                     %          100
    Achieved Occupancy                        %        73.37
    Achieved Active Warps Per SM           warp        46.96
    ------------------------------- ----------- ------------

    OPT   Estimated Speedup: 26.63%                                                                                     
          This kernel's theoretical occupancy is not impacted by any block limit. The difference between calculated     
          theoretical (100.0%) and measured achieved occupancy (73.4%) can be the result of warp scheduling overheads   
          or workload imbalances during the kernel execution. Load imbalances can occur between warps within a block    
          as well as across blocks of the same kernel. See the CUDA Best Practices Guide                                
          (https://docs.nvidia.com/cuda/cuda-c-best-practices-guide/index.html#occupancy) for more details on           
          optimizing occupancy.                                                                                         

    Section: Source Counters
    ------------------------- ----------- ------------
    Metric Name               Metric Unit Metric Value
    ------------------------- ----------- ------------
    Branch Instructions Ratio           %         0.06
    Branch Instructions              inst    5,746,733
    Branch Efficiency                   %        99.78
    Avg. Divergent Branches                      17.81
    ------------------------- ----------- ------------

    OPT   Estimated Speedup: 0%                                                                                         
          This kernel has uncoalesced global accesses resulting in a total of 6851808 excessive sectors (13% of the     
          total 52583746 sectors). Check the L2 Theoretical Sectors Global Excessive table for the primary source       
          locations. The CUDA Programming Guide                                                                         
          (https://docs.nvidia.com/cuda/cuda-c-programming-guide/index.html#device-memory-accesses) had additional      
          information on reducing uncoalesced device memory accesses.                                                   

ncu --set default --section SourceCounters --section Occupancy --section LaunchStats --section SpeedOfLight --metrics smsp__cycles_active.avg.pct_of_peak_sustained_elapsed,dram__throughput.avg.pct_of_peak_sustained_elapsed,gpu__time_duration.avg ./sobel_gpu -T 256 -B 4096
==PROF== Connected to process 2155047 (/pscratch/sd/u/usatie/csc746-cp5-gpu-stencil/build/sobel_gpu)
 Read data from the file ../data/zebra-gray-int8-4x 
Command line number of `threads per block`: 256
Command line number of `thread blocks`: 4096
==PROF== Profiling "sobel_kernel_gpu" - 0: 0%....50%....100% - 13 passes
 GPU configuration: 4096 blocks, 256 threads per block 
 Elapsed time is : 1.910436 (sec) 
 Wrote the output file ../data/processed-raw-int8-4x-gpu.dat 
==PROF== Disconnected from process 2155047
[2155047] sobel_gpu@127.0.0.1
  sobel_kernel_gpu(const float *, float *, int, int, int) (4096, 1, 1)x(256, 1, 1), Context 1, Stream 7, Device 0, CC 8.0
    Section: Command line profiler metrics
    ----------------------------------------------------- ----------- ------------
    Metric Name                                           Metric Unit Metric Value
    ----------------------------------------------------- ----------- ------------
    dram__throughput.avg.pct_of_peak_sustained_elapsed              %        53.45
    gpu__time_duration.avg                                    usecond       343.01
    smsp__cycles_active.avg.pct_of_peak_sustained_elapsed           %        97.51
    ----------------------------------------------------- ----------- ------------

    Section: GPU Speed Of Light Throughput
    ----------------------- ------------- ------------
    Metric Name               Metric Unit Metric Value
    ----------------------- ------------- ------------
    DRAM Frequency          cycle/nsecond         1.21
    SM Frequency            cycle/nsecond         1.09
    Elapsed Cycles                  cycle      373,548
    Memory Throughput                   %        53.45
    DRAM Throughput                     %        53.45
    Duration                      usecond       343.01
    L1/TEX Cache Throughput             %        40.13
    L2 Cache Throughput                 %        61.98
    SM Active Cycles                cycle   365,379.21
    Compute (SM) Throughput             %        62.06
    ----------------------- ------------- ------------

    INF   Compute and Memory are well-balanced: To reduce runtime, both computation and memory traffic must be reduced. 
          Check both the Compute Workload Analysis and Memory Workload Analysis sections.                               

    Section: Launch Statistics
    -------------------------------- --------------- ---------------
    Metric Name                          Metric Unit    Metric Value
    -------------------------------- --------------- ---------------
    Block Size                                                   256
    Function Cache Configuration                     CachePreferNone
    Grid Size                                                  4,096
    Registers Per Thread             register/thread              23
    Shared Memory Configuration Size           Kbyte           32.77
    Driver Shared Memory Per Block       Kbyte/block            1.02
    Dynamic Shared Memory Per Block       byte/block               0
    Static Shared Memory Per Block        byte/block               0
    Threads                                   thread       1,048,576
    Waves Per SM                                                4.74
    -------------------------------- --------------- ---------------

    Section: Occupancy
    ------------------------------- ----------- ------------
    Metric Name                     Metric Unit Metric Value
    ------------------------------- ----------- ------------
    Block Limit SM                        block           32
    Block Limit Registers                 block           10
    Block Limit Shared Mem                block           32
    Block Limit Warps                     block            8
    Theoretical Active Warps per SM        warp           64
    Theoretical Occupancy                     %          100
    Achieved Occupancy                        %        91.27
    Achieved Active Warps Per SM           warp        58.41
    ------------------------------- ----------- ------------

    INF   This kernel's theoretical occupancy is not impacted by any block limit.                                       

    Section: Source Counters
    ------------------------- ----------- ------------
    Metric Name               Metric Unit Metric Value
    ------------------------- ----------- ------------
    Branch Instructions Ratio           %         0.06
    Branch Instructions              inst    5,795,885
    Branch Efficiency                   %        99.78
    Avg. Divergent Branches                      17.81
    ------------------------- ----------- ------------

    OPT   Estimated Speedup: 0%                                                                                         
          This kernel has uncoalesced global accesses resulting in a total of 6851808 excessive sectors (13% of the     
          total 52583746 sectors). Check the L2 Theoretical Sectors Global Excessive table for the primary source       
          locations. The CUDA Programming Guide                                                                         
          (https://docs.nvidia.com/cuda/cuda-c-programming-guide/index.html#device-memory-accesses) had additional      
          information on reducing uncoalesced device memory accesses.                                                   

ncu --set default --section SourceCounters --section Occupancy --section LaunchStats --section SpeedOfLight --metrics smsp__cycles_active.avg.pct_of_peak_sustained_elapsed,dram__throughput.avg.pct_of_peak_sustained_elapsed,gpu__time_duration.avg ./sobel_gpu -T 512 -B 1
==PROF== Connected to process 2155116 (/pscratch/sd/u/usatie/csc746-cp5-gpu-stencil/build/sobel_gpu)
 Read data from the file ../data/zebra-gray-int8-4x 
Command line number of `threads per block`: 512
Command line number of `thread blocks`: 1
==PROF== Profiling "sobel_kernel_gpu" - 0: 0%.
==WARNING== Launching the workload is taking more time than expected. If this continues to hang, terminate the profile and re-try by profiling the range of all related launches using '--replay-mode range'. See https://docs.nvidia.com/nsight-compute/ProfilingGuide/index.html#replay for more details.
...50%....100% - 13 passes
 GPU configuration: 1 blocks, 512 threads per block 
 Elapsed time is : 9.558670 (sec) 
 Wrote the output file ../data/processed-raw-int8-4x-gpu.dat 
==PROF== Disconnected from process 2155116
[2155116] sobel_gpu@127.0.0.1
  sobel_kernel_gpu(const float *, float *, int, int, int) (1, 1, 1)x(512, 1, 1), Context 1, Stream 7, Device 0, CC 8.0
    Section: Command line profiler metrics
    ----------------------------------------------------- ----------- ------------
    Metric Name                                           Metric Unit Metric Value
    ----------------------------------------------------- ----------- ------------
    dram__throughput.avg.pct_of_peak_sustained_elapsed              %         0.25
    gpu__time_duration.avg                                    msecond        71.36
    smsp__cycles_active.avg.pct_of_peak_sustained_elapsed           %         0.93
    ----------------------------------------------------- ----------- ------------

    Section: GPU Speed Of Light Throughput
    ----------------------- ------------- ------------
    Metric Name               Metric Unit Metric Value
    ----------------------- ------------- ------------
    DRAM Frequency          cycle/nsecond         1.21
    SM Frequency            cycle/nsecond         1.09
    Elapsed Cycles                  cycle   78,136,842
    Memory Throughput                   %         0.25
    DRAM Throughput                     %         0.25
    Duration                      msecond        71.36
    L1/TEX Cache Throughput             %        19.88
    L2 Cache Throughput                 %         0.24
    SM Active Cycles                cycle   723,441.95
    Compute (SM) Throughput             %         0.29
    ----------------------- ------------- ------------

    OPT   This kernel grid is too small to fill the available resources on this device, resulting in only 0.0 full      
          waves across all SMs. Look at Launch Statistics for more details.                                             

    Section: Launch Statistics
    -------------------------------- --------------- ---------------
    Metric Name                          Metric Unit    Metric Value
    -------------------------------- --------------- ---------------
    Block Size                                                   512
    Function Cache Configuration                     CachePreferNone
    Grid Size                                                      1
    Registers Per Thread             register/thread              23
    Shared Memory Configuration Size           Kbyte           16.38
    Driver Shared Memory Per Block       Kbyte/block            1.02
    Dynamic Shared Memory Per Block       byte/block               0
    Static Shared Memory Per Block        byte/block               0
    Threads                                   thread             512
    Waves Per SM                                                0.00
    -------------------------------- --------------- ---------------

    OPT   Estimated Speedup: 99.07%                                                                                     
          The grid for this launch is configured to execute only 1 blocks, which is less than the GPU's 108             
          multiprocessors. This can underutilize some multiprocessors. If you do not intend to execute this kernel      
          concurrently with other workloads, consider reducing the block size to have at least one block per            
          multiprocessor or increase the size of the grid to fully utilize the available hardware resources. See the    
          Hardware Model (https://docs.nvidia.com/nsight-compute/ProfilingGuide/index.html#metrics-hw-model)            
          description for more details on launch configurations.                                                        

    Section: Occupancy
    ------------------------------- ----------- ------------
    Metric Name                     Metric Unit Metric Value
    ------------------------------- ----------- ------------
    Block Limit SM                        block           32
    Block Limit Registers                 block            5
    Block Limit Shared Mem                block           16
    Block Limit Warps                     block            4
    Theoretical Active Warps per SM        warp           64
    Theoretical Occupancy                     %          100
    Achieved Occupancy                        %        24.86
    Achieved Active Warps Per SM           warp        15.91
    ------------------------------- ----------- ------------

    OPT   Estimated Speedup: 75.14%                                                                                     
          This kernel's theoretical occupancy is not impacted by any block limit. The difference between calculated     
          theoretical (100.0%) and measured achieved occupancy (24.9%) can be the result of warp scheduling overheads   
          or workload imbalances during the kernel execution. Load imbalances can occur between warps within a block    
          as well as across blocks of the same kernel. See the CUDA Best Practices Guide                                
          (https://docs.nvidia.com/cuda/cuda-c-best-practices-guide/index.html#occupancy) for more details on           
          optimizing occupancy.                                                                                         

    Section: Source Counters
    ------------------------- ----------- ------------
    Metric Name               Metric Unit Metric Value
    ------------------------- ----------- ------------
    Branch Instructions Ratio           %         0.06
    Branch Instructions              inst    5,730,381
    Branch Efficiency                   %        99.78
    Avg. Divergent Branches                      17.81
    ------------------------- ----------- ------------

    OPT   Estimated Speedup: 0%                                                                                         
          This kernel has uncoalesced global accesses resulting in a total of 6851808 excessive sectors (13% of the     
          total 52583746 sectors). Check the L2 Theoretical Sectors Global Excessive table for the primary source       
          locations. The CUDA Programming Guide                                                                         
          (https://docs.nvidia.com/cuda/cuda-c-programming-guide/index.html#device-memory-accesses) had additional      
          information on reducing uncoalesced device memory accesses.                                                   

ncu --set default --section SourceCounters --section Occupancy --section LaunchStats --section SpeedOfLight --metrics smsp__cycles_active.avg.pct_of_peak_sustained_elapsed,dram__throughput.avg.pct_of_peak_sustained_elapsed,gpu__time_duration.avg ./sobel_gpu -T 512 -B 4
==PROF== Connected to process 2155161 (/pscratch/sd/u/usatie/csc746-cp5-gpu-stencil/build/sobel_gpu)
 Read data from the file ../data/zebra-gray-int8-4x 
Command line number of `threads per block`: 512
Command line number of `thread blocks`: 4
==PROF== Profiling "sobel_kernel_gpu" - 0: 0%....50%....100% - 13 passes
 GPU configuration: 4 blocks, 512 threads per block 
 Elapsed time is : 3.669376 (sec) 
 Wrote the output file ../data/processed-raw-int8-4x-gpu.dat 
==PROF== Disconnected from process 2155161
[2155161] sobel_gpu@127.0.0.1
  sobel_kernel_gpu(const float *, float *, int, int, int) (4, 1, 1)x(512, 1, 1), Context 1, Stream 7, Device 0, CC 8.0
    Section: Command line profiler metrics
    ----------------------------------------------------- ----------- ------------
    Metric Name                                           Metric Unit Metric Value
    ----------------------------------------------------- ----------- ------------
    dram__throughput.avg.pct_of_peak_sustained_elapsed              %         1.00
    gpu__time_duration.avg                                    msecond        18.06
    smsp__cycles_active.avg.pct_of_peak_sustained_elapsed           %         3.70
    ----------------------------------------------------- ----------- ------------

    Section: GPU Speed Of Light Throughput
    ----------------------- ------------- ------------
    Metric Name               Metric Unit Metric Value
    ----------------------- ------------- ------------
    DRAM Frequency          cycle/nsecond         1.21
    SM Frequency            cycle/nsecond         1.09
    Elapsed Cycles                  cycle   19,762,864
    Memory Throughput                   %         1.00
    DRAM Throughput                     %         1.00
    Duration                      msecond        18.06
    L1/TEX Cache Throughput             %        19.13
    L2 Cache Throughput                 %         1.43
    SM Active Cycles                cycle      731,971
    Compute (SM) Throughput             %         1.17
    ----------------------- ------------- ------------

    OPT   This kernel grid is too small to fill the available resources on this device, resulting in only 0.0 full      
          waves across all SMs. Look at Launch Statistics for more details.                                             

    Section: Launch Statistics
    -------------------------------- --------------- ---------------
    Metric Name                          Metric Unit    Metric Value
    -------------------------------- --------------- ---------------
    Block Size                                                   512
    Function Cache Configuration                     CachePreferNone
    Grid Size                                                      4
    Registers Per Thread             register/thread              23
    Shared Memory Configuration Size           Kbyte           16.38
    Driver Shared Memory Per Block       Kbyte/block            1.02
    Dynamic Shared Memory Per Block       byte/block               0
    Static Shared Memory Per Block        byte/block               0
    Threads                                   thread           2,048
    Waves Per SM                                                0.01
    -------------------------------- --------------- ---------------

    OPT   Estimated Speedup: 96.3%                                                                                      
          The grid for this launch is configured to execute only 4 blocks, which is less than the GPU's 108             
          multiprocessors. This can underutilize some multiprocessors. If you do not intend to execute this kernel      
          concurrently with other workloads, consider reducing the block size to have at least one block per            
          multiprocessor or increase the size of the grid to fully utilize the available hardware resources. See the    
          Hardware Model (https://docs.nvidia.com/nsight-compute/ProfilingGuide/index.html#metrics-hw-model)            
          description for more details on launch configurations.                                                        

    Section: Occupancy
    ------------------------------- ----------- ------------
    Metric Name                     Metric Unit Metric Value
    ------------------------------- ----------- ------------
    Block Limit SM                        block           32
    Block Limit Registers                 block            5
    Block Limit Shared Mem                block           16
    Block Limit Warps                     block            4
    Theoretical Active Warps per SM        warp           64
    Theoretical Occupancy                     %          100
    Achieved Occupancy                        %        24.69
    Achieved Active Warps Per SM           warp        15.80
    ------------------------------- ----------- ------------

    OPT   Estimated Speedup: 75.31%                                                                                     
          This kernel's theoretical occupancy is not impacted by any block limit. The difference between calculated     
          theoretical (100.0%) and measured achieved occupancy (24.7%) can be the result of warp scheduling overheads   
          or workload imbalances during the kernel execution. Load imbalances can occur between warps within a block    
          as well as across blocks of the same kernel. See the CUDA Best Practices Guide                                
          (https://docs.nvidia.com/cuda/cuda-c-best-practices-guide/index.html#occupancy) for more details on           
          optimizing occupancy.                                                                                         

    Section: Source Counters
    ------------------------- ----------- ------------
    Metric Name               Metric Unit Metric Value
    ------------------------- ----------- ------------
    Branch Instructions Ratio           %         0.06
    Branch Instructions              inst    5,730,477
    Branch Efficiency                   %        99.78
    Avg. Divergent Branches                      17.81
    ------------------------- ----------- ------------

    OPT   Estimated Speedup: 0%                                                                                         
          This kernel has uncoalesced global accesses resulting in a total of 6851808 excessive sectors (13% of the     
          total 52583746 sectors). Check the L2 Theoretical Sectors Global Excessive table for the primary source       
          locations. The CUDA Programming Guide                                                                         
          (https://docs.nvidia.com/cuda/cuda-c-programming-guide/index.html#device-memory-accesses) had additional      
          information on reducing uncoalesced device memory accesses.                                                   

ncu --set default --section SourceCounters --section Occupancy --section LaunchStats --section SpeedOfLight --metrics smsp__cycles_active.avg.pct_of_peak_sustained_elapsed,dram__throughput.avg.pct_of_peak_sustained_elapsed,gpu__time_duration.avg ./sobel_gpu -T 512 -B 16
==PROF== Connected to process 2155227 (/pscratch/sd/u/usatie/csc746-cp5-gpu-stencil/build/sobel_gpu)
 Read data from the file ../data/zebra-gray-int8-4x 
Command line number of `threads per block`: 512
Command line number of `thread blocks`: 16
==PROF== Profiling "sobel_kernel_gpu" - 0: 0%....50%....100% - 13 passes
 GPU configuration: 16 blocks, 512 threads per block 
 Elapsed time is : 2.224488 (sec) 
 Wrote the output file ../data/processed-raw-int8-4x-gpu.dat 
==PROF== Disconnected from process 2155227
[2155227] sobel_gpu@127.0.0.1
  sobel_kernel_gpu(const float *, float *, int, int, int) (16, 1, 1)x(512, 1, 1), Context 1, Stream 7, Device 0, CC 8.0
    Section: Command line profiler metrics
    ----------------------------------------------------- ----------- ------------
    Metric Name                                           Metric Unit Metric Value
    ----------------------------------------------------- ----------- ------------
    dram__throughput.avg.pct_of_peak_sustained_elapsed              %         3.88
    gpu__time_duration.avg                                    msecond         4.66
    smsp__cycles_active.avg.pct_of_peak_sustained_elapsed           %        14.74
    ----------------------------------------------------- ----------- ------------

    Section: GPU Speed Of Light Throughput
    ----------------------- ------------- ------------
    Metric Name               Metric Unit Metric Value
    ----------------------- ------------- ------------
    DRAM Frequency          cycle/nsecond         1.21
    SM Frequency            cycle/nsecond         1.09
    Elapsed Cycles                  cycle    5,098,043
    Memory Throughput                   %         3.88
    DRAM Throughput                     %         3.88
    Duration                      msecond         4.66
    L1/TEX Cache Throughput             %        18.77
    L2 Cache Throughput                 %         5.10
    SM Active Cycles                cycle   752,968.59
    Compute (SM) Throughput             %         4.52
    ----------------------- ------------- ------------

    OPT   This kernel grid is too small to fill the available resources on this device, resulting in only 0.0 full      
          waves across all SMs. Look at Launch Statistics for more details.                                             

    Section: Launch Statistics
    -------------------------------- --------------- ---------------
    Metric Name                          Metric Unit    Metric Value
    -------------------------------- --------------- ---------------
    Block Size                                                   512
    Function Cache Configuration                     CachePreferNone
    Grid Size                                                     16
    Registers Per Thread             register/thread              23
    Shared Memory Configuration Size           Kbyte           16.38
    Driver Shared Memory Per Block       Kbyte/block            1.02
    Dynamic Shared Memory Per Block       byte/block               0
    Static Shared Memory Per Block        byte/block               0
    Threads                                   thread           8,192
    Waves Per SM                                                0.04
    -------------------------------- --------------- ---------------

    OPT   Estimated Speedup: 85.19%                                                                                     
          The grid for this launch is configured to execute only 16 blocks, which is less than the GPU's 108            
          multiprocessors. This can underutilize some multiprocessors. If you do not intend to execute this kernel      
          concurrently with other workloads, consider reducing the block size to have at least one block per            
          multiprocessor or increase the size of the grid to fully utilize the available hardware resources. See the    
          Hardware Model (https://docs.nvidia.com/nsight-compute/ProfilingGuide/index.html#metrics-hw-model)            
          description for more details on launch configurations.                                                        

    Section: Occupancy
    ------------------------------- ----------- ------------
    Metric Name                     Metric Unit Metric Value
    ------------------------------- ----------- ------------
    Block Limit SM                        block           32
    Block Limit Registers                 block            5
    Block Limit Shared Mem                block           16
    Block Limit Warps                     block            4
    Theoretical Active Warps per SM        warp           64
    Theoretical Occupancy                     %          100
    Achieved Occupancy                        %        24.67
    Achieved Active Warps Per SM           warp        15.79
    ------------------------------- ----------- ------------

    OPT   Estimated Speedup: 75.33%                                                                                     
          This kernel's theoretical occupancy is not impacted by any block limit. The difference between calculated     
          theoretical (100.0%) and measured achieved occupancy (24.7%) can be the result of warp scheduling overheads   
          or workload imbalances during the kernel execution. Load imbalances can occur between warps within a block    
          as well as across blocks of the same kernel. See the CUDA Best Practices Guide                                
          (https://docs.nvidia.com/cuda/cuda-c-best-practices-guide/index.html#occupancy) for more details on           
          optimizing occupancy.                                                                                         

    Section: Source Counters
    ------------------------- ----------- ------------
    Metric Name               Metric Unit Metric Value
    ------------------------- ----------- ------------
    Branch Instructions Ratio           %         0.06
    Branch Instructions              inst    5,730,861
    Branch Efficiency                   %        99.78
    Avg. Divergent Branches                      17.81
    ------------------------- ----------- ------------

    OPT   Estimated Speedup: 0%                                                                                         
          This kernel has uncoalesced global accesses resulting in a total of 6851808 excessive sectors (13% of the     
          total 52583746 sectors). Check the L2 Theoretical Sectors Global Excessive table for the primary source       
          locations. The CUDA Programming Guide                                                                         
          (https://docs.nvidia.com/cuda/cuda-c-programming-guide/index.html#device-memory-accesses) had additional      
          information on reducing uncoalesced device memory accesses.                                                   

ncu --set default --section SourceCounters --section Occupancy --section LaunchStats --section SpeedOfLight --metrics smsp__cycles_active.avg.pct_of_peak_sustained_elapsed,dram__throughput.avg.pct_of_peak_sustained_elapsed,gpu__time_duration.avg ./sobel_gpu -T 512 -B 64
==PROF== Connected to process 2155271 (/pscratch/sd/u/usatie/csc746-cp5-gpu-stencil/build/sobel_gpu)
 Read data from the file ../data/zebra-gray-int8-4x 
Command line number of `threads per block`: 512
Command line number of `thread blocks`: 64
==PROF== Profiling "sobel_kernel_gpu" - 0: 0%....50%....100% - 13 passes
 GPU configuration: 64 blocks, 512 threads per block 
 Elapsed time is : 1.915576 (sec) 
 Wrote the output file ../data/processed-raw-int8-4x-gpu.dat 
==PROF== Disconnected from process 2155271
[2155271] sobel_gpu@127.0.0.1
  sobel_kernel_gpu(const float *, float *, int, int, int) (64, 1, 1)x(512, 1, 1), Context 1, Stream 7, Device 0, CC 8.0
    Section: Command line profiler metrics
    ----------------------------------------------------- ----------- ------------
    Metric Name                                           Metric Unit Metric Value
    ----------------------------------------------------- ----------- ------------
    dram__throughput.avg.pct_of_peak_sustained_elapsed              %        14.48
    gpu__time_duration.avg                                    msecond         1.24
    smsp__cycles_active.avg.pct_of_peak_sustained_elapsed           %        58.37
    ----------------------------------------------------- ----------- ------------

    Section: GPU Speed Of Light Throughput
    ----------------------- ------------- ------------
    Metric Name               Metric Unit Metric Value
    ----------------------- ------------- ------------
    DRAM Frequency          cycle/nsecond         1.22
    SM Frequency            cycle/nsecond         1.10
    Elapsed Cycles                  cycle    1,363,630
    Memory Throughput                   %        14.48
    DRAM Throughput                     %        14.48
    Duration                      msecond         1.24
    L1/TEX Cache Throughput             %        18.17
    L2 Cache Throughput                 %        16.33
    SM Active Cycles                cycle   798,488.35
    Compute (SM) Throughput             %        16.90
    ----------------------- ------------- ------------

    OPT   This kernel grid is too small to fill the available resources on this device, resulting in only 0.1 full      
          waves across all SMs. Look at Launch Statistics for more details.                                             

    Section: Launch Statistics
    -------------------------------- --------------- ---------------
    Metric Name                          Metric Unit    Metric Value
    -------------------------------- --------------- ---------------
    Block Size                                                   512
    Function Cache Configuration                     CachePreferNone
    Grid Size                                                     64
    Registers Per Thread             register/thread              23
    Shared Memory Configuration Size           Kbyte           16.38
    Driver Shared Memory Per Block       Kbyte/block            1.02
    Dynamic Shared Memory Per Block       byte/block               0
    Static Shared Memory Per Block        byte/block               0
    Threads                                   thread          32,768
    Waves Per SM                                                0.15
    -------------------------------- --------------- ---------------

    OPT   Estimated Speedup: 40.74%                                                                                     
          The grid for this launch is configured to execute only 64 blocks, which is less than the GPU's 108            
          multiprocessors. This can underutilize some multiprocessors. If you do not intend to execute this kernel      
          concurrently with other workloads, consider reducing the block size to have at least one block per            
          multiprocessor or increase the size of the grid to fully utilize the available hardware resources. See the    
          Hardware Model (https://docs.nvidia.com/nsight-compute/ProfilingGuide/index.html#metrics-hw-model)            
          description for more details on launch configurations.                                                        

    Section: Occupancy
    ------------------------------- ----------- ------------
    Metric Name                     Metric Unit Metric Value
    ------------------------------- ----------- ------------
    Block Limit SM                        block           32
    Block Limit Registers                 block            5
    Block Limit Shared Mem                block           16
    Block Limit Warps                     block            4
    Theoretical Active Warps per SM        warp           64
    Theoretical Occupancy                     %          100
    Achieved Occupancy                        %        24.64
    Achieved Active Warps Per SM           warp        15.77
    ------------------------------- ----------- ------------

    OPT   Estimated Speedup: 75.36%                                                                                     
          This kernel's theoretical occupancy is not impacted by any block limit. The difference between calculated     
          theoretical (100.0%) and measured achieved occupancy (24.6%) can be the result of warp scheduling overheads   
          or workload imbalances during the kernel execution. Load imbalances can occur between warps within a block    
          as well as across blocks of the same kernel. See the CUDA Best Practices Guide                                
          (https://docs.nvidia.com/cuda/cuda-c-best-practices-guide/index.html#occupancy) for more details on           
          optimizing occupancy.                                                                                         

    Section: Source Counters
    ------------------------- ----------- ------------
    Metric Name               Metric Unit Metric Value
    ------------------------- ----------- ------------
    Branch Instructions Ratio           %         0.06
    Branch Instructions              inst    5,732,397
    Branch Efficiency                   %        99.78
    Avg. Divergent Branches                      17.81
    ------------------------- ----------- ------------

    OPT   Estimated Speedup: 0%                                                                                         
          This kernel has uncoalesced global accesses resulting in a total of 6851808 excessive sectors (13% of the     
          total 52583746 sectors). Check the L2 Theoretical Sectors Global Excessive table for the primary source       
          locations. The CUDA Programming Guide                                                                         
          (https://docs.nvidia.com/cuda/cuda-c-programming-guide/index.html#device-memory-accesses) had additional      
          information on reducing uncoalesced device memory accesses.                                                   

ncu --set default --section SourceCounters --section Occupancy --section LaunchStats --section SpeedOfLight --metrics smsp__cycles_active.avg.pct_of_peak_sustained_elapsed,dram__throughput.avg.pct_of_peak_sustained_elapsed,gpu__time_duration.avg ./sobel_gpu -T 512 -B 256
==PROF== Connected to process 2155315 (/pscratch/sd/u/usatie/csc746-cp5-gpu-stencil/build/sobel_gpu)
 Read data from the file ../data/zebra-gray-int8-4x 
Command line number of `threads per block`: 512
Command line number of `thread blocks`: 256
==PROF== Profiling "sobel_kernel_gpu" - 0: 0%....50%....100% - 13 passes
 GPU configuration: 256 blocks, 512 threads per block 
 Elapsed time is : 1.972796 (sec) 
 Wrote the output file ../data/processed-raw-int8-4x-gpu.dat 
==PROF== Disconnected from process 2155315
[2155315] sobel_gpu@127.0.0.1
  sobel_kernel_gpu(const float *, float *, int, int, int) (256, 1, 1)x(512, 1, 1), Context 1, Stream 7, Device 0, CC 8.0
    Section: Command line profiler metrics
    ----------------------------------------------------- ----------- ------------
    Metric Name                                           Metric Unit Metric Value
    ----------------------------------------------------- ----------- ------------
    dram__throughput.avg.pct_of_peak_sustained_elapsed              %        41.94
    gpu__time_duration.avg                                    usecond       475.14
    smsp__cycles_active.avg.pct_of_peak_sustained_elapsed           %        88.96
    ----------------------------------------------------- ----------- ------------

    Section: GPU Speed Of Light Throughput
    ----------------------- ------------- ------------
    Metric Name               Metric Unit Metric Value
    ----------------------- ------------- ------------
    DRAM Frequency          cycle/nsecond         1.21
    SM Frequency            cycle/nsecond         1.09
    Elapsed Cycles                  cycle      518,000
    Memory Throughput                   %        41.94
    DRAM Throughput                     %        41.94
    Duration                      usecond       475.14
    L1/TEX Cache Throughput             %        31.71
    L2 Cache Throughput                 %        42.38
    SM Active Cycles                cycle   462,816.09
    Compute (SM) Throughput             %        44.53
    ----------------------- ------------- ------------

    OPT   This kernel grid is too small to fill the available resources on this device, resulting in only 0.6 full      
          waves across all SMs. Look at Launch Statistics for more details.                                             

    Section: Launch Statistics
    -------------------------------- --------------- ---------------
    Metric Name                          Metric Unit    Metric Value
    -------------------------------- --------------- ---------------
    Block Size                                                   512
    Function Cache Configuration                     CachePreferNone
    Grid Size                                                    256
    Registers Per Thread             register/thread              23
    Shared Memory Configuration Size           Kbyte           16.38
    Driver Shared Memory Per Block       Kbyte/block            1.02
    Dynamic Shared Memory Per Block       byte/block               0
    Static Shared Memory Per Block        byte/block               0
    Threads                                   thread         131,072
    Waves Per SM                                                0.59
    -------------------------------- --------------- ---------------

    Section: Occupancy
    ------------------------------- ----------- ------------
    Metric Name                     Metric Unit Metric Value
    ------------------------------- ----------- ------------
    Block Limit SM                        block           32
    Block Limit Registers                 block            5
    Block Limit Shared Mem                block           16
    Block Limit Warps                     block            4
    Theoretical Active Warps per SM        warp           64
    Theoretical Occupancy                     %          100
    Achieved Occupancy                        %        54.89
    Achieved Active Warps Per SM           warp        35.13
    ------------------------------- ----------- ------------

    OPT   Estimated Speedup: 45.11%                                                                                     
          This kernel's theoretical occupancy is not impacted by any block limit. The difference between calculated     
          theoretical (100.0%) and measured achieved occupancy (54.9%) can be the result of warp scheduling overheads   
          or workload imbalances during the kernel execution. Load imbalances can occur between warps within a block    
          as well as across blocks of the same kernel. See the CUDA Best Practices Guide                                
          (https://docs.nvidia.com/cuda/cuda-c-best-practices-guide/index.html#occupancy) for more details on           
          optimizing occupancy.                                                                                         

    Section: Source Counters
    ------------------------- ----------- ------------
    Metric Name               Metric Unit Metric Value
    ------------------------- ----------- ------------
    Branch Instructions Ratio           %         0.06
    Branch Instructions              inst    5,738,541
    Branch Efficiency                   %        99.78
    Avg. Divergent Branches                      17.81
    ------------------------- ----------- ------------

    OPT   Estimated Speedup: 0%                                                                                         
          This kernel has uncoalesced global accesses resulting in a total of 6851808 excessive sectors (13% of the     
          total 52583746 sectors). Check the L2 Theoretical Sectors Global Excessive table for the primary source       
          locations. The CUDA Programming Guide                                                                         
          (https://docs.nvidia.com/cuda/cuda-c-programming-guide/index.html#device-memory-accesses) had additional      
          information on reducing uncoalesced device memory accesses.                                                   

ncu --set default --section SourceCounters --section Occupancy --section LaunchStats --section SpeedOfLight --metrics smsp__cycles_active.avg.pct_of_peak_sustained_elapsed,dram__throughput.avg.pct_of_peak_sustained_elapsed,gpu__time_duration.avg ./sobel_gpu -T 512 -B 1024
==PROF== Connected to process 2155359 (/pscratch/sd/u/usatie/csc746-cp5-gpu-stencil/build/sobel_gpu)
 Read data from the file ../data/zebra-gray-int8-4x 
Command line number of `threads per block`: 512
Command line number of `thread blocks`: 1024
==PROF== Profiling "sobel_kernel_gpu" - 0: 0%....50%....100% - 13 passes
 GPU configuration: 1024 blocks, 512 threads per block 
 Elapsed time is : 1.966029 (sec) 
 Wrote the output file ../data/processed-raw-int8-4x-gpu.dat 
==PROF== Disconnected from process 2155359
[2155359] sobel_gpu@127.0.0.1
  sobel_kernel_gpu(const float *, float *, int, int, int) (1024, 1, 1)x(512, 1, 1), Context 1, Stream 7, Device 0, CC 8.0
    Section: Command line profiler metrics
    ----------------------------------------------------- ----------- ------------
    Metric Name                                           Metric Unit Metric Value
    ----------------------------------------------------- ----------- ------------
    dram__throughput.avg.pct_of_peak_sustained_elapsed              %        52.14
    gpu__time_duration.avg                                    usecond       374.59
    smsp__cycles_active.avg.pct_of_peak_sustained_elapsed           %        94.98
    ----------------------------------------------------- ----------- ------------

    Section: GPU Speed Of Light Throughput
    ----------------------- ------------- ------------
    Metric Name               Metric Unit Metric Value
    ----------------------- ------------- ------------
    DRAM Frequency          cycle/nsecond         1.21
    SM Frequency            cycle/nsecond         1.09
    Elapsed Cycles                  cycle      407,431
    Memory Throughput                   %        52.14
    DRAM Throughput                     %        52.14
    Duration                      usecond       374.59
    L1/TEX Cache Throughput             %        38.48
    L2 Cache Throughput                 %        55.49
    SM Active Cycles                cycle   387,986.50
    Compute (SM) Throughput             %        56.74
    ----------------------- ------------- ------------

    OPT   This kernel exhibits low compute throughput and memory bandwidth utilization relative to the peak performance 
          of this device. Achieved compute throughput and/or memory bandwidth below 60.0% of peak typically indicate    
          latency issues. Look at Scheduler Statistics and Warp State Statistics for potential reasons.                 

    Section: Launch Statistics
    -------------------------------- --------------- ---------------
    Metric Name                          Metric Unit    Metric Value
    -------------------------------- --------------- ---------------
    Block Size                                                   512
    Function Cache Configuration                     CachePreferNone
    Grid Size                                                  1,024
    Registers Per Thread             register/thread              23
    Shared Memory Configuration Size           Kbyte           16.38
    Driver Shared Memory Per Block       Kbyte/block            1.02
    Dynamic Shared Memory Per Block       byte/block               0
    Static Shared Memory Per Block        byte/block               0
    Threads                                   thread         524,288
    Waves Per SM                                                2.37
    -------------------------------- --------------- ---------------

    Section: Occupancy
    ------------------------------- ----------- ------------
    Metric Name                     Metric Unit Metric Value
    ------------------------------- ----------- ------------
    Block Limit SM                        block           32
    Block Limit Registers                 block            5
    Block Limit Shared Mem                block           16
    Block Limit Warps                     block            4
    Theoretical Active Warps per SM        warp           64
    Theoretical Occupancy                     %          100
    Achieved Occupancy                        %        85.63
    Achieved Active Warps Per SM           warp        54.80
    ------------------------------- ----------- ------------

    OPT   Estimated Speedup: 14.37%                                                                                     
          This kernel's theoretical occupancy is not impacted by any block limit. The difference between calculated     
          theoretical (100.0%) and measured achieved occupancy (85.6%) can be the result of warp scheduling overheads   
          or workload imbalances during the kernel execution. Load imbalances can occur between warps within a block    
          as well as across blocks of the same kernel. See the CUDA Best Practices Guide                                
          (https://docs.nvidia.com/cuda/cuda-c-best-practices-guide/index.html#occupancy) for more details on           
          optimizing occupancy.                                                                                         

    Section: Source Counters
    ------------------------- ----------- ------------
    Metric Name               Metric Unit Metric Value
    ------------------------- ----------- ------------
    Branch Instructions Ratio           %         0.06
    Branch Instructions              inst    5,763,117
    Branch Efficiency                   %        99.78
    Avg. Divergent Branches                      17.81
    ------------------------- ----------- ------------

    OPT   Estimated Speedup: 0%                                                                                         
          This kernel has uncoalesced global accesses resulting in a total of 6851808 excessive sectors (13% of the     
          total 52583746 sectors). Check the L2 Theoretical Sectors Global Excessive table for the primary source       
          locations. The CUDA Programming Guide                                                                         
          (https://docs.nvidia.com/cuda/cuda-c-programming-guide/index.html#device-memory-accesses) had additional      
          information on reducing uncoalesced device memory accesses.                                                   

ncu --set default --section SourceCounters --section Occupancy --section LaunchStats --section SpeedOfLight --metrics smsp__cycles_active.avg.pct_of_peak_sustained_elapsed,dram__throughput.avg.pct_of_peak_sustained_elapsed,gpu__time_duration.avg ./sobel_gpu -T 512 -B 4096
==PROF== Connected to process 2155424 (/pscratch/sd/u/usatie/csc746-cp5-gpu-stencil/build/sobel_gpu)
 Read data from the file ../data/zebra-gray-int8-4x 
Command line number of `threads per block`: 512
Command line number of `thread blocks`: 4096
==PROF== Profiling "sobel_kernel_gpu" - 0: 0%....50%....100% - 13 passes
 GPU configuration: 4096 blocks, 512 threads per block 
 Elapsed time is : 1.909472 (sec) 
 Wrote the output file ../data/processed-raw-int8-4x-gpu.dat 
==PROF== Disconnected from process 2155424
[2155424] sobel_gpu@127.0.0.1
  sobel_kernel_gpu(const float *, float *, int, int, int) (4096, 1, 1)x(512, 1, 1), Context 1, Stream 7, Device 0, CC 8.0
    Section: Command line profiler metrics
    ----------------------------------------------------- ----------- ------------
    Metric Name                                           Metric Unit Metric Value
    ----------------------------------------------------- ----------- ------------
    dram__throughput.avg.pct_of_peak_sustained_elapsed              %        53.55
    gpu__time_duration.avg                                    usecond       340.32
    smsp__cycles_active.avg.pct_of_peak_sustained_elapsed           %        97.90
    ----------------------------------------------------- ----------- ------------

    Section: GPU Speed Of Light Throughput
    ----------------------- ------------- ------------
    Metric Name               Metric Unit Metric Value
    ----------------------- ------------- ------------
    DRAM Frequency          cycle/nsecond         1.21
    SM Frequency            cycle/nsecond         1.09
    Elapsed Cycles                  cycle      371,077
    Memory Throughput                   %        53.55
    DRAM Throughput                     %        53.55
    Duration                      usecond       340.32
    L1/TEX Cache Throughput             %        40.25
    L2 Cache Throughput                 %        62.28
    SM Active Cycles                cycle   364,063.55
    Compute (SM) Throughput             %        62.83
    ----------------------- ------------- ------------

    INF   Compute and Memory are well-balanced: To reduce runtime, both computation and memory traffic must be reduced. 
          Check both the Compute Workload Analysis and Memory Workload Analysis sections.                               

    Section: Launch Statistics
    -------------------------------- --------------- ---------------
    Metric Name                          Metric Unit    Metric Value
    -------------------------------- --------------- ---------------
    Block Size                                                   512
    Function Cache Configuration                     CachePreferNone
    Grid Size                                                  4,096
    Registers Per Thread             register/thread              23
    Shared Memory Configuration Size           Kbyte           16.38
    Driver Shared Memory Per Block       Kbyte/block            1.02
    Dynamic Shared Memory Per Block       byte/block               0
    Static Shared Memory Per Block        byte/block               0
    Threads                                   thread       2,097,152
    Waves Per SM                                                9.48
    -------------------------------- --------------- ---------------

    Section: Occupancy
    ------------------------------- ----------- ------------
    Metric Name                     Metric Unit Metric Value
    ------------------------------- ----------- ------------
    Block Limit SM                        block           32
    Block Limit Registers                 block            5
    Block Limit Shared Mem                block           16
    Block Limit Warps                     block            4
    Theoretical Active Warps per SM        warp           64
    Theoretical Occupancy                     %          100
    Achieved Occupancy                        %        92.51
    Achieved Active Warps Per SM           warp        59.20
    ------------------------------- ----------- ------------

    INF   This kernel's theoretical occupancy is not impacted by any block limit.                                       

    Section: Source Counters
    ------------------------- ----------- ------------
    Metric Name               Metric Unit Metric Value
    ------------------------- ----------- ------------
    Branch Instructions Ratio           %         0.06
    Branch Instructions              inst    5,861,421
    Branch Efficiency                   %        99.78
    Avg. Divergent Branches                      17.81
    ------------------------- ----------- ------------

    OPT   Estimated Speedup: 0%                                                                                         
          This kernel has uncoalesced global accesses resulting in a total of 6851808 excessive sectors (13% of the     
          total 52583746 sectors). Check the L2 Theoretical Sectors Global Excessive table for the primary source       
          locations. The CUDA Programming Guide                                                                         
          (https://docs.nvidia.com/cuda/cuda-c-programming-guide/index.html#device-memory-accesses) had additional      
          information on reducing uncoalesced device memory accesses.                                                   

ncu --set default --section SourceCounters --section Occupancy --section LaunchStats --section SpeedOfLight --metrics smsp__cycles_active.avg.pct_of_peak_sustained_elapsed,dram__throughput.avg.pct_of_peak_sustained_elapsed,gpu__time_duration.avg ./sobel_gpu -T 1024 -B 1
==PROF== Connected to process 2155469 (/pscratch/sd/u/usatie/csc746-cp5-gpu-stencil/build/sobel_gpu)
 Read data from the file ../data/zebra-gray-int8-4x 
Command line number of `threads per block`: 1024
Command line number of `thread blocks`: 1
==PROF== Profiling "sobel_kernel_gpu" - 0: 0%.
==WARNING== Launching the workload is taking more time than expected. If this continues to hang, terminate the profile and re-try by profiling the range of all related launches using '--replay-mode range'. See https://docs.nvidia.com/nsight-compute/ProfilingGuide/index.html#replay for more details.
...50%....100% - 13 passes
 GPU configuration: 1 blocks, 1024 threads per block 
 Elapsed time is : 7.350573 (sec) 
 Wrote the output file ../data/processed-raw-int8-4x-gpu.dat 
==PROF== Disconnected from process 2155469
[2155469] sobel_gpu@127.0.0.1
  sobel_kernel_gpu(const float *, float *, int, int, int) (1, 1, 1)x(1024, 1, 1), Context 1, Stream 7, Device 0, CC 8.0
    Section: Command line profiler metrics
    ----------------------------------------------------- ----------- ------------
    Metric Name                                           Metric Unit Metric Value
    ----------------------------------------------------- ----------- ------------
    dram__throughput.avg.pct_of_peak_sustained_elapsed              %         0.40
    gpu__time_duration.avg                                    msecond        44.62
    smsp__cycles_active.avg.pct_of_peak_sustained_elapsed           %         0.93
    ----------------------------------------------------- ----------- ------------

    Section: GPU Speed Of Light Throughput
    ----------------------- ------------- ------------
    Metric Name               Metric Unit Metric Value
    ----------------------- ------------- ------------
    DRAM Frequency          cycle/nsecond         1.22
    SM Frequency            cycle/nsecond         1.10
    Elapsed Cycles                  cycle   49,130,652
    Memory Throughput                   %         0.40
    DRAM Throughput                     %         0.40
    Duration                      msecond        44.62
    L1/TEX Cache Throughput             %        27.58
    L2 Cache Throughput                 %         0.38
    SM Active Cycles                cycle   456,934.56
    Compute (SM) Throughput             %         0.47
    ----------------------- ------------- ------------

    OPT   This kernel grid is too small to fill the available resources on this device, resulting in only 0.0 full      
          waves across all SMs. Look at Launch Statistics for more details.                                             

    Section: Launch Statistics
    -------------------------------- --------------- ---------------
    Metric Name                          Metric Unit    Metric Value
    -------------------------------- --------------- ---------------
    Block Size                                                 1,024
    Function Cache Configuration                     CachePreferNone
    Grid Size                                                      1
    Registers Per Thread             register/thread              23
    Shared Memory Configuration Size           Kbyte            8.19
    Driver Shared Memory Per Block       Kbyte/block            1.02
    Dynamic Shared Memory Per Block       byte/block               0
    Static Shared Memory Per Block        byte/block               0
    Threads                                   thread           1,024
    Waves Per SM                                                0.00
    -------------------------------- --------------- ---------------

    OPT   Estimated Speedup: 99.07%                                                                                     
          The grid for this launch is configured to execute only 1 blocks, which is less than the GPU's 108             
          multiprocessors. This can underutilize some multiprocessors. If you do not intend to execute this kernel      
          concurrently with other workloads, consider reducing the block size to have at least one block per            
          multiprocessor or increase the size of the grid to fully utilize the available hardware resources. See the    
          Hardware Model (https://docs.nvidia.com/nsight-compute/ProfilingGuide/index.html#metrics-hw-model)            
          description for more details on launch configurations.                                                        

    Section: Occupancy
    ------------------------------- ----------- ------------
    Metric Name                     Metric Unit Metric Value
    ------------------------------- ----------- ------------
    Block Limit SM                        block           32
    Block Limit Registers                 block            2
    Block Limit Shared Mem                block            8
    Block Limit Warps                     block            2
    Theoretical Active Warps per SM        warp           64
    Theoretical Occupancy                     %          100
    Achieved Occupancy                        %        48.06
    Achieved Active Warps Per SM           warp        30.76
    ------------------------------- ----------- ------------

    OPT   Estimated Speedup: 51.94%                                                                                     
          This kernel's theoretical occupancy is not impacted by any block limit. The difference between calculated     
          theoretical (100.0%) and measured achieved occupancy (48.1%) can be the result of warp scheduling overheads   
          or workload imbalances during the kernel execution. Load imbalances can occur between warps within a block    
          as well as across blocks of the same kernel. See the CUDA Best Practices Guide                                
          (https://docs.nvidia.com/cuda/cuda-c-best-practices-guide/index.html#occupancy) for more details on           
          optimizing occupancy.                                                                                         

    Section: Source Counters
    ------------------------- ----------- ------------
    Metric Name               Metric Unit Metric Value
    ------------------------- ----------- ------------
    Branch Instructions Ratio           %         0.06
    Branch Instructions              inst    5,730,413
    Branch Efficiency                   %        99.78
    Avg. Divergent Branches                      17.81
    ------------------------- ----------- ------------

    OPT   Estimated Speedup: 0%                                                                                         
          This kernel has uncoalesced global accesses resulting in a total of 6851808 excessive sectors (13% of the     
          total 52583746 sectors). Check the L2 Theoretical Sectors Global Excessive table for the primary source       
          locations. The CUDA Programming Guide                                                                         
          (https://docs.nvidia.com/cuda/cuda-c-programming-guide/index.html#device-memory-accesses) had additional      
          information on reducing uncoalesced device memory accesses.                                                   

ncu --set default --section SourceCounters --section Occupancy --section LaunchStats --section SpeedOfLight --metrics smsp__cycles_active.avg.pct_of_peak_sustained_elapsed,dram__throughput.avg.pct_of_peak_sustained_elapsed,gpu__time_duration.avg ./sobel_gpu -T 1024 -B 4
==PROF== Connected to process 2155513 (/pscratch/sd/u/usatie/csc746-cp5-gpu-stencil/build/sobel_gpu)
 Read data from the file ../data/zebra-gray-int8-4x 
Command line number of `threads per block`: 1024
Command line number of `thread blocks`: 4
==PROF== Profiling "sobel_kernel_gpu" - 0: 0%....50%....100% - 13 passes
 GPU configuration: 4 blocks, 1024 threads per block 
 Elapsed time is : 3.179364 (sec) 
 Wrote the output file ../data/processed-raw-int8-4x-gpu.dat 
==PROF== Disconnected from process 2155513
[2155513] sobel_gpu@127.0.0.1
  sobel_kernel_gpu(const float *, float *, int, int, int) (4, 1, 1)x(1024, 1, 1), Context 1, Stream 7, Device 0, CC 8.0
    Section: Command line profiler metrics
    ----------------------------------------------------- ----------- ------------
    Metric Name                                           Metric Unit Metric Value
    ----------------------------------------------------- ----------- ------------
    dram__throughput.avg.pct_of_peak_sustained_elapsed              %         1.62
    gpu__time_duration.avg                                    msecond        11.36
    smsp__cycles_active.avg.pct_of_peak_sustained_elapsed           %         3.67
    ----------------------------------------------------- ----------- ------------

    Section: GPU Speed Of Light Throughput
    ----------------------- ------------- ------------
    Metric Name               Metric Unit Metric Value
    ----------------------- ------------- ------------
    DRAM Frequency          cycle/nsecond         1.22
    SM Frequency            cycle/nsecond         1.10
    Elapsed Cycles                  cycle   12,460,423
    Memory Throughput                   %         1.62
    DRAM Throughput                     %         1.62
    Duration                      msecond        11.36
    L1/TEX Cache Throughput             %        26.80
    L2 Cache Throughput                 %         2.28
    SM Active Cycles                cycle   459,700.50
    Compute (SM) Throughput             %         1.85
    ----------------------- ------------- ------------

    OPT   This kernel grid is too small to fill the available resources on this device, resulting in only 0.0 full      
          waves across all SMs. Look at Launch Statistics for more details.                                             

    Section: Launch Statistics
    -------------------------------- --------------- ---------------
    Metric Name                          Metric Unit    Metric Value
    -------------------------------- --------------- ---------------
    Block Size                                                 1,024
    Function Cache Configuration                     CachePreferNone
    Grid Size                                                      4
    Registers Per Thread             register/thread              23
    Shared Memory Configuration Size           Kbyte            8.19
    Driver Shared Memory Per Block       Kbyte/block            1.02
    Dynamic Shared Memory Per Block       byte/block               0
    Static Shared Memory Per Block        byte/block               0
    Threads                                   thread           4,096
    Waves Per SM                                                0.02
    -------------------------------- --------------- ---------------

    OPT   Estimated Speedup: 96.3%                                                                                      
          The grid for this launch is configured to execute only 4 blocks, which is less than the GPU's 108             
          multiprocessors. This can underutilize some multiprocessors. If you do not intend to execute this kernel      
          concurrently with other workloads, consider reducing the block size to have at least one block per            
          multiprocessor or increase the size of the grid to fully utilize the available hardware resources. See the    
          Hardware Model (https://docs.nvidia.com/nsight-compute/ProfilingGuide/index.html#metrics-hw-model)            
          description for more details on launch configurations.                                                        

    Section: Occupancy
    ------------------------------- ----------- ------------
    Metric Name                     Metric Unit Metric Value
    ------------------------------- ----------- ------------
    Block Limit SM                        block           32
    Block Limit Registers                 block            2
    Block Limit Shared Mem                block            8
    Block Limit Warps                     block            2
    Theoretical Active Warps per SM        warp           64
    Theoretical Occupancy                     %          100
    Achieved Occupancy                        %        47.78
    Achieved Active Warps Per SM           warp        30.58
    ------------------------------- ----------- ------------

    OPT   Estimated Speedup: 52.22%                                                                                     
          This kernel's theoretical occupancy is not impacted by any block limit. The difference between calculated     
          theoretical (100.0%) and measured achieved occupancy (47.8%) can be the result of warp scheduling overheads   
          or workload imbalances during the kernel execution. Load imbalances can occur between warps within a block    
          as well as across blocks of the same kernel. See the CUDA Best Practices Guide                                
          (https://docs.nvidia.com/cuda/cuda-c-best-practices-guide/index.html#occupancy) for more details on           
          optimizing occupancy.                                                                                         

    Section: Source Counters
    ------------------------- ----------- ------------
    Metric Name               Metric Unit Metric Value
    ------------------------- ----------- ------------
    Branch Instructions Ratio           %         0.06
    Branch Instructions              inst    5,730,605
    Branch Efficiency                   %        99.78
    Avg. Divergent Branches                      17.81
    ------------------------- ----------- ------------

    OPT   Estimated Speedup: 0%                                                                                         
          This kernel has uncoalesced global accesses resulting in a total of 6851808 excessive sectors (13% of the     
          total 52583746 sectors). Check the L2 Theoretical Sectors Global Excessive table for the primary source       
          locations. The CUDA Programming Guide                                                                         
          (https://docs.nvidia.com/cuda/cuda-c-programming-guide/index.html#device-memory-accesses) had additional      
          information on reducing uncoalesced device memory accesses.                                                   

ncu --set default --section SourceCounters --section Occupancy --section LaunchStats --section SpeedOfLight --metrics smsp__cycles_active.avg.pct_of_peak_sustained_elapsed,dram__throughput.avg.pct_of_peak_sustained_elapsed,gpu__time_duration.avg ./sobel_gpu -T 1024 -B 16
==PROF== Connected to process 2155584 (/pscratch/sd/u/usatie/csc746-cp5-gpu-stencil/build/sobel_gpu)
 Read data from the file ../data/zebra-gray-int8-4x 
Command line number of `threads per block`: 1024
Command line number of `thread blocks`: 16
==PROF== Profiling "sobel_kernel_gpu" - 0: 0%....50%....100% - 13 passes
 GPU configuration: 16 blocks, 1024 threads per block 
 Elapsed time is : 2.138587 (sec) 
 Wrote the output file ../data/processed-raw-int8-4x-gpu.dat 
==PROF== Disconnected from process 2155584
[2155584] sobel_gpu@127.0.0.1
  sobel_kernel_gpu(const float *, float *, int, int, int) (16, 1, 1)x(1024, 1, 1), Context 1, Stream 7, Device 0, CC 8.0
    Section: Command line profiler metrics
    ----------------------------------------------------- ----------- ------------
    Metric Name                                           Metric Unit Metric Value
    ----------------------------------------------------- ----------- ------------
    dram__throughput.avg.pct_of_peak_sustained_elapsed              %         6.18
    gpu__time_duration.avg                                    msecond         2.94
    smsp__cycles_active.avg.pct_of_peak_sustained_elapsed           %        14.61
    ----------------------------------------------------- ----------- ------------

    Section: GPU Speed Of Light Throughput
    ----------------------- ------------- ------------
    Metric Name               Metric Unit Metric Value
    ----------------------- ------------- ------------
    DRAM Frequency          cycle/nsecond         1.22
    SM Frequency            cycle/nsecond         1.10
    Elapsed Cycles                  cycle    3,231,679
    Memory Throughput                   %         6.18
    DRAM Throughput                     %         6.18
    Duration                      msecond         2.94
    L1/TEX Cache Throughput             %        27.52
    L2 Cache Throughput                 %         7.33
    SM Active Cycles                cycle   474,873.95
    Compute (SM) Throughput             %         7.13
    ----------------------- ------------- ------------

    OPT   This kernel grid is too small to fill the available resources on this device, resulting in only 0.1 full      
          waves across all SMs. Look at Launch Statistics for more details.                                             

    Section: Launch Statistics
    -------------------------------- --------------- ---------------
    Metric Name                          Metric Unit    Metric Value
    -------------------------------- --------------- ---------------
    Block Size                                                 1,024
    Function Cache Configuration                     CachePreferNone
    Grid Size                                                     16
    Registers Per Thread             register/thread              23
    Shared Memory Configuration Size           Kbyte            8.19
    Driver Shared Memory Per Block       Kbyte/block            1.02
    Dynamic Shared Memory Per Block       byte/block               0
    Static Shared Memory Per Block        byte/block               0
    Threads                                   thread          16,384
    Waves Per SM                                                0.07
    -------------------------------- --------------- ---------------

    OPT   Estimated Speedup: 85.19%                                                                                     
          The grid for this launch is configured to execute only 16 blocks, which is less than the GPU's 108            
          multiprocessors. This can underutilize some multiprocessors. If you do not intend to execute this kernel      
          concurrently with other workloads, consider reducing the block size to have at least one block per            
          multiprocessor or increase the size of the grid to fully utilize the available hardware resources. See the    
          Hardware Model (https://docs.nvidia.com/nsight-compute/ProfilingGuide/index.html#metrics-hw-model)            
          description for more details on launch configurations.                                                        

    Section: Occupancy
    ------------------------------- ----------- ------------
    Metric Name                     Metric Unit Metric Value
    ------------------------------- ----------- ------------
    Block Limit SM                        block           32
    Block Limit Registers                 block            2
    Block Limit Shared Mem                block            8
    Block Limit Warps                     block            2
    Theoretical Active Warps per SM        warp           64
    Theoretical Occupancy                     %          100
    Achieved Occupancy                        %        47.84
    Achieved Active Warps Per SM           warp        30.62
    ------------------------------- ----------- ------------

    OPT   Estimated Speedup: 52.16%                                                                                     
          This kernel's theoretical occupancy is not impacted by any block limit. The difference between calculated     
          theoretical (100.0%) and measured achieved occupancy (47.8%) can be the result of warp scheduling overheads   
          or workload imbalances during the kernel execution. Load imbalances can occur between warps within a block    
          as well as across blocks of the same kernel. See the CUDA Best Practices Guide                                
          (https://docs.nvidia.com/cuda/cuda-c-best-practices-guide/index.html#occupancy) for more details on           
          optimizing occupancy.                                                                                         

    Section: Source Counters
    ------------------------- ----------- ------------
    Metric Name               Metric Unit Metric Value
    ------------------------- ----------- ------------
    Branch Instructions Ratio           %         0.06
    Branch Instructions              inst    5,731,373
    Branch Efficiency                   %        99.78
    Avg. Divergent Branches                      17.81
    ------------------------- ----------- ------------

    OPT   Estimated Speedup: 0%                                                                                         
          This kernel has uncoalesced global accesses resulting in a total of 6851808 excessive sectors (13% of the     
          total 52583746 sectors). Check the L2 Theoretical Sectors Global Excessive table for the primary source       
          locations. The CUDA Programming Guide                                                                         
          (https://docs.nvidia.com/cuda/cuda-c-programming-guide/index.html#device-memory-accesses) had additional      
          information on reducing uncoalesced device memory accesses.                                                   

ncu --set default --section SourceCounters --section Occupancy --section LaunchStats --section SpeedOfLight --metrics smsp__cycles_active.avg.pct_of_peak_sustained_elapsed,dram__throughput.avg.pct_of_peak_sustained_elapsed,gpu__time_duration.avg ./sobel_gpu -T 1024 -B 64
==PROF== Connected to process 2155629 (/pscratch/sd/u/usatie/csc746-cp5-gpu-stencil/build/sobel_gpu)
 Read data from the file ../data/zebra-gray-int8-4x 
Command line number of `threads per block`: 1024
Command line number of `thread blocks`: 64
==PROF== Profiling "sobel_kernel_gpu" - 0: 0%....50%....100% - 13 passes
 GPU configuration: 64 blocks, 1024 threads per block 
 Elapsed time is : 1.946683 (sec) 
 Wrote the output file ../data/processed-raw-int8-4x-gpu.dat 
==PROF== Disconnected from process 2155629
[2155629] sobel_gpu@127.0.0.1
  sobel_kernel_gpu(const float *, float *, int, int, int) (64, 1, 1)x(1024, 1, 1), Context 1, Stream 7, Device 0, CC 8.0
    Section: Command line profiler metrics
    ----------------------------------------------------- ----------- ------------
    Metric Name                                           Metric Unit Metric Value
    ----------------------------------------------------- ----------- ------------
    dram__throughput.avg.pct_of_peak_sustained_elapsed              %        22.73
    gpu__time_duration.avg                                    usecond       801.44
    smsp__cycles_active.avg.pct_of_peak_sustained_elapsed           %        58.16
    ----------------------------------------------------- ----------- ------------

    Section: GPU Speed Of Light Throughput
    ----------------------- ------------- ------------
    Metric Name               Metric Unit Metric Value
    ----------------------- ------------- ------------
    DRAM Frequency          cycle/nsecond         1.21
    SM Frequency            cycle/nsecond         1.09
    Elapsed Cycles                  cycle      873,785
    Memory Throughput                   %        22.73
    DRAM Throughput                     %        22.73
    Duration                      usecond       801.44
    L1/TEX Cache Throughput             %        27.42
    L2 Cache Throughput                 %        23.52
    SM Active Cycles                cycle   512,269.82
    Compute (SM) Throughput             %        26.38
    ----------------------- ------------- ------------

    OPT   This kernel grid is too small to fill the available resources on this device, resulting in only 0.3 full      
          waves across all SMs. Look at Launch Statistics for more details.                                             

    Section: Launch Statistics
    -------------------------------- --------------- ---------------
    Metric Name                          Metric Unit    Metric Value
    -------------------------------- --------------- ---------------
    Block Size                                                 1,024
    Function Cache Configuration                     CachePreferNone
    Grid Size                                                     64
    Registers Per Thread             register/thread              23
    Shared Memory Configuration Size           Kbyte            8.19
    Driver Shared Memory Per Block       Kbyte/block            1.02
    Dynamic Shared Memory Per Block       byte/block               0
    Static Shared Memory Per Block        byte/block               0
    Threads                                   thread          65,536
    Waves Per SM                                                0.30
    -------------------------------- --------------- ---------------

    OPT   Estimated Speedup: 40.74%                                                                                     
          The grid for this launch is configured to execute only 64 blocks, which is less than the GPU's 108            
          multiprocessors. This can underutilize some multiprocessors. If you do not intend to execute this kernel      
          concurrently with other workloads, consider reducing the block size to have at least one block per            
          multiprocessor or increase the size of the grid to fully utilize the available hardware resources. See the    
          Hardware Model (https://docs.nvidia.com/nsight-compute/ProfilingGuide/index.html#metrics-hw-model)            
          description for more details on launch configurations.                                                        

    Section: Occupancy
    ------------------------------- ----------- ------------
    Metric Name                     Metric Unit Metric Value
    ------------------------------- ----------- ------------
    Block Limit SM                        block           32
    Block Limit Registers                 block            2
    Block Limit Shared Mem                block            8
    Block Limit Warps                     block            2
    Theoretical Active Warps per SM        warp           64
    Theoretical Occupancy                     %          100
    Achieved Occupancy                        %        47.93
    Achieved Active Warps Per SM           warp        30.68
    ------------------------------- ----------- ------------

    OPT   Estimated Speedup: 52.07%                                                                                     
          This kernel's theoretical occupancy is not impacted by any block limit. The difference between calculated     
          theoretical (100.0%) and measured achieved occupancy (47.9%) can be the result of warp scheduling overheads   
          or workload imbalances during the kernel execution. Load imbalances can occur between warps within a block    
          as well as across blocks of the same kernel. See the CUDA Best Practices Guide                                
          (https://docs.nvidia.com/cuda/cuda-c-best-practices-guide/index.html#occupancy) for more details on           
          optimizing occupancy.                                                                                         

    Section: Source Counters
    ------------------------- ----------- ------------
    Metric Name               Metric Unit Metric Value
    ------------------------- ----------- ------------
    Branch Instructions Ratio           %         0.06
    Branch Instructions              inst    5,734,445
    Branch Efficiency                   %        99.78
    Avg. Divergent Branches                      17.81
    ------------------------- ----------- ------------

    OPT   Estimated Speedup: 0%                                                                                         
          This kernel has uncoalesced global accesses resulting in a total of 6851808 excessive sectors (13% of the     
          total 52583746 sectors). Check the L2 Theoretical Sectors Global Excessive table for the primary source       
          locations. The CUDA Programming Guide                                                                         
          (https://docs.nvidia.com/cuda/cuda-c-programming-guide/index.html#device-memory-accesses) had additional      
          information on reducing uncoalesced device memory accesses.                                                   

ncu --set default --section SourceCounters --section Occupancy --section LaunchStats --section SpeedOfLight --metrics smsp__cycles_active.avg.pct_of_peak_sustained_elapsed,dram__throughput.avg.pct_of_peak_sustained_elapsed,gpu__time_duration.avg ./sobel_gpu -T 1024 -B 256
==PROF== Connected to process 2155673 (/pscratch/sd/u/usatie/csc746-cp5-gpu-stencil/build/sobel_gpu)
 Read data from the file ../data/zebra-gray-int8-4x 
Command line number of `threads per block`: 1024
Command line number of `thread blocks`: 256
==PROF== Profiling "sobel_kernel_gpu" - 0: 0%....50%....100% - 13 passes
 GPU configuration: 256 blocks, 1024 threads per block 
 Elapsed time is : 1.885596 (sec) 
 Wrote the output file ../data/processed-raw-int8-4x-gpu.dat 
==PROF== Disconnected from process 2155673
[2155673] sobel_gpu@127.0.0.1
  sobel_kernel_gpu(const float *, float *, int, int, int) (256, 1, 1)x(1024, 1, 1), Context 1, Stream 7, Device 0, CC 8.0
    Section: Command line profiler metrics
    ----------------------------------------------------- ----------- ------------
    Metric Name                                           Metric Unit Metric Value
    ----------------------------------------------------- ----------- ------------
    dram__throughput.avg.pct_of_peak_sustained_elapsed              %        44.06
    gpu__time_duration.avg                                    usecond       475.62
    smsp__cycles_active.avg.pct_of_peak_sustained_elapsed           %        77.80
    ----------------------------------------------------- ----------- ------------

    Section: GPU Speed Of Light Throughput
    ----------------------- ------------- ------------
    Metric Name               Metric Unit Metric Value
    ----------------------- ------------- ------------
    DRAM Frequency          cycle/nsecond         1.21
    SM Frequency            cycle/nsecond         1.09
    Elapsed Cycles                  cycle      519,956
    Memory Throughput                   %        44.06
    DRAM Throughput                     %        44.06
    Duration                      usecond       475.62
    L1/TEX Cache Throughput             %        36.94
    L2 Cache Throughput                 %        42.59
    SM Active Cycles                cycle   406,879.02
    Compute (SM) Throughput             %        44.40
    ----------------------- ------------- ------------

    OPT   This kernel exhibits low compute throughput and memory bandwidth utilization relative to the peak performance 
          of this device. Achieved compute throughput and/or memory bandwidth below 60.0% of peak typically indicate    
          latency issues. Look at Scheduler Statistics and Warp State Statistics for potential reasons.                 

    Section: Launch Statistics
    -------------------------------- --------------- ---------------
    Metric Name                          Metric Unit    Metric Value
    -------------------------------- --------------- ---------------
    Block Size                                                 1,024
    Function Cache Configuration                     CachePreferNone
    Grid Size                                                    256
    Registers Per Thread             register/thread              23
    Shared Memory Configuration Size           Kbyte            8.19
    Driver Shared Memory Per Block       Kbyte/block            1.02
    Dynamic Shared Memory Per Block       byte/block               0
    Static Shared Memory Per Block        byte/block               0
    Threads                                   thread         262,144
    Waves Per SM                                                1.19
    -------------------------------- --------------- ---------------

    Section: Occupancy
    ------------------------------- ----------- ------------
    Metric Name                     Metric Unit Metric Value
    ------------------------------- ----------- ------------
    Block Limit SM                        block           32
    Block Limit Registers                 block            2
    Block Limit Shared Mem                block            8
    Block Limit Warps                     block            2
    Theoretical Active Warps per SM        warp           64
    Theoretical Occupancy                     %          100
    Achieved Occupancy                        %        83.40
    Achieved Active Warps Per SM           warp        53.37
    ------------------------------- ----------- ------------

    OPT   Estimated Speedup: 16.6%                                                                                      
          This kernel's theoretical occupancy is not impacted by any block limit. The difference between calculated     
          theoretical (100.0%) and measured achieved occupancy (83.4%) can be the result of warp scheduling overheads   
          or workload imbalances during the kernel execution. Load imbalances can occur between warps within a block    
          as well as across blocks of the same kernel. See the CUDA Best Practices Guide                                
          (https://docs.nvidia.com/cuda/cuda-c-best-practices-guide/index.html#occupancy) for more details on           
          optimizing occupancy.                                                                                         

    Section: Source Counters
    ------------------------- ----------- ------------
    Metric Name               Metric Unit Metric Value
    ------------------------- ----------- ------------
    Branch Instructions Ratio           %         0.06
    Branch Instructions              inst    5,746,733
    Branch Efficiency                   %        99.78
    Avg. Divergent Branches                      17.81
    ------------------------- ----------- ------------

    OPT   Estimated Speedup: 0%                                                                                         
          This kernel has uncoalesced global accesses resulting in a total of 6851808 excessive sectors (13% of the     
          total 52583746 sectors). Check the L2 Theoretical Sectors Global Excessive table for the primary source       
          locations. The CUDA Programming Guide                                                                         
          (https://docs.nvidia.com/cuda/cuda-c-programming-guide/index.html#device-memory-accesses) had additional      
          information on reducing uncoalesced device memory accesses.                                                   

ncu --set default --section SourceCounters --section Occupancy --section LaunchStats --section SpeedOfLight --metrics smsp__cycles_active.avg.pct_of_peak_sustained_elapsed,dram__throughput.avg.pct_of_peak_sustained_elapsed,gpu__time_duration.avg ./sobel_gpu -T 1024 -B 1024
==PROF== Connected to process 2155743 (/pscratch/sd/u/usatie/csc746-cp5-gpu-stencil/build/sobel_gpu)
 Read data from the file ../data/zebra-gray-int8-4x 
Command line number of `threads per block`: 1024
Command line number of `thread blocks`: 1024
==PROF== Profiling "sobel_kernel_gpu" - 0: 0%....50%....100% - 13 passes
 GPU configuration: 1024 blocks, 1024 threads per block 
 Elapsed time is : 1.894065 (sec) 
 Wrote the output file ../data/processed-raw-int8-4x-gpu.dat 
==PROF== Disconnected from process 2155743
[2155743] sobel_gpu@127.0.0.1
  sobel_kernel_gpu(const float *, float *, int, int, int) (1024, 1, 1)x(1024, 1, 1), Context 1, Stream 7, Device 0, CC 8.0
    Section: Command line profiler metrics
    ----------------------------------------------------- ----------- ------------
    Metric Name                                           Metric Unit Metric Value
    ----------------------------------------------------- ----------- ------------
    dram__throughput.avg.pct_of_peak_sustained_elapsed              %        51.98
    gpu__time_duration.avg                                    usecond       368.19
    smsp__cycles_active.avg.pct_of_peak_sustained_elapsed           %        93.87
    ----------------------------------------------------- ----------- ------------

    Section: GPU Speed Of Light Throughput
    ----------------------- ------------- ------------
    Metric Name               Metric Unit Metric Value
    ----------------------- ------------- ------------
    DRAM Frequency          cycle/nsecond         1.22
    SM Frequency            cycle/nsecond         1.10
    Elapsed Cycles                  cycle      404,763
    Memory Throughput                   %        51.98
    DRAM Throughput                     %        51.98
    Duration                      usecond       368.19
    L1/TEX Cache Throughput             %        39.41
    L2 Cache Throughput                 %        59.94
    SM Active Cycles                cycle   381,081.60
    Compute (SM) Throughput             %        57.27
    ----------------------- ------------- ------------

    OPT   This kernel exhibits low compute throughput and memory bandwidth utilization relative to the peak performance 
          of this device. Achieved compute throughput and/or memory bandwidth below 60.0% of peak typically indicate    
          latency issues. Look at Scheduler Statistics and Warp State Statistics for potential reasons.                 

    Section: Launch Statistics
    -------------------------------- --------------- ---------------
    Metric Name                          Metric Unit    Metric Value
    -------------------------------- --------------- ---------------
    Block Size                                                 1,024
    Function Cache Configuration                     CachePreferNone
    Grid Size                                                  1,024
    Registers Per Thread             register/thread              23
    Shared Memory Configuration Size           Kbyte            8.19
    Driver Shared Memory Per Block       Kbyte/block            1.02
    Dynamic Shared Memory Per Block       byte/block               0
    Static Shared Memory Per Block        byte/block               0
    Threads                                   thread       1,048,576
    Waves Per SM                                                4.74
    -------------------------------- --------------- ---------------

    Section: Occupancy
    ------------------------------- ----------- ------------
    Metric Name                     Metric Unit Metric Value
    ------------------------------- ----------- ------------
    Block Limit SM                        block           32
    Block Limit Registers                 block            2
    Block Limit Shared Mem                block            8
    Block Limit Warps                     block            2
    Theoretical Active Warps per SM        warp           64
    Theoretical Occupancy                     %          100
    Achieved Occupancy                        %        90.50
    Achieved Active Warps Per SM           warp        57.92
    ------------------------------- ----------- ------------

    INF   This kernel's theoretical occupancy is not impacted by any block limit.                                       

    Section: Source Counters
    ------------------------- ----------- ------------
    Metric Name               Metric Unit Metric Value
    ------------------------- ----------- ------------
    Branch Instructions Ratio           %         0.06
    Branch Instructions              inst    5,795,885
    Branch Efficiency                   %        99.78
    Avg. Divergent Branches                      17.81
    ------------------------- ----------- ------------

    OPT   Estimated Speedup: 0%                                                                                         
          This kernel has uncoalesced global accesses resulting in a total of 6851808 excessive sectors (13% of the     
          total 52583746 sectors). Check the L2 Theoretical Sectors Global Excessive table for the primary source       
          locations. The CUDA Programming Guide                                                                         
          (https://docs.nvidia.com/cuda/cuda-c-programming-guide/index.html#device-memory-accesses) had additional      
          information on reducing uncoalesced device memory accesses.                                                   

ncu --set default --section SourceCounters --section Occupancy --section LaunchStats --section SpeedOfLight --metrics smsp__cycles_active.avg.pct_of_peak_sustained_elapsed,dram__throughput.avg.pct_of_peak_sustained_elapsed,gpu__time_duration.avg ./sobel_gpu -T 1024 -B 4096
==PROF== Connected to process 2155788 (/pscratch/sd/u/usatie/csc746-cp5-gpu-stencil/build/sobel_gpu)
 Read data from the file ../data/zebra-gray-int8-4x 
Command line number of `threads per block`: 1024
Command line number of `thread blocks`: 4096
==PROF== Profiling "sobel_kernel_gpu" - 0: 0%....50%....100% - 13 passes
 GPU configuration: 4096 blocks, 1024 threads per block 
 Elapsed time is : 1.905241 (sec) 
 Wrote the output file ../data/processed-raw-int8-4x-gpu.dat 
==PROF== Disconnected from process 2155788
[2155788] sobel_gpu@127.0.0.1
  sobel_kernel_gpu(const float *, float *, int, int, int) (4096, 1, 1)x(1024, 1, 1), Context 1, Stream 7, Device 0, CC 8.0
    Section: Command line profiler metrics
    ----------------------------------------------------- ----------- ------------
    Metric Name                                           Metric Unit Metric Value
    ----------------------------------------------------- ----------- ------------
    dram__throughput.avg.pct_of_peak_sustained_elapsed              %        50.34
    gpu__time_duration.avg                                    usecond       358.98
    smsp__cycles_active.avg.pct_of_peak_sustained_elapsed           %        98.08
    ----------------------------------------------------- ----------- ------------

    Section: GPU Speed Of Light Throughput
    ----------------------- ------------- ------------
    Metric Name               Metric Unit Metric Value
    ----------------------- ------------- ------------
    DRAM Frequency          cycle/nsecond         1.21
    SM Frequency            cycle/nsecond         1.09
    Elapsed Cycles                  cycle      392,038
    Memory Throughput                   %        50.34
    DRAM Throughput                     %        50.34
    Duration                      usecond       358.98
    L1/TEX Cache Throughput             %        37.92
    L2 Cache Throughput                 %        60.19
    SM Active Cycles                cycle   384,846.06
    Compute (SM) Throughput             %        60.13
    ----------------------- ------------- ------------

    INF   Compute and Memory are well-balanced: To reduce runtime, both computation and memory traffic must be reduced. 
          Check both the Compute Workload Analysis and Memory Workload Analysis sections.                               

    Section: Launch Statistics
    -------------------------------- --------------- ---------------
    Metric Name                          Metric Unit    Metric Value
    -------------------------------- --------------- ---------------
    Block Size                                                 1,024
    Function Cache Configuration                     CachePreferNone
    Grid Size                                                  4,096
    Registers Per Thread             register/thread              23
    Shared Memory Configuration Size           Kbyte            8.19
    Driver Shared Memory Per Block       Kbyte/block            1.02
    Dynamic Shared Memory Per Block       byte/block               0
    Static Shared Memory Per Block        byte/block               0
    Threads                                   thread       4,194,304
    Waves Per SM                                               18.96
    -------------------------------- --------------- ---------------

    Section: Occupancy
    ------------------------------- ----------- ------------
    Metric Name                     Metric Unit Metric Value
    ------------------------------- ----------- ------------
    Block Limit SM                        block           32
    Block Limit Registers                 block            2
    Block Limit Shared Mem                block            8
    Block Limit Warps                     block            2
    Theoretical Active Warps per SM        warp           64
    Theoretical Occupancy                     %          100
    Achieved Occupancy                        %        90.69
    Achieved Active Warps Per SM           warp        58.04
    ------------------------------- ----------- ------------

    INF   This kernel's theoretical occupancy is not impacted by any block limit.                                       

    Section: Source Counters
    ------------------------- ----------- ------------
    Metric Name               Metric Unit Metric Value
    ------------------------- ----------- ------------
    Branch Instructions Ratio           %         0.06
    Branch Instructions              inst    5,992,493
    Branch Efficiency                   %        99.78
    Avg. Divergent Branches                      17.81
    ------------------------- ----------- ------------

    OPT   Estimated Speedup: 0%                                                                                         
          This kernel has uncoalesced global accesses resulting in a total of 6851808 excessive sectors (13% of the     
          total 52583746 sectors). Check the L2 Theoretical Sectors Global Excessive table for the primary source       
          locations. The CUDA Programming Guide                                                                         
          (https://docs.nvidia.com/cuda/cuda-c-programming-guide/index.html#device-memory-accesses) had additional      
          information on reducing uncoalesced device memory accesses.                                                   

